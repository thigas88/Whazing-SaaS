(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[17],{"680e":function(t,a,e){"use strict";e("9947")},9947:function(t,a,e){},"9c62":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t._self._c;return"admin"===t.userProfile?a("div",[a("q-card",{staticClass:"container-border container-rounded-10 q-ma-lg"},[a("q-card-section",[a("div",[a("h2",{class:t.$q.dark.isActive?"text-green":""},[a("q-icon",{attrs:{name:"mdi-call-split"}}),t._v("\n          Configurações API\n        ")],1),a("q-btn",{staticClass:"generate-button btn-rounded-50",staticStyle:{margin:"2px"},attrs:{icon:"eva-plus-outline",label:"Adicionar"},on:{click:function(a){t.apiEdicao={},t.modalApi=!t.modalApi}}})],1)]),a("q-card-section",{staticClass:"scroll",staticStyle:{height:"calc(100vh - 200px)"}},t._l(t.apis,(function(e){return a("q-item",{key:e.token,staticClass:"q-my-md container-rounded-10 container-border"},[a("q-item-section",{attrs:{top:""}},[a("q-item-label",{staticClass:"text-bold text-h6 q-my-sm"},[t._v("\n            Nome: "+t._s(e.name)+"\n            "),a("div",{staticClass:"text-grey-8 q-gutter-xs float-right"},[a("q-btn",{staticClass:"gt-xs",attrs:{size:"12px",flat:"",dense:"",round:"",icon:"mdi-content-copy"},on:{click:function(a){return t.copy(e.token)}}},[a("q-tooltip",[t._v("\n                  Copiar token\n                ")])],1),a("q-btn",{staticClass:"gt-xs",attrs:{size:"12px",flat:"",dense:"",round:"",icon:"eva-edit-outline"},on:{click:function(a){return t.editarAPI(e)}}},[a("q-tooltip",[t._v("\n                  Editar Configuraçao\n                ")])],1),a("q-btn",{staticClass:"gt-xs",attrs:{size:"12px",flat:"",dense:"",round:"",icon:"mdi-autorenew"},on:{click:function(a){return t.gerarNovoToken(e)}}},[a("q-tooltip",[t._v("\n                  Gerar novo Token\n                ")])],1),a("q-btn",{staticClass:"gt-xs",attrs:{size:"12px",flat:"",dense:"",round:"",icon:"eva-trash-outline"},on:{click:function(a){return t.deletarApi(e)}}},[a("q-tooltip",[t._v("\n                  Deletar Configuração\n                ")])],1)],1)]),a("q-separator"),a("q-item-label",{staticStyle:{"word-break":"break-all","padding-top":"10px"},attrs:{lines:"4"}},[a("p",{staticClass:"text-weight-medium text-nowrap q-pr-md blur-effect"},[a("span",{staticClass:"text-bold"},[t._v("Url:\n              ")]),t._v("\n              "+t._s(t.montarUrlIntegração(e.id))+"\n            ")])]),a("q-item-label",{staticStyle:{"word-break":"break-all"}},[a("p",{staticClass:"text-weight-medium text-nowrap q-pr-md blur-effect"},[a("span",{staticClass:"text-bold"},[t._v("Token:\n              ")]),t._v("\n              "+t._s(e.token)+"\n            ")])]),a("q-item-label",{staticClass:"q-mt-xs text-body2 text-weight-bold text-primary text-uppercase",attrs:{lines:"1"}}),a("q-item-label",{staticStyle:{"word-break":"break-all"}},[a("q-btn",{staticClass:"generate-button btn-rounded-50",staticStyle:{margin:"2px"},attrs:{label:"POSTMAN"},on:{click:t.download}}),a("p",{staticClass:"text-weight-medium text-nowrap q-pr-md"},[a("span",{staticClass:"text-bold"},[t._v("Baixe o arquivo do postman verifique uso no site\n              ")]),a("a",{attrs:{href:"https://www.postman.com/",target:"_blank"}},[t._v("https://www.postman.com/")])])],1),a("q-item-label",{staticClass:"q-mt-xs text-body2 text-weight-bold text-primary text-uppercase",attrs:{lines:"1"}})],1)],1)})),1)],1),a("ModalApi",{attrs:{modalApi:t.modalApi,apiEdicao:t.apiEdicao},on:{"update:modalApi":function(a){t.modalApi=a},"update:modal-api":function(a){t.modalApi=a},"update:apiEdicao":function(a){t.apiEdicao=a},"update:api-edicao":function(a){t.apiEdicao=a},"modal-api:criada":t.apiCriada,"modal-api:editada":t.apiEditada}})],1):t._e()},s=[],o=(e("14d9"),e("8982"));function n(t){return Object(o["a"])({url:"/api-config/",method:"post",data:t})}function r(){return Object(o["a"])({url:"/api-config/",method:"get"})}function l(t){return Object(o["a"])({url:`/api-config/${t.id}/`,method:"put",data:t})}function c(t){return Object(o["a"])({url:`/api-config/renew-token/${t.id}/`,method:"put",data:t})}function d(t){return Object(o["a"])({url:`/api-config/${t.id}/`,method:"delete",data:t})}var p=e("cdde"),u=function(){var t=this,a=t._self._c;return a("q-dialog",{attrs:{persistent:"",value:t.modalApi},on:{hide:t.fecharModal,show:t.abrirModal}},[a("q-card",{staticClass:"q-pa-lg",staticStyle:{"min-width":"80vw",width:"80vw"}},[a("q-card-section",[a("div",{staticClass:"text-h6"},[t._v(t._s(t.apiEdicao.id?"Editar":"Criar")+" Configuração API")])]),a("q-card-section",[a("fieldset",{staticClass:"q-pa-md full-width"},[a("legend",{staticClass:"q-px-sm"},[t._v("Dados API")]),a("div",{staticClass:"row q-col-gutter-md"},[a("div",{staticClass:"col-xs-12 col-sm-6"},[a("q-input",{attrs:{square:"",outlined:"",label:"Nome da API",error:t.$v.api.name.$error},on:{blur:t.$v.api.name.$touch},model:{value:t.api.name,callback:function(a){t.$set(t.api,"name",a)},expression:"api.name"}})],1),a("div",{staticClass:"col-xs-12 col-sm-6"},[a("q-select",{attrs:{square:"",outlined:"","emit-value":"","map-options":"",label:"Enviar por",color:"primary",options:t.cSessions,"input-debounce":700,"option-value":"id","option-label":"name",error:t.$v.api.sessionId.$error,"input-style":"width: 280px; max-width: 280px;","error-message":"Obrigatório"},on:{blur:t.$v.api.sessionId.$touch},model:{value:t.api.sessionId,callback:function(a){t.$set(t.api,"sessionId",a)},expression:"api.sessionId"}})],1)])]),t.api.id?a("q-checkbox",{attrs:{label:"Ativo"},model:{value:t.api.isActive,callback:function(a){t.$set(t.api,"isActive",a)},expression:"api.isActive"}}):t._e()],1),a("q-card-actions",{staticClass:"q-mt-md",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mr-md",attrs:{label:"Cancelar",color:"negative"}}),a("q-btn",{attrs:{label:"Salvar",color:"primary"},on:{click:t.handleAPI}})],1)],1)],1)},m=[],h=e("2f62"),b=e("b5ae");const f=t=>Object(b["url"])(t)||!t;var v={name:"ModalFila",props:{modalApi:{type:Boolean,default:!1},apiEdicao:{type:Object,default:()=>({id:null})}},data(){return{api:{id:null,name:null,sessionId:null,urlServiceStatus:null,urlMessageStatus:null,authToken:null,isActive:!0}}},validations:{api:{name:{required:b["required"]},sessionId:{required:b["required"]},authToken:{},urlServiceStatus:{isValidURL:f},urlMessageStatus:{isValidURL:f}}},computed:{...Object(h["b"])(["whatsapps"]),cSessions(){return this.whatsapps.filter((t=>"whatsapp"===t.type&&!t.isDeleted))}},methods:{resetarApi(){this.api={id:null,queue:null,isActive:!0}},fecharModal(){this.resetarApi(),this.$emit("update:apiEdicao",{id:null}),this.$emit("update:modalApi",!1)},abrirModal(){this.apiEdicao.id?this.api={...this.apiEdicao}:this.resetarApi()},async handleAPI(){if(this.$v.api.$touch(),this.$v.api.$error)this.$notificarErro("Verifique os campos obrigatórios e inconsistências.");else try{if(this.loading=!0,this.api.id){const{data:t}=await l(this.api);this.$emit("modal-api:editada",t),this.$notificarSucesso("API Editada")}else{const{data:t}=await n(this.api);this.$emit("modal-api:criada",t),this.$notificarSucesso("API criada")}this.loading=!1,this.fecharModal()}catch(t){console.error(t),this.$notificarErro("Ocorreu um erro!",t)}}}},g=v,q=e("2877"),x=e("24e8"),w=e("f09f"),A=e("a370"),k=e("27f9"),C=e("ddd8"),$=e("8f8e"),y=e("4b7e"),I=e("9c40"),S=e("7f67"),_=e("eebe"),E=e.n(_),P=Object(q["a"])(g,u,m,!1,null,"6a3a0587",null),Q=P.exports;E()(P,"components",{QDialog:x["a"],QCard:w["a"],QCardSection:A["a"],QInput:k["a"],QSelect:C["a"],QCheckbox:$["a"],QCardActions:y["a"],QBtn:I["a"]}),E()(P,"directives",{ClosePopup:S["a"]});var O={name:"APIs",components:{ModalApi:Q},data(){return{userProfile:"user",apiEdicao:{},modalApi:!1,apis:[],pagination:{rowsPerPage:40,rowsNumber:0,lastIndex:0},loading:!1,columns:[{name:"name",label:"Nome",field:"name",align:"left"},{name:"token",label:"Token",classes:"ellipsis",style:"max-width: 400px",field:"token",align:"left"},{name:"isActive",label:"Ativo",field:"isActive",align:"center"},{name:"acoes",label:"Ações",field:"acoes",align:"center"}]}},computed:{"cBaseUrlIntegração"(){return"http://localhost:3100/v1/api/external"}},methods:{download(){const t=document.createElement("a");t.href="apiizing.json",t.download="apiizing.json",document.body.appendChild(t),t.click(),document.body.removeChild(t)},"montarUrlIntegração"(t){return`${this.cBaseUrlIntegração}/${t}`},copy(t){Object(p["a"])(t).then(this.$notificarSucesso("Token copiado!")).catch()},async listarAPIs(){const{data:t}=await r();this.apis=t.apis},apiCriada(t){const a=[...this.apis];a.push(t),this.apis=[...a]},apiEditada(t){const a=[...this.apis],e=a.findIndex((a=>a.id===t.id));e>-1&&(a[e]=t),this.apis=[...a]},editarAPI(t){this.apiEdicao={...t},this.modalApi=!0},gerarNovoToken(t){this.$q.dialog({title:"Atenção!!",message:`Deseja realmente gerar novo token para "${t.name}"?\n        Lembre que as integrações que utilizam atual irão parar de funcionar\n        até que atualize o token onde for necessário.`,cancel:{label:"Não",color:"primary",push:!0},ok:{label:"Sim",color:"negative",push:!0},persistent:!0}).onOk((async()=>{try{const{data:a}=await c(t);this.apiEditada(a),this.$notificarSucesso("Token atualizado!")}catch(a){this.$notificarErro("Não foi possível atualizar o token",a)}}))},deletarApi(t){this.$q.dialog({title:"Atenção!!",message:`Deseja realmente deletar "${t.name}"?`,cancel:{label:"Não",color:"primary",push:!0},ok:{label:"Sim",color:"negative",push:!0},persistent:!0}).onOk((()=>{this.loading=!0,d(t).then((a=>{let e=[...this.apis];e=e.filter((a=>a.id!==t.id)),this.apis=[...e],this.$notificarSucesso(`${t.name} deletada!`)})).catch((a=>this.$notificarErro(`Não foi possível deletar ${t.name}`,a))),this.loading=!1}))}},mounted(){this.userProfile=localStorage.getItem("profile"),this.listarAPIs()}},j=O,N=(e("680e"),e("0016")),M=e("66e5"),T=e("4074"),z=e("0170"),U=e("05c0"),B=e("eb85"),D=Object(q["a"])(j,i,s,!1,null,"07b14398",null);a["default"]=D.exports;E()(D,"components",{QCard:w["a"],QCardSection:A["a"],QIcon:N["a"],QBtn:I["a"],QItem:M["a"],QItemSection:T["a"],QItemLabel:z["a"],QTooltip:U["a"],QSeparator:B["a"]})}}]);