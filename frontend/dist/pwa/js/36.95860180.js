(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[36],{"64f4":function(a,e,t){"use strict";t.r(e);var o=function(){var a=this,e=a._self._c;return e("div",[e("q-table",{staticClass:"contact-table container-rounded-10 my-sticky-dynamic q-ma-lg",attrs:{flat:"",bordered:"",square:"","hide-bottom":"",data:a.financeiro,columns:a.columns,loading:a.loading,"row-key":"id",pagination:a.pagination,"rows-per-page-options":[0]},on:{"update:pagination":function(e){a.pagination=e}},scopedSlots:a._u([{key:"top-left",fn:function(){return[e("div",[e("h2",{class:a.$q.dark.isActive?"text-green":""},[e("q-icon",{attrs:{name:"mdi-cash-multiple q-pr-sm"}}),a._v("\n          Mensalidade / Fatura\n        ")],1),a.whatsappNumber?e("q-btn",{staticClass:"generate-button btn-rounded-50",attrs:{flat:"",icon:"mdi-whatsapp",label:"Chamar Suporte"},on:{click:a.abrirWhatsApp}}):a._e()],1)]},proxy:!0},{key:"body-cell-value",fn:function(t){return[e("q-td",{key:"value",attrs:{props:t}},[a._v("\n        R$ "+a._s(t.row.value.toFixed(2).replace(".",","))+"\n      ")])]}},{key:"body-cell-dueDate",fn:function(t){return[e("q-td",{key:"dueDate",attrs:{props:t}},[a._v("\n        "+a._s(a.formatDate(t.row.dueDate))+"\n      ")])]}},{key:"body-cell-status",fn:function(t){return[e("q-td",{key:"status",style:a.getStatusStyle(t.row.status,t.row.dueDate),attrs:{props:t}},[a._v("\n        "+a._s(a.getStatusText(t.row.status,t.row.dueDate))+"\n      ")])]}},{key:"body-cell-acoes",fn:function(t){return[e("q-td",{staticClass:"text-center"},["paid"!==t.row.status?e("q-btn",{attrs:{color:"primary",label:"PAGAR"},on:{click:function(e){return a.GerarQRCODE(t.row)}}}):a._e()],1)]}}])}),e("q-dialog",{attrs:{persistent:""},model:{value:a.showQRCodeModal,callback:function(e){a.showQRCodeModal=e},expression:"showQRCodeModal"}},[e("q-card",{staticClass:"container-rounded-10"},[e("q-card-section",[e("div",{staticClass:"text-h6 font-family-main text-center"},[a._v("\n        QR Code de Pagamento\n        "),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-ml-md float-right",attrs:{round:"",flat:"",color:"negative",icon:"eva-close"}})],1)]),e("q-card-section",{staticClass:"text-center q-ma-lg container-rounded-10 container-border",style:a.$q.dark.isActive?"background: white !important":""},[e("div",[a._v("Faça leitura do QR Code no aplicativo de seu banco")]),e("qrcode-vue",{attrs:{value:a.qrCodeValue,size:200}})],1),e("q-card-section",[e("div",[e("q-input",{staticClass:"q-ma-md",staticStyle:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},attrs:{readonly:"",filled:""},model:{value:a.pixString,callback:function(e){a.pixString=e},expression:"pixString"}})],1),e("q-btn",{staticClass:"generate-button btn-rounded-50",attrs:{label:"Copiar código QR",icon:"mdi-content-copy"},on:{click:a.copiarPixString}}),e("div",{staticClass:"text-center q-mb-lg",staticStyle:{"font-size":"14px"}},[a._v("Para finalizar, basta realizar o pagamento escaneando ou colando o código Pix acima :) ")]),e("div",{staticClass:"row col-12 justify-center"})],1)],1)],1)],1)},n=[],i=t("8982");function r(){return Object(i["a"])({url:"/invoices/all/",method:"get"})}function s(a){return Object(i["a"])({url:"/subscription/",method:"post",data:a})}var c=t("a0b3"),l=t("b166"),d=t("e3ee"),u=t("f7f1"),p=t("7677"),m=t("d7b0"),b={name:"Financeiro",components:{"qrcode-vue":m["a"]},data(){return{financeiro:[],whatsappNumber:null,pagination:{rowsPerPage:40,rowsNumber:0,lastIndex:0},loading:!1,showQRCodeModal:!1,qrCodeValue:"",pixString:"",UrlPagamentoOpen:"",columns:[{name:"id",label:"#",field:"id",align:"left"},{name:"detail",label:"Plano",field:"detail",align:"left"},{name:"value",label:"Valor",field:"value",align:"center"},{name:"dueDate",label:"Data Venc.",field:"dueDate",align:"center"},{name:"status",label:"Status",field:"status",align:"center"},{name:"acoes",label:"Ações",field:"acoes",align:"center"}]}},methods:{async fetchConfigurations(){try{const a=await Object(c["b"])(),e=a.data;this.whatsappNumber=e.whatsappnumber||null}catch(a){console.error("Erro ao buscar configurações:",a)}},abrirWhatsApp(){if(this.whatsappNumber){const a=`https://wa.me/${this.whatsappNumber}?text=Ol%C3%A1%21+tenho+duvidas+no+financeiro`;window.open(a,"_blank")}},formatDate(a){try{return Object(l["a"])(Object(d["a"])(a),"dd/MM/yyyy")}catch(e){return console.error("Invalid date format:",e),a}},async listarFinanceiro(){const{data:a}=await r();this.financeiro=a},getStatusStyle(a,e){const t=Object(u["a"])(new Date,-1),o=Object(d["a"])(e);return"paid"===a?{backgroundColor:"green",color:"black",fontWeight:"bold"}:"open"===a?Object(p["a"])(t,o)?{backgroundColor:"yellow",color:"black",fontWeight:"bold"}:{backgroundColor:"red",color:"black",fontWeight:"bold"}:{}},getStatusText(a,e){const t=Object(u["a"])(new Date,-1),o=Object(d["a"])(e);return"paid"===a?"PAGO":"open"===a?Object(p["a"])(t,o)?"EM ABERTO":"VENCIDO":a},async GerarQRCODE(a){try{const e=await s({firstName:"",lastName:"",address2:"",city:"",state:"",zipcode:"",country:"",useAddressForPaymentDetails:!1,nameOnCard:"",cardNumber:"",cvv:"",price:a.value,invoiceId:a.id});if(e.data.urlPagamento){this.UrlPagamentoOpen=e.data.urlPagamento,this.$q.notify({type:"info",message:"Ao realizar o pagamento, atualize a página!",timeout:1e4});const a=window.open(this.UrlPagamentoOpen,"_blank");!a||a.closed||"undefined"==typeof a.closed?window.location.href=this.UrlPagamentoOpen:this.$q.notify({type:"info",message:'Se a página de pagamento não abriu, clique <a href="#" @click="abrirURLPagamento">aqui</a> para acessar.',html:!0,timeout:1e4})}else{if(!e.data.qrcode)throw new Error("Resposta inesperada do backend.");this.qrCodeValue=e.data.qrcode.qrcode,this.pixString=e.data.qrcode.qrcode,this.showQRCodeModal=!0}}catch(e){console.error("Erro ao processar pagamento:",e),this.$q.notify({type:"negative",message:"Erro ao processar pagamento. Tente novamente mais tarde."})}},abrirURLPagamento(){window.open(this.UrlPagamentoOpen,"_blank")},copiarPixString(){navigator.clipboard.writeText(this.pixString).then((()=>{this.$q.notify({type:"positive",message:"Código Pix copiado com sucesso!"})})).catch((a=>{console.error("Erro ao copiar código Pix:",a),this.$q.notify({type:"negative",message:"Erro ao copiar código Pix."})}))}},mounted(){this.fetchConfigurations(),this.listarFinanceiro()}},g=b,f=t("2877"),h=t("eaac"),w=t("0016"),y=t("9c40"),v=t("db86"),q=t("24e8"),C=t("f09f"),k=t("a370"),x=t("27f9"),O=t("7f67"),P=t("eebe"),S=t.n(P),Q=Object(f["a"])(g,o,n,!1,null,"51af514e",null);e["default"]=Q.exports;S()(Q,"components",{QTable:h["a"],QIcon:w["a"],QBtn:y["a"],QTd:v["a"],QDialog:q["a"],QCard:C["a"],QCardSection:k["a"],QInput:x["a"]}),S()(Q,"directives",{ClosePopup:O["a"]})}}]);