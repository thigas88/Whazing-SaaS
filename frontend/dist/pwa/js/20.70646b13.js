(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20],{"0918":function(t,o,a){"use strict";a.r(o);var e=function(){var t=this,o=t._self._c;return"admin"===t.userProfile?o("div",[o("q-table",{staticClass:"contact-table container-rounded-10 my-sticky-dynamic q-ma-lg",attrs:{flat:"",bordered:"",square:"","hide-bottom":"",data:t.groups,columns:t.columns,loading:t.loading,"row-key":"id",pagination:t.pagination,"rows-per-page-options":[0]},on:{"update:pagination":function(o){t.pagination=o}},scopedSlots:t._u([{key:"top-left",fn:function(){return[o("div",[o("h2",{class:t.$q.dark.isActive?"text-green":""},[o("q-icon",{attrs:{name:"mdi-account-network-outline q-pr-sm"}}),t._v("\n          Equipes\n        ")],1),o("q-btn",{staticClass:"generate-button btn-rounded-50",attrs:{icon:"eva-plus-outline",label:"Adicionar"},on:{click:function(o){t.grupoEdicao={},t.modalGrupo=!0}}})],1)]},proxy:!0},{key:"body-cell-isActive",fn:function(t){return[o("q-td",{staticClass:"text-center"},[o("q-icon",{attrs:{size:"24px",name:t.value?"mdi-check-circle-outline":"mdi-close-circle-outline",color:t.value?"positive":"negative"}})],1)]}},{key:"body-cell-acoes",fn:function(a){return[o("q-td",{staticClass:"text-center"},[o("q-btn",{class:t.$q.dark.isActive?"text-green":"",attrs:{flat:"",round:"",icon:"mdi-account-multiple-plus-outline"},on:{click:function(o){return t.editarUsuarios(a.row)}}},[o("q-tooltip",{attrs:{"content-class":"bg-padrao text-grey-9 text-bold"}},[t._v("\n            Adicionar/ Remover Usuários\n          ")])],1),o("q-btn",{class:t.$q.dark.isActive?"text-green":"",attrs:{flat:"",round:"",icon:"eva-edit-outline"},on:{click:function(o){return t.editarGrupo(a.row)}}}),o("q-btn",{class:t.$q.dark.isActive?"text-green":"",attrs:{flat:"",round:"",icon:"eva-trash-outline"},on:{click:function(o){return t.deletarGrupo(a.row)}}})],1)]}}],null,!1,301472667)}),o("ModalGrupo",{attrs:{modalGrupo:t.modalGrupo,grupoEdicao:t.grupoEdicao},on:{"update:modalGrupo":function(o){t.modalGrupo=o},"update:modal-grupo":function(o){t.modalGrupo=o},"update:grupoEdicao":function(o){t.grupoEdicao=o},"update:grupo-edicao":function(o){t.grupoEdicao=o},"modal-grupo:criada":t.grupoCriada,"modal-grupo:editada":t.grupoEditada}}),o("ModalUserGrupo",{attrs:{modalUserGrupo:t.modalUserGrupo,grupoId:t.grupoId},on:{"update:modalUserGrupo":function(o){t.modalUserGrupo=o},"update:modal-user-grupo":function(o){t.modalUserGrupo=o},"update:grupoId":function(o){t.grupoId=o},"update:grupo-id":function(o){t.grupoId=o}}})],1):t._e()},r=[],s=(a("14d9"),function(){var t=this,o=t._self._c;return o("q-dialog",{attrs:{persistent:"",value:t.modalGrupo},on:{hide:t.fecharModal,show:t.abrirModal}},[o("q-card",{staticClass:"q-pa-lg modal-container container-rounded-10"},[o("q-card-actions",{staticClass:"q-mt-md",attrs:{align:"right"}},[o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"btn-rounded-50",attrs:{flat:"",icon:"eva-close",color:"negative"}})],1),o("q-card-section",[o("div",{staticClass:"text-h6 text-center font-family-main"},[t._v(t._s(t.grupoEdicao.id?"Editar":"Criar")+" Equipe")])]),o("q-card-section",{staticClass:"q-pa-lg container-border container-rounded-10"},[o("div",{staticClass:"text-h6 font-family-main q-mb-sm"},[t._v("\n        Informações\n      ")]),o("div",{staticClass:"row"},[o("div",{staticClass:"col-12"},[o("q-input",{attrs:{rounded:"",outlined:"",label:"Nome da Equipe"},model:{value:t.grupo.group,callback:function(o){t.$set(t.grupo,"group",o)},expression:"grupo.group"}})],1),o("div",{staticClass:"col-6"},[o("q-toggle",{attrs:{label:"Ativo"},model:{value:t.grupo.isActive,callback:function(o){t.$set(t.grupo,"isActive",o)},expression:"grupo.isActive"}})],1)])]),o("q-card-actions",{staticClass:"q-mt-md",attrs:{align:"right"}},[o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mr-md btn-rounded-50",attrs:{label:"Cancelar",color:"negative"}}),o("q-btn",{staticClass:"generate-button btn-rounded-50",attrs:{label:"Salvar",icon:"eva-save-outline"},on:{click:t.handleGrupo}})],1)],1)],1)}),i=[],n=a("8982");function u(t){return Object(n["a"])({url:"/group/",method:"post",data:t})}function l(){return Object(n["a"])({url:"/group/",method:"get"})}function c(t){return Object(n["a"])({url:`/group/${t}`,method:"get"})}function d(t){return Object(n["a"])({url:`/group/${t.id}`,method:"put",data:t})}function p(t){return Object(n["a"])({url:`/group/${t.id}`,method:"delete"})}function h(t,o){return Object(n["a"])({url:"/group/user",method:"post",data:{userId:t,groupId:o}})}function m(t,o){return Object(n["a"])({url:`/group/user/${t}/${o}`,method:"delete"})}var g={name:"ModalGrupo",props:{modalGrupo:{type:Boolean,default:!1},grupoEdicao:{type:Object,default:()=>({id:null})}},data(){return{grupo:{id:null,grupo:null,isActive:!0}}},methods:{resetarGrupo(){this.grupo={id:null,grupo:null,isActive:!0}},fecharModal(){this.resetarGrupo(),this.$emit("update:grupoEdicao",{id:null}),this.$emit("update:modalGrupo",!1)},abrirModal(){this.grupoEdicao.id?this.grupo={...this.grupoEdicao}:this.resetarGrupo()},async handleGrupo(){try{if(this.loading=!0,this.grupo.id){const{data:t}=await d(this.grupo);this.$emit("modal-grupo:editada",t),this.$q.notify({type:"info",progress:!0,position:"top",textColor:"black",message:"Equipe Editada!",actions:[{icon:"close",round:!0,color:"white"}]})}else{const{data:t}=await u(this.grupo);this.$emit("modal-grupo:criada",t),this.$q.notify({type:"positive",progress:!0,position:"top",message:"Equipe criada!",actions:[{icon:"close",round:!0,color:"white"}]})}this.loading=!1,this.fecharModal()}catch(t){console.error(t),this.$notificarErro("Ocorreu um erro!",t)}}}},f=g,b=a("2877"),v=a("24e8"),q=a("f09f"),G=a("4b7e"),y=a("9c40"),U=a("a370"),C=a("27f9"),w=a("9564"),x=a("7f67"),k=a("eebe"),_=a.n(k),$=Object(b["a"])(f,s,i,!1,null,"0f776b02",null),Q=$.exports;_()($,"components",{QDialog:v["a"],QCard:q["a"],QCardActions:G["a"],QBtn:y["a"],QCardSection:U["a"],QInput:C["a"],QToggle:w["a"]}),_()($,"directives",{ClosePopup:x["a"]});var E=function(){var t=this,o=t._self._c;return o("q-dialog",{attrs:{persistent:"",value:t.modalUserGrupo},on:{hide:t.fecharModal,show:t.abrirModal}},[o("q-card",{staticClass:"q-pa-lg modal-container container-rounded-10"},[o("q-card-section",[o("div",{staticClass:"row"},[o("div",{staticClass:"col-6",staticStyle:{"padding-right":"5px"}},[o("h3",[t._v("Usuários do Sistema")]),o("q-toolbar",{staticClass:"bg-grey-2"},[o("q-input",{staticClass:"full-width",attrs:{rounded:"",outlined:"",dense:"","bg-color":"white",placeholder:"Pesquisar..."},on:{input:function(o){return t.filtroUser()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.searchParamUser,callback:function(o){t.searchParamUser=o},expression:"searchParamUser"}})],1),o("q-scroll-area",{staticStyle:{height:"calc(75vh - 158px) !important"}},[o("q-list",t._l(t.searchedUsers,(function(a){return o("q-item",{key:a.id},[o("q-item-section",{attrs:{avatar:""}},[o("q-avatar",{attrs:{color:"primary","text-color":"white"}},[t._v("\n                    "+t._s(a.name.charAt(0))+"\n                  ")])],1),o("q-item-section",[o("q-item-label",{attrs:{lines:"1"}},[t._v("\n                    "+t._s(a.name)+"\n                  ")])],1),o("q-item-section",{attrs:{side:""}},[o("q-btn",{staticClass:"q-mr-sm",attrs:{round:"",flat:"",icon:"add"},on:{click:function(o){return t.addUser(a)}}},[o("q-tooltip",{attrs:{"content-class":"bg-padrao text-grey-9 text-bold"}},[t._v("\n                      Adicionar ao grupo\n                    ")])],1)],1)],1)})),1)],1)],1),o("div",{staticClass:"col-6",staticStyle:{"padding-left":"5px"}},[o("h3",[t._v("Usuários do Grupo")]),o("q-toolbar",{staticClass:"bg-grey-2"},[o("q-input",{staticClass:"full-width",attrs:{rounded:"",outlined:"",dense:"","bg-color":"white",placeholder:"Pesquisar..."},on:{input:function(o){return t.filtroGrupo()}},scopedSlots:t._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.searchParamGrupo,callback:function(o){t.searchParamGrupo=o},expression:"searchParamGrupo"}})],1),o("q-scroll-area",{staticStyle:{height:"calc(75vh - 158px) !important"}},[o("q-list",t._l(t.searchedGrupo,(function(a){return o("q-item",{key:a.id},[o("q-item-section",{attrs:{avatar:""}},[o("q-avatar",{attrs:{color:"primary","text-color":"white"}},[t._v("\n                    "+t._s(a.user.name.charAt(0))+"\n                  ")])],1),o("q-item-section",[o("q-item-label",{attrs:{lines:"1"}},[t._v("\n                    "+t._s(a.user.name)+"\n                  ")])],1),o("q-item-section",{attrs:{side:""}},[o("q-btn",{staticClass:"q-mr-sm",attrs:{round:"",flat:"",icon:"delete"},on:{click:function(o){return t.revomeUser(a.user)}}},[o("q-tooltip",{attrs:{"content-class":"bg-padrao text-grey-9 text-bold"}},[t._v("\n                      Remover do grupo\n                    ")])],1)],1)],1)})),1)],1)],1)])]),o("q-card-actions",{staticClass:"q-mt-md",attrs:{align:"right"}},[o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mr-md",attrs:{flat:"",label:"fechar",color:"negative"}})],1)],1)],1)},A=[],I=a("9a1b"),P={name:"ModalUserGrupo",props:{modalUserGrupo:{type:Boolean,default:!1},grupoId:{type:Number,default:0}},data(){return{listaUsuariosGrupo:[],listaUsuarios:[],pageNumber:1,hasMore:!0,searchedUsers:[],searchedGrupo:[],searchParamUser:"",searchParamGrupo:""}},methods:{resetar(){this.listaUsuariosGrupo=[],this.listaUsuarios=[],this.searchedUsers=[],this.searchedGrupo=[],this.searchParamUser="",this.searchParamGrupo="",this.hasMore=!0,this.pageNumber=1},fecharModal(){this.$emit("update:grupoId",0),this.$emit("update:modalUserGrupo",!1),this.resetar()},filtroUser(){this.searchedUsers=this.listaUsuarios.filter((t=>0==t.name.toLowerCase().indexOf(this.searchParamUser.toLowerCase())))},filtroGrupo(){this.searchedGrupo=this.listaUsuariosGrupo.filter((t=>0==t.user.name.toLowerCase().indexOf(this.searchParamGrupo.toLowerCase())))},async abrirModal(){this.resetar(),this.listarUsuariosDoGrupo(),this.listarUsuariosDoSistema()},async listarUsuariosDoGrupo(){const{data:t}=await c(this.grupoId);this.listaUsuariosGrupo=t,this.searchedGrupo=t},async listarUsuariosDoSistema(){const{data:t}=await Object(I["e"])({pageNumber:this.pageNumber});this.listaUsuarios=[...this.listaUsuarios,...t.users],this.searchedUsers=[...this.searchedUsers,...t.users],this.hasMore=t.hasMore,this.hasMore&&(this.pageNumber+=1,this.listarUsuariosDoSistema())},async addUser(t){try{await h(t.id,this.grupoId),this.listarUsuariosDoGrupo(),this.listarUsuariosDoSistema(),this.$q.notify({type:"info",progress:!0,position:"top",message:"Usuário adicionado!",textColor:"black",actions:[{icon:"close",round:!0,color:"white"}]})}catch(o){this.$q.notify({type:"negative",progress:!0,position:"top",message:"Erro ao adicionar usuário!",actions:[{icon:"close",round:!0,color:"white"}]})}},async revomeUser(t){try{await m(t.id,this.grupoId),this.listarUsuariosDoGrupo(),this.listarUsuariosDoSistema(),this.$q.notify({type:"info",progress:!0,position:"top",message:"Usuário removido!",textColor:"black",actions:[{icon:"close",round:!0,color:"white"}]})}catch(o){this.$q.notify({type:"negative",progress:!0,position:"top",message:"Erro ao remover usuário!",actions:[{icon:"close",round:!0,color:"white"}]})}}}},M=P,S=(a("c48a"),a("65c6")),O=a("0016"),j=a("4983"),D=a("1c1c"),N=a("66e5"),L=a("4074"),T=a("cb32"),B=a("0170"),J=a("05c0"),R=Object(b["a"])(M,E,A,!1,null,"5d9ccf2c",null),z=R.exports;_()(R,"components",{QDialog:v["a"],QCard:q["a"],QCardSection:U["a"],QToolbar:S["a"],QInput:C["a"],QIcon:O["a"],QScrollArea:j["a"],QList:D["a"],QItem:N["a"],QItemSection:L["a"],QAvatar:T["a"],QItemLabel:B["a"],QBtn:y["a"],QTooltip:J["a"],QCardActions:G["a"]}),_()(R,"directives",{ClosePopup:x["a"]});var F={name:"Grupos",components:{ModalGrupo:Q,ModalUserGrupo:z},data(){return{userProfile:"user",grupoEdicao:{},modalGrupo:!1,modalUserGrupo:!1,grupoId:0,groups:[],pagination:{rowsPerPage:40,rowsNumber:0,lastIndex:0},loading:!1,columns:[{name:"id",label:"#",field:"id",align:"left"},{name:"group",label:"Equipe",field:"group",align:"left"},{name:"isActive",label:"Ativo",field:"isActive",align:"center"},{name:"acoes",label:"Ações",field:"acoes",align:"center"}]}},methods:{async listarGrupos(){const{data:t}=await l();this.groups=t},grupoCriada(t){const o=[...this.groups];o.push(t),this.groups=[...o]},grupoEditada(t){const o=[...this.groups],a=o.findIndex((o=>o.id===t.id));a>-1&&(o[a]=t),this.groups=[...o]},editarGrupo(t){this.grupoEdicao={...t},this.modalGrupo=!0},editarUsuarios(t){this.modalUserGrupo=!0,this.grupoId=t.id},deletarGrupo(t){this.$q.dialog({title:"Atenção!!",message:`Deseja realmente deletar o grupo "${t.group}"?`,cancel:{label:"Não",color:"primary",push:!0},ok:{label:"Sim",color:"negative",push:!0},persistent:!0}).onOk((()=>{this.loading=!0,p(t).then((o=>{let a=[...this.groups];a=a.filter((o=>o.id!==t.id)),this.groups=[...a],this.$q.notify({type:"positive",progress:!0,position:"top",message:`Grupo ${t.group} deletado!`,actions:[{icon:"close",round:!0,color:"white"}]})})),this.loading=!1}))}},mounted(){this.listarGrupos(),this.userProfile=localStorage.getItem("profile")}},H=F,K=a("eaac"),V=a("db86"),W=Object(b["a"])(H,e,r,!1,null,"a9e4f97a",null);o["default"]=W.exports;_()(W,"components",{QTable:K["a"],QIcon:O["a"],QBtn:y["a"],QTd:V["a"],QTooltip:J["a"]})},"63ab":function(t,o,a){},c48a:function(t,o,a){"use strict";a("63ab")}}]);