(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{3982:function(t,e,a){},"6b32":function(t,e,a){"use strict";a("b3e5")},"6b63":function(t,e,a){t.exports=a.p+"media/silence.630c7671.mp3"},"713b":function(t,e,a){"use strict";a.r(e);a("14d9");var o=function(){var t=this,e=t._self._c;return e("div",[e("q-layout",{attrs:{view:"hHh Lpr lFf"}},[this.$q.screen.lt.md?e("div",{staticClass:"header-mobile"},[e("q-btn",{staticClass:"menu-icon-mobile",attrs:{color:"white","aria-label":"Menu",icon:"menu",size:"lg"},on:{click:function(e){t.leftDrawerOpen=!t.leftDrawerOpen}}})],1):t._e(),"chat-interno"!==t.$route.name&&"atendimento"!==t.$route.name&&"chat-empty"!==t.$route.name&&"chat"!==t.$route.name&&"chat-contatos"!==t.$route.name?e("div",{staticClass:"header",class:{"header-buttons-mobile":this.$q.screen.lt.md},attrs:{bordered:""}},[e("q-toolbar",[e("div",{staticClass:"q-gutter-sm row items-center no-wrap"},[e("q-btn",{staticClass:"header-buttons",attrs:{dense:"",flat:"",icon:t.isSilentMode?"volume_off":"volume_up",color:t.isSilentMode?"red":"green",size:"xl"},on:{click:t.toggleSilentMode}},[e("q-tooltip",[t._v("\n              "+t._s(t.isSilentMode?"Modo Silencioso Ativado":"Modo Silencioso Desativado")+"\n            ")])],1),e("q-btn",{staticClass:"header-buttons",attrs:{dense:"",flat:"",icon:"notifications",size:"xl"}},[this.notificacaoInternaNaoLida+parseInt(t.notifications_p.count)>0||t.delayed>0||t.venceHoje>0?e("q-badge",{attrs:{color:"red","text-color":"white",floating:""}},[t._v("\n              "+t._s(this.notificacaoInternaNaoLida+parseInt(t.notifications_p.count)+t.delayed+t.venceHoje)+"\n            ")]):t._e(),e("q-menu",[e("q-list",{staticStyle:{"min-width":"300px"}},[parseInt(t.notifications.count)+parseInt(t.notifications_p.count)==0&&0==t.delayed&&0==t.venceHoje?e("q-item",[e("q-item-section",{staticStyle:{cursor:"pointer"}},[t._v("\n                    Nada de novo por aqui!\n                  ")])],1):t._e(),parseInt(t.notificacoesChat)>0?e("q-item",[e("q-item-section",{staticStyle:{cursor:"pointer"},attrs:{avatar:""},on:{click:()=>t.$router.push({name:"interno"})}},[e("q-avatar",{staticStyle:{width:"60px",height:"60px"},attrs:{color:"primary","text-color":"white"}},[t._v("\n                      "+t._s(t.notificacoesChat)+"\n                    ")])],1),e("q-item-section",{staticStyle:{cursor:"pointer"},on:{click:()=>t.$router.push({name:"chat-interno"})}},[t._v("\n                    Novas mensagens não lidas no chat interno!\n                  ")])],1):t._e(),parseInt(t.notificacaoInternaNaoLida)>0?e("q-item",[e("q-item-section",{staticStyle:{cursor:"pointer"},attrs:{avatar:""},on:{click:()=>t.$router.push({name:"interno"})}},[e("q-avatar",{staticStyle:{width:"60px",height:"60px"},attrs:{color:"primary","text-color":"white"}},[t._v("\n                      "+t._s(t.notificacaoInternaNaoLida)+"\n                    ")])],1),e("q-item-section",{staticStyle:{cursor:"pointer"},on:{click:()=>t.$router.push({name:"chat-interno"})}},[t._v("\n                    Mensagens não lidas no chat interno!\n                  ")])],1):t._e(),parseInt(t.notifications_p.count)>0?e("q-item",[e("q-item-section",{staticStyle:{cursor:"pointer"},attrs:{avatar:""},on:{click:()=>t.$router.push({name:"atendimento"})}},[e("q-avatar",{staticStyle:{width:"60px",height:"60px"},attrs:{color:"primary","text-color":"white"}},[t._v("\n                      "+t._s(t.notifications_p.count)+"\n                    ")])],1),e("q-item-section",{staticStyle:{cursor:"pointer"},on:{click:()=>t.$router.push({name:"atendimento"})}},[t._v("\n                    Clientes pendentes na fila\n                  ")])],1):t._e(),t.delayed>0?e("q-item",[e("q-item-section",{staticStyle:{cursor:"pointer"},attrs:{avatar:""},on:{click:()=>t.$router.push({name:"tarefas"})}},[e("q-avatar",{staticStyle:{width:"60px",height:"60px"},attrs:{color:"red","text-color":"white"}},[t._v("\n                      "+t._s(t.delayed)+"\n                    ")])],1),e("q-item-section",{staticStyle:{cursor:"pointer"},on:{click:()=>t.$router.push({name:"tarefas"})}},[t._v("\n                    Existe "+t._s(t.delayed)+" tarefa(s) atrasada(s)!\n                  ")])],1):t._e(),t.venceHoje>0?e("q-item",[e("q-item-section",{staticStyle:{cursor:"pointer"},attrs:{avatar:""},on:{click:()=>t.$router.push({name:"tarefas"})}},[e("q-avatar",{staticStyle:{width:"60px",height:"60px"},attrs:{color:"orange","text-color":"white"}},[t._v("\n                      "+t._s(t.venceHoje)+"\n                    ")])],1),e("q-item-section",{staticStyle:{cursor:"pointer"},on:{click:()=>t.$router.push({name:"tarefas"})}},[t._v("\n                    Existe "+t._s(t.venceHoje)+" tarefa(s) que vence(m) hoje!\n                  ")])],1):t._e()],1)],1),e("q-tooltip",[t._v("Notificações")])],1),e("q-btn",{staticClass:"header-buttons",attrs:{flat:"",size:"lg"}},[e("q-avatar",{attrs:{color:"offline"===t.usuario.status?"negative":"positive","text-color":"white",size:"25px",icon:"offline"===t.usuario.status?"mdi-account-off":"mdi-account-check",rounded:""}}),e("q-menu",[e("q-list",{staticStyle:{"min-width":"100px"}},[e("cStatusUsuario",{attrs:{usuario:t.usuario},on:{"update:usuario":t.atualizarUsuario}})],1)],1),e("q-tooltip",[t._v("\n              "+t._s("offline"===t.usuario.status?"Usuário Offiline":"Usuário Online")+"\n            ")])],1),e("q-btn",{staticClass:"header-buttons",attrs:{flat:"",size:"lg"}},[e("q-avatar",{attrs:{size:"sm"}},[t._v("\n              "+t._s(t.$iniciaisString(t.username))+"\n            ")]),e("q-menu",[e("q-list",{staticStyle:{"min-width":"100px"}},[e("q-item-label",{attrs:{header:""}},[t._v(" Olá! "),e("b",[t._v(" "+t._s(t.username)+" ")])]),e("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:t.abrirModalUsuario}},[e("q-item-section",[t._v("Perfil")])],1),e("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:t.efetuarLogout}},[e("q-item-section",[t._v("Sair")])],1),e("q-separator"),e("q-item",[e("q-item-section",[e("vencimento"),e("cSystemVersion")],1)],1)],1)],1),e("q-tooltip",[t._v("Usuário")])],1)],1)])],1):t._e(),e("q-drawer",{attrs:{"show-if-above":"",bordered:"",mini:t.miniState,"mini-to-overlay":"","content-class":t.$q.dark.isActive?"bg-black":"container-menu"},on:{mouseover:[function(e){t.miniState=!1},function(e){e.stopPropagation(),t.miniState=!1}],mouseout:function(e){t.miniState=!0}},model:{value:t.leftDrawerOpen,callback:function(e){t.leftDrawerOpen=e},expression:"leftDrawerOpen"}},[e("q-scroll-area",{staticClass:"fit"},[e("q-list",{key:t.userProfile,attrs:{padding:""}},[t._l(t.menuData,(function(a){return e("EssentialLink",t._b({key:a.title},"EssentialLink",a,!1))})),"admin"===t.userProfile?e("div",[e("q-separator",{attrs:{spaced:""}}),e("div",{staticClass:"q-mb-lg"}),t.exibirMenuEmpresas(t.item)?e("EssentialLink",t._b({key:t.Empresas},"EssentialLink",{title:"Empresas",caption:"Configurações do SaaS",icon:"mdi-office-building",routeName:"empresas"},!1)):t._e(),t._l(t.menuDataAdmin,(function(a){return[t.exibirMenuBeta(a)?e("EssentialLink",t._b({key:a.title},"EssentialLink",a,!1)):t._e()]})),t.exibirMenuBeta(t.item)?e("EssentialLink",t._b({key:t.Configurações,on:{"submenu-mouseover":function(e){t.miniState=!1},"submenu-mouseout":function(e){t.miniState=!0}}},"EssentialLink",{title:"Cadastros",caption:"Cadastros do sistema",icon:"mdi-list",routeName:"cadastros",submenu:!0,menuType:"cadastros"},!1)):t._e(),t.exibirMenuBeta(t.item)?e("EssentialLink",t._b({key:t.Configurações,on:{"submenu-mouseover":function(e){t.miniState=!1},"submenu-mouseout":function(e){t.miniState=!0}}},"EssentialLink",{title:"Configurações",caption:"Configurações do sistema",icon:"mdi-settings-2",routeName:"configuracoes",submenu:!0,menuType:"configuracoes"},!1)):t._e(),e("q-separator",{attrs:{spaced:""}})],2):t._e()],2)],1),e("div",{staticClass:"absolute-bottom text-center row justify-start",class:{"bg-grey-3":t.$q.dark.isActive},staticStyle:{height:"40px"}},[e("q-toggle",{staticClass:"text-bold q-ml-xs",class:t.$q.dark.isActive?"bg-black full-width":"",attrs:{size:"xl","keep-color":"",dense:"","icon-color":t.$q.dark.isActive?"black":"white",value:t.$q.dark.isActive,color:t.$q.dark.isActive?"grey-3":"black","checked-icon":"mdi-white-balance-sunny","unchecked-icon":"mdi-weather-sunny"},on:{input:function(e){return t.$setConfigsUsuario({isDark:!t.$q.dark.isActive})}}},[e("q-tooltip",{attrs:{"content-class":"text-body1 hide-scrollbar"}},[t._v("\n            "+t._s(t.$q.dark.isActive?"Desativar":"Ativar")+" Modo Escuro (Dark Mode)\n          ")])],1)],1)],1),e("q-page-container",[e("informative"),e("q-page",{staticClass:"q-pa-xs"},[e("router-view")],1)],1),e("audio",{ref:"audioNotification"},[e("source",{attrs:{src:t.currentAlertSound,type:"audio/mp3"}})]),e("ModalUsuario",{attrs:{isProfile:!0,modalUsuario:t.modalUsuario,usuarioEdicao:t.usuario},on:{"update:modalUsuario":function(e){t.modalUsuario=e},"update:modal-usuario":function(e){t.modalUsuario=e},"update:usuarioEdicao":function(e){t.usuario=e},"update:usuario-edicao":function(e){t.usuario=e}}})],1)],1)},i=[],s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-caption text-center q-pa-sm"},[e("q-badge",{attrs:{align:"middle",color:"primary"}},[t._v("\n    Versão: "+t._s(t.cVersion)+"\n  ")])],1)},n=[],r=a("9224"),c={name:"SystemVersion",computed:{cVersion(){return r.version}}},l=c,u=a("2877"),m=a("58a81"),d=a("eebe"),p=a.n(d),h=Object(u["a"])(l,s,n,!1,null,null,null),f=h.exports;p()(h,"components",{QBadge:m["a"]});var v=a("5c26"),g=a("41be"),b=function(){var t=this,e=t._self._c;return t.submenu?"configuracoes"==t.menuType?e("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"houverList menu-list-item",class:{"text-negative text-bolder":"negative"===t.color},attrs:{clickable:"",active:t.routeName==t.cRouterName,"active-class":"bg-grey-1 text-grey-8 text-bold menu-link-active-item-top"}},[t.icon?e("q-item-section",{attrs:{avatar:""}},[e("q-icon",{attrs:{name:"negative"===t.color?"mdi-cellphone-nfc-off":"eva-settings-2"}})],1):t._e(),e("q-item-section",[e("q-item-label",{staticClass:"menu-list-item-title"},[t._v(t._s(t.title))])],1),e("q-menu",{ref:"menu",attrs:{fit:"",anchor:"bottom right",self:"top middle"},on:{mouseover:function(e){return t.$root.$emit("submenu-mouseover")},mouseout:function(e){return t.$root.$emit("submenu-mouseout")},click:function(e){return e.stopPropagation(),t.$root.$emit("submenu-mouseout")}}},[e("q-list",[e("q-item",{attrs:{clickable:""},on:{click:()=>"sessoes"!=t.cRouterName?t.$router.push({name:"sessoes"}):""}},[e("q-item-section",[t._v("Canais")])],1),e("q-item",{attrs:{clickable:""},on:{click:()=>"horarioAtendimento"!=t.cRouterName?t.$router.push({name:"horarioAtendimento"}):""}},[e("q-item-section",[t._v("Horário de Atendimento")])],1),e("q-item",{attrs:{clickable:""},on:{click:()=>"api-service"!=t.cRouterName?t.$router.push({name:"api-service"}):""}},[e("q-item-section",[t._v("API")])],1),e("q-item",{attrs:{clickable:""},on:{click:()=>"integracoes"!=t.cRouterName?t.$router.push({name:"integracoes"}):""}},[e("q-item-section",[t._v("Integrações")])],1),e("q-item",{attrs:{clickable:""},on:{click:()=>"configuracoes"!=t.cRouterName?t.$router.push({name:"configuracoes"}):""}},[e("q-item-section",[t._v("Configurações")])],1)],1)],1),this.$q.screen.lt.md?t._e():e("q-tooltip",{attrs:{anchor:"center right",self:"center left"}},[e("div",{staticClass:"menu-list-item-tooltip"},[t._v("\n      Configurações\n    ")])])],1):"cadastros"==t.menuType?e("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"houverList menu-list-item",class:{"text-negative text-bolder":"negative"===t.color},attrs:{clickable:"",active:t.routeName==t.cRouterName,"active-class":"bg-grey-1 text-grey-8 text-bold menu-link-active-item-top"}},[t.icon?e("q-item-section",{attrs:{avatar:""}},[e("q-icon",{attrs:{name:"negative"===t.color?"mdi-cellphone-nfc-off":"eva-list"}})],1):t._e(),e("q-item-section",[e("q-item-label",{staticClass:"menu-list-item-title"},[t._v(t._s(t.title))])],1),e("q-menu",{ref:"menu",attrs:{fit:"",anchor:"bottom right",self:"top middle"},on:{mouseover:function(e){return t.$root.$emit("submenu-mouseover")},mouseout:function(e){return t.$root.$emit("submenu-mouseout")},click:function(e){return e.stopPropagation(),t.$root.$emit("submenu-mouseout")}}},[e("q-list",[e("q-item",{attrs:{clickable:""},on:{click:()=>"usuarios"!=t.cRouterName?t.$router.push({name:"usuarios"}):""}},[e("q-item-section",[t._v("Usuários")])],1),e("q-item",{attrs:{clickable:""},on:{click:()=>"filas"!=t.cRouterName?t.$router.push({name:"filas"}):""}},[e("q-item-section",[t._v("Filas")])],1),e("q-item",{attrs:{clickable:""},on:{click:()=>"equipes"!=t.cRouterName?t.$router.push({name:"equipes"}):""}},[e("q-item-section",[t._v("Equipes")])],1),e("q-item",{attrs:{clickable:""},on:{click:()=>"chat-flow"!=t.cRouterName?t.$router.push({name:"chat-flow"}):""}},[e("q-item-section",[t._v("Chatbot")])],1),e("q-item",{attrs:{clickable:""},on:{click:()=>"etiquetas"!=t.cRouterName?t.$router.push({name:"etiquetas"}):""}},[e("q-item-section",[t._v("Etiquetas")])],1),e("q-item",{attrs:{clickable:""},on:{click:()=>"protocolos"!=t.cRouterName?t.$router.push({name:"protocolos"}):""}},[e("q-item-section",[t._v("Protocolos")])],1),e("q-item",{attrs:{clickable:""},on:{click:()=>"agendamentos"!=t.cRouterName?t.$router.push({name:"agendamentos"}):""}},[e("q-item-section",[t._v("Agendamentos")])],1),e("q-item",{attrs:{clickable:""},on:{click:()=>"campanhas"!=t.cRouterName?t.$router.push({name:"campanhas"}):""}},[e("q-item-section",[t._v("Campanha")])],1)],1)],1),this.$q.screen.lt.md?t._e():e("q-tooltip",{attrs:{anchor:"center right",self:"center left"}},[e("div",{staticClass:"menu-list-item-tooltip"},[t._v("\n      Cadastros\n    ")])])],1):t._e():e("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"houverList menu-list-item full-width",class:{"text-negative text-bolder":"negative"===t.color},attrs:{clickable:"",active:t.routeName==t.cRouterName,"active-class":"bg-grey-1 text-grey-8 text-bold menu-link-active-item-top"},on:{click:()=>t.routeName!=t.cRouterName?t.$router.push({name:t.routeName}):""}},[t.icon?e("q-item-section",{attrs:{avatar:""}},[e("q-icon",{attrs:{name:"negative"===t.color?"mdi-cellphone-nfc-off":t.icon}})],1):t._e(),e("q-item-section",[e("q-item-label",{staticClass:"menu-list-item-title"},[t._v(t._s(t.title))])],1),this.$q.screen.lt.md?t._e():e("q-tooltip",{attrs:{anchor:"center right",self:"center left"}},[e("div",{staticClass:"menu-list-item-tooltip"},[t._v("\n      "+t._s(t.title)+"\n    ")])])],1)},S=[],y={name:"EssentialLink",data(){return{menuAtivo:"dashboard"}},props:{title:{type:String,required:!0},color:{type:String,default:""},routeName:{type:String,default:"dashboard"},icon:{type:String,default:""},submenu:{type:Boolean,default:!1},menuType:{type:String,default:""}},computed:{cRouterName(){return this.$route.name},cRouterNameNew(t){return t}},mounted(){this.userProfile=localStorage.getItem("profile")}},k=y,q=a("66e5"),_=a("4074"),I=a("0016"),N=a("0170"),w=a("05c0"),$=a("4e73"),x=a("1c1c"),A=a("714f"),O=Object(u["a"])(k,b,S,!1,null,null,null),C=O.exports;p()(O,"components",{QItem:q["a"],QItemSection:_["a"],QIcon:I["a"],QItemLabel:N["a"],QTooltip:w["a"],QMenu:$["a"],QList:x["a"]}),p()(O,"directives",{Ripple:A["a"]});var T=a("a18c"),E=a("29b2"),U=a("c5bd"),P=a("9a1b");const D=JSON.parse(localStorage.getItem("usuario")),M=+localStorage.getItem("userId");var j={data(){return{socket:null}},methods:{socketInitial(){this.socket=Object(E["a"])(),this.socket.on(`tokenInvalid:${this.socket.id}`,(()=>{this.socket.disconnect(),localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("profile"),localStorage.removeItem("userId"),localStorage.removeItem("usuario"),setTimeout((()=>{T["a"].push({name:"login"})}),1e3)})),this.socket.emit(`${D.tenantId}:joinNotification`),this.socket.on(`${D.tenantId}:whatsapp`,(t=>{"update"===t.action&&this.$store.commit("UPDATE_WHATSAPPS",t.whatsapp)})),this.socket.on(`${D.tenantId}:ticketList`,(async t=>{if(console.log("socket ON"),"chat:create"===t.type){var e;if(console.log("chat:create"),t.payload.ticket.userId!==M)return;if(t.payload.fromMe)return;const o=JSON.parse(localStorage.getItem("configuracoes")),i=null===o||void 0===o?void 0:o.find((t=>"groupnotification"===t.key));if("disabled"===(null===i||void 0===i?void 0:i.value)&&null!==(e=t.payload.ticket)&&void 0!==e&&e.isGroup)return;const s=new self.Notification("Contato: "+t.payload.ticket.contact.name,{body:"Mensagem: "+t.payload.body,tag:"simple-push-demo-notification",image:t.payload.ticket.contact.profilePicUrl,icon:t.payload.ticket.contact.profilePicUrl});console.log(s),console.log("enviou msg");const n={searchParam:"",pageNumber:1,status:["open"],showAll:!1,count:null,queuesIds:[],withUnreadMessages:!0,isNotAssignedUser:!1,includeNotQueueDefined:!0};console.log("Definiu parametros");try{console.log("try");const{data:t}=await Object(U["f"])(n);console.log("try 1"),this.countTickets=t.count,console.log("try 2"),this.$store.commit("UPDATE_NOTIFICATIONS",t),console.log("try 3")}catch(a){console.log("error try"),console.error(a)}}})),this.socket.on(`${D.tenantId}:whatsapp`,(t=>{"delete"===t.action&&this.$store.commit("DELETE_WHATSAPPS",t.whatsappId)})),this.socket.on(`${D.tenantId}:contactList`,(t=>{"contact:update"===t.type&&(console.log("socket ON: CONTACT:UPDATE"),this.$store.commit("UPDATE_CONTACT",t.payload))})),this.socket.on(`${D.tenantId}:whatsappSession`,(t=>{"update"===t.action&&(this.$store.commit("UPDATE_SESSION",t.session),this.$root.$emit("UPDATE_SESSION",t.session)),"readySession"===t.action&&this.$q.notify({position:"top",icon:"mdi-wifi-arrow-up-down",message:`A conexão com o WhatsApp está pronta e o mesmo está habilitado para enviar e receber mensagens. Conexão: ${t.session.name}. Número: ${t.session.number}.`,type:"positive",color:"primary",html:!0,progress:!0,timeout:7e3,actions:[{icon:"close",round:!0,color:"white"}],classes:"text-body2 text-weight-medium"})})),this.socket.on(`${D.tenantId}:change_battery`,(t=>{this.$q.notify({message:`Bateria do celular do whatsapp ${t.batteryInfo.sessionName} está com bateria em ${t.batteryInfo.battery}%. Necessário iniciar carregamento.`,type:"negative",progress:!0,position:"top",actions:[{icon:"close",round:!0,color:"white"}]})})),this.socket.on(`${D.tenantId}:ticketList`,(async t=>{var e=[];if("notification:new"===t.type){const i={searchParam:"",pageNumber:1,status:["open","pending","closed"],showAll:!1,count:null,queuesIds:[],withUnreadMessages:!1,isNotAssignedUser:!1,includeNotQueueDefined:!0};try{const t=await Object(U["f"])(i);this.$store.commit("UPDATE_NOTIFICATIONS_P",t.data),e=t}catch(o){this.$notificarErro("Algum problema",o),console.error(o)}var a=!1;if(e.data.tickets.forEach((e=>{a=e.id==t.payload.id||a})),a){const e=new self.Notification("Novo cliente pendente",{body:"Cliente: "+t.payload.contact.name,tag:"simple-push-demo-notification"});console.log(e)}}})),this.socket.on(`${D.tenantId}:ticketList`,(async t=>{"chat:ack"!==t.type&&"chat:delete"!==t.type||(console.log("socket ON: CHAT:ACK"),this.$store.commit("UPDATE_MESSAGE_STATUS",t.payload)),"chat:update"===t.type&&this.$store.commit("UPDATE_MESSAGE",t.payload)})),this.socket.on(`${D.tenantId}:mensagem-chat-interno`,(t=>{"update"!==t.action||t.data.receiverId!=D.userId&&null==t.data.groupId||this.$store.commit("MENSAGEM_INTERNA_UPDATE",t)})),this.socket.on(`${D.tenantId}:unread-mensagem-chat-interno`,(t=>{"update"===t.action&&t.data.senderId==D.userId&&this.$store.commit("UNREAD_MENSAGEM_INTERNA_UPDATE",t)})),this.socket.on(`${D.tenantId}:mensagem-chat-interno-notificacao`,(t=>{"update"!==t.action||t.data.receiverId!=D.userId&&null==t.data.groupId||this.$store.commit("NOTIFICACAO_CHAT_INTERNO_UPDATE",t)})),this.socket.on("verifyOnlineUsers",(t=>{this.$store.commit("LISTA_USUARIOS_CHAT_INTERNO",{action:"updateAllUsers",data:{}}),this.socket.emit(`${D.tenantId}:userVerified`,D)})),this.socket.on(`${D.tenantId}:user-online`,(t=>{"update"===t.action&&t.data.userId!==D.userId&&this.$store.commit("USER_CHAT_UPDATE",t)})),this.socket.on(`${D.tenantId}:updateStatusUser`,(async()=>{const{data:t}=await Object(P["f"])();this.$store.commit("LISTA_USUARIOS_CHAT_INTERNO",{action:"create",data:t.users})}))}},mounted(){this.socketInitial()},destroyed(){this.socket&&this.socket.disconnect()}},L=a("86e2"),R=a.n(L),Q=a("6b63"),H=a.n(Q),z=a("e103"),F=a.n(z),B=a("b166"),J=a("25c4"),V=a("2f62"),W=a("7963"),G=a("7884"),K=function(){var t=this,e=t._self._c;return e("div",[e("q-select",{attrs:{borderless:"",dense:"",rounded:"",options:t.statusOptions,"map-options":"","emit-value":""},on:{input:t.updateStatus},scopedSlots:t._u([{key:"selected",fn:function(){return[e("div",{staticClass:"row full-width justify-center"},[e("q-chip",{staticClass:"q-my-none q-ml-sm q-mr-none q-py-md",attrs:{color:"grey-3","text-color":"primary"}},[e("q-avatar",{attrs:{color:t.cStatus.color,"text-color":"white",size:"40px",icon:t.cStatus.icon,rounded:""}}),t._v("\n          "+t._s(t.cStatus.label)+"\n        ")],1)],1)]},proxy:!0}]),model:{value:t.usuario.status,callback:function(e){t.$set(t.usuario,"status",e)},expression:"usuario.status"}})],1)},Y=[],X={name:"cUserStatus",props:{usuario:{type:Object,default:()=>{}}},computed:{cStatus(){const t=this.usuario;return this.statusOptions.find((e=>e.value==t.status))||{}}},data(){return{status:{},statusOptions:[{label:"Online",value:"online",icon:"mdi-account-check",color:"positive"},{label:"Offline",value:"offline",icon:"mdi-account-off",color:"negative"}]}},methods:{updateStatus(t){const e={...this.usuario,status:t};localStorage.setItem("usuario",JSON.stringify(e)),this.$emit("update:usuario",e),console.log("usuario",e)}}},Z=X,tt=a("ddd8"),et=a("b047"),at=a("cb32"),ot=Object(u["a"])(Z,K,Y,!1,null,null,null),it=ot.exports;p()(ot,"components",{QSelect:tt["a"],QChip:et["a"],QAvatar:at["a"]});var st=function(){var t=this,e=t._self._c;return e("div",{class:["text-caption text-center q-pa-sm",{"bg-red":t.isDueSoon}]},[e("q-badge",{attrs:{align:"middle",color:"primary"}},[t._v("\n    "+t._s(t.duedate)+"\n  ")])],1)},nt=[],rt=a("6320"),ct=a("e3ee"),lt=a("3683"),ut={name:"Vencimento",data(){return{duedate:null,isDueSoon:!1}},methods:{async listarDate(){const{data:t}=await Object(rt["p"])(),e=Object(ct["a"])(t.dueDate),a=Object(B["a"])(e,"dd/MM/yyyy");this.duedate=a;const o=new Date,i=Object(lt["a"])(e,o);i<=3&&i>0?this.isDueSoon=!0:i<=0&&(this.isDueSoon=!0,this.$router.push("/financeiro"))}},async mounted(){await this.listarDate()}},mt=ut,dt=(a("914c"),Object(u["a"])(mt,st,nt,!1,null,null,null)),pt=dt.exports;p()(dt,"components",{QBadge:m["a"]});var ht=function(){var t,e=this,a=e._self._c;return"enabled"===(null===(t=e.informative)||void 0===t?void 0:t.value)?a("div",{staticClass:"q-pa-sm text-center",style:{backgroundColor:e.colorinformative.value}},[a("b",{style:{color:e.colorinformativetext.value}},[e._v(e._s(e.textinformative.value))])]):e._e()},ft=[],vt=a("a0b3"),gt={name:"Informativo",data(){return{informative:null,textinformative:null,colorinformative:null,colorinformativetext:null}},async mounted(){var t;const{data:e}=await Object(vt["c"])();this.configuracoes=e,this.informative=this.configuracoes.find((t=>"informative"===t.key)),"enabled"===(null===(t=this.informative)||void 0===t?void 0:t.value)&&(this.textinformative=this.configuracoes.find((t=>"textinformative"===t.key)),this.colorinformative=this.configuracoes.find((t=>"colorinformative"===t.key)),this.colorinformativetext=this.configuracoes.find((t=>"colorinformativetext"===t.key)))}},bt=gt,St=Object(u["a"])(bt,ht,ft,!1,null,null,null),yt=St.exports,kt=a("c3f3");const qt=localStorage.getItem("username"),_t=Object(E["a"])(),It=[{title:"Dashboard",caption:"",icon:"mdi-home",routeName:"home-dashboard"},{title:"Atendimentos",caption:"Lista de atendimentos",icon:"mdi-whatsapp",routeName:"chat-empty"},{title:"Contatos",caption:"Lista de contatos",icon:"mdi-card-account-mail",routeName:"contatos"},{title:"Kanban",caption:"Kanban",icon:"mdi-monitor-dashboard",routeName:"kanban"},{title:"Chat Interno",caption:"Chat",icon:"mdi-forum-outline",routeName:"chat-interno"},{title:"Mensagens Rápidas",caption:"Mensagens pré-definidas",icon:"mdi-reply-all-outline",routeName:"mensagens-rapidas"},{title:"Tarefas",caption:"Tarefas",icon:"mdi-clipboard-list-outline",routeName:"tarefas"},{title:"Despedida",caption:"Mensagens de despedida",icon:"mdi-message-bulleted-off",routeName:"despedida"},{title:"Ajuda",caption:"Ajuda",icon:"mdi-help",routeName:"ajuda"}],Nt=[{title:"Painel Atendimentos",caption:"Visão geral dos atendimentos",icon:"mdi-view-dashboard-variant",routeName:"painel-atendimentos"},{title:"Relatórios",caption:"Relatórios gerais",icon:"mdi-file-chart",routeName:"relatorios"},{title:"Financeiro",caption:"Financeiro",icon:"mdi-cash-multiple",routeName:"financeiro"}];var wt={name:"MainLayout",mixins:[j],components:{EssentialLink:C,ModalUsuario:J["a"],cStatusUsuario:it,cSystemVersion:f,vencimento:pt,informative:yt},data(){return{delayed:0,venceHoje:0,whatsappId:null,username:qt,domainExperimentalsMenus:["@"],miniState:!0,userProfile:"user",modalUsuario:!1,usuario:{},isSilentMode:!1,alertSound:R.a,alertInterno:F.a,silenceSound:H.a,leftDrawerOpen:!1,menuData:It,menuDataAdmin:Nt,countTickets:0,ticketsList:[],notificacaoInternaNaoLida:""}},computed:{currentAlertSound(){return this.isSilentMode?this.silenceSound:this.alertSound},...Object(V["b"])(["notifications","notifications_p","whatsapps","showMenu","chatFocado","notificacaoChatInterno","notificacoesChat","notificacaoTicket"]),cProblemaConexao(){const t=this.whatsapps.findIndex((t=>["PAIRING","TIMEOUT","DISCONNECTED"].includes(t.status)));return-1!==t},cQrCode(){const t=this.whatsapps.findIndex((t=>"qrcode"===t.status||"DESTROYED"===t.status));return-1!==t},cOpening(){const t=this.whatsapps.findIndex((t=>"OPENING"===t.status));return-1!==t},cUsersApp(){return this.$store.state.usersApp},cObjMenu(){return this.cProblemaConexao?It.map((t=>("sessoes"===t.routeName&&(t.color="negative"),t))):It}},watch:{notificacaoChatInterno:{handler(){if(this.$router.currentRoute.fullPath.indexOf("atendimento-Interno")<0||!this.chatFocado.id||this.chatFocado.id!==this.notificacaoChatInterno.senderId){this.$store.commit("LISTA_NOTIFICACOES_CHAT_INTERNO",{action:"update",data:1}),this.listarMensagens();const t=new Audio(F.a);if(t.play(),"Notification"in window&&"granted"===Notification.permission){const t={body:`${this.notificacaoChatInterno.text} - ${Object(B["a"])(new Date,"HH:mm")}`,tag:this.notificacaoChatInterno.id,renotify:!0},e=new Notification(`Mensagem de ${this.notificacaoChatInterno.sender.name}`,t);e.onclick=t=>{t.preventDefault(),window.focus(),this.$router.push({name:"chat-interno"})}}}}},notificacaoTicket:{handler(){this.$nextTick((()=>{this.$refs.audioNotification.play()}))}}},methods:{toggleSilentMode(){this.isSilentMode=!this.isSilentMode,localStorage.setItem("silentMode",this.isSilentMode),window.location.reload()},async getTaskSummary(){const t=localStorage.getItem("username");try{const e=await Object(g["b"])({owner:t});this.delayed=e.data.delayed,this.venceHoje=e.data.venceHoje}catch(e){console.error("Erro ao consultar resumo de tarefas:",e)}},async listarMensagens(){try{const{data:t}=await Object(kt["b"])(this.usuario.userId);this.notificacaoInternaNaoLida=t.count}catch(t){}},reloadPage(){window.location.reload()},exibirMenuBeta(t){if(null===t||void 0===t||!t.isBeta)return!0;for(const e of this.domainExperimentalsMenus)if(-1!==this.usuario.email.indexOf(e))return!0;return!1},exibirMenuEmpresas(t){const e=JSON.parse(localStorage.getItem("usuario"));return 1==e.tenantId},async listarWhatsapps(){const{data:t}=await Object(v["d"])();this.$store.commit("LOAD_WHATSAPPS",t)},validaTelaAdmin(t){const e=JSON.parse(localStorage.getItem("usuario"));return"empresas"!==t.routeName||1==e.tenantId},async abrirModalUsuario(){this.modalUsuario=!0},async efetuarLogout(){try{await Object(G["b"])(this.usuario),localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("profile"),localStorage.removeItem("userId"),localStorage.removeItem("queues"),localStorage.removeItem("usuario"),localStorage.removeItem("filtrosAtendimento"),this.$router.go({name:"login",replace:!0})}catch(t){this.$notificarErro("Não foi possível realizar logout",t)}},async listarConfiguracoes(){const{data:t}=await Object(W["b"])();localStorage.setItem("configuracoes",JSON.stringify(t))},conectarSocket(t){_t.on(`${t.tenantId}:chat:updateOnlineBubbles`,(t=>{this.$store.commit("SET_USERS_APP",t)}))},atualizarUsuario(){this.usuario=JSON.parse(localStorage.getItem("usuario")),"offline"===this.usuario.status&&_t.emit(`${this.usuario.tenantId}:setUserIdle`),"online"===this.usuario.status&&_t.emit(`${this.usuario.tenantId}:setUserActive`)},async consultarTickets(){const t={searchParam:"",pageNumber:1,status:["open"],showAll:!1,count:null,queuesIds:[],withUnreadMessages:!0,isNotAssignedUser:!1,includeNotQueueDefined:!0};try{const{data:e}=await Object(U["f"])(t);this.countTickets=e.count,this.$store.commit("UPDATE_NOTIFICATIONS",e),setTimeout((()=>{this.$store.commit("UPDATE_NOTIFICATIONS",e)}),500)}catch(a){this.$notificarErro("Algum problema",a),console.error(a)}const e={searchParam:"",pageNumber:1,status:["pending"],showAll:!1,count:null,queuesIds:[],withUnreadMessages:!1,isNotAssignedUser:!1,includeNotQueueDefined:!0};try{const{data:t}=await Object(U["f"])(e);this.countTickets=t.count,this.$store.commit("UPDATE_NOTIFICATIONS_P",t),setTimeout((()=>{this.$store.commit("UPDATE_NOTIFICATIONS_P",t)}),500)}catch(a){this.$notificarErro("Algum problema",a),console.error(a)}}},async mounted(){this.$root.$on("submenu-mouseover",(()=>{this.miniState=!1})),this.$root.$on("submenu-mouseout",(()=>{this.miniState=!0}));const t=localStorage.getItem("silentMode");null!==t&&(this.isSilentMode=JSON.parse(t)),this.getTaskSummary(),this.atualizarUsuario(),await this.listarWhatsapps(),await this.listarConfiguracoes(),await this.consultarTickets(),await this.listarMensagens(),this.socket.on("disconnect",(()=>{console.log("Socket disconnected. Trying to reconnect..."),this.socket.connect()})),"Notification"in window&&("granted"!==Notification.permission&&await Notification.requestPermission(),this.usuario=JSON.parse(localStorage.getItem("usuario")),this.userProfile=localStorage.getItem("profile"),await this.conectarSocket(this.usuario),this.atualizarUsuario(),await this.listarWhatsapps(),await this.listarConfiguracoes(),await this.consultarTickets(),this.socket.on("chat:update",this.handlerNotifications)),this.usuario=JSON.parse(localStorage.getItem("usuario")),this.userProfile=localStorage.getItem("profile"),await this.conectarSocket(this.usuario)},destroyed(){_t.disconnect()}},$t=wt,xt=(a("6b32"),a("4d5a")),At=a("9c40"),Ot=a("65c6"),Ct=a("eb85"),Tt=a("9404"),Et=a("4983"),Ut=a("9564"),Pt=a("09e3"),Dt=a("9989"),Mt=a("068f"),jt=a("7f67"),Lt=Object(u["a"])($t,o,i,!1,null,"2b93342e",null);e["default"]=Lt.exports;p()(Lt,"components",{QLayout:xt["a"],QBtn:At["a"],QToolbar:Ot["a"],QTooltip:w["a"],QBadge:m["a"],QMenu:$["a"],QList:x["a"],QItem:q["a"],QItemSection:_["a"],QAvatar:at["a"],QItemLabel:N["a"],QSeparator:Ct["a"],QDrawer:Tt["a"],QScrollArea:Et["a"],QToggle:Ut["a"],QPageContainer:Pt["a"],QPage:Dt["a"],QImg:Mt["a"]}),p()(Lt,"directives",{ClosePopup:jt["a"]})},"86e2":function(t,e,a){t.exports=a.p+"media/sound.151899dd.mp3"},"914c":function(t,e,a){"use strict";a("3982")},9224:function(t){t.exports=JSON.parse('{"name":"whazing-frontend","version":"2.7.3","description":"Bot Multiatendimento, multicanais e multiempresas.","productName":"Whazing","author":"cleitonme <cleitonme@gmail.com>","private":false,"scripts":{"fix":"eslint --ext .js,.vue ./ --fix","lint":"eslint --ext .js,.vue ./","test":"echo \\"No test specified\\" && exit 0","start":"pm2 start server.js --name whazing-frontend","stop":"pm2 stop server.js --name whazing-frontend","build":"export NODE_OPTIONS=--openssl-legacy-provider && npx quasar build -P -m pwa","dev":"export NODE_OPTIONS=--openssl-legacy-provider && npx quasar dev"},"dependencies":{"@quasar/cli":"^2.4.1","@quasar/extras":"^1.16.12","@quasar/quasar-ui-qcalendar":"^4.0.0-beta.16","apexcharts":"^3.52.0","axios":"^1.7.4","chart.js":"^4.4.4","core-js":"^3.38.1","date-fns":"^2.30.0","dotenv":"^16.4.5","drawflow":"0.0.59","js-base64":"^3.7.7","jspdf":"^2.5.1","lodash":"^4.17.21","mic-recorder-to-mp3":"^2.2.2","printd":"^1.6.0","qrcode.vue":"^1.7.0","quasar":"^1.22.10","socket.io-client":"^3.1.3","v-emoji-picker":"^2.3.3","vdata-parser":"^0.1.5","vue":"^2.7.14","vue-apexcharts":"^1.6.2","vue-codemirror":"^4.0.6","vue-drag-n-drop":"^1.3.0","vue-easy-lightbox":"^0.23.0","vue-infinite-loading":"^2.4.5","vue-linkify":"^1.0.1","vue-loader":"^15.11.1","vue-star-rating":"^1.7.0","vue-tel-input":"^5.16.0","vue-virtual-scroller":"^1.1.2","vuedraggable":"^2.24.3","vuelidate":"^0.7.7","vuelidate-error-extractor":"^2.4.1","xlsx":"^0.17.5"},"devDependencies":{"@babel/plugin-proposal-optional-chaining":"^7.21.0","@quasar/app":"^2.4.4","babel-eslint":"^10.1.0","eslint":"^6.8.0","eslint-config-standard":"^14.1.0","eslint-loader":"^3.0.3","eslint-plugin-import":"^2.29.1","eslint-plugin-node":"^11.1.0","eslint-plugin-promise":"^4.3.1","eslint-plugin-standard":"^4.0.0","eslint-plugin-vue":"^6.2.2","quasar-app-extension-qdatetimepicker":"^1.0.0-rc.18","workbox-webpack-plugin":"^6.6.0"},"browserslist":["last 10 Chrome versions","last 10 Firefox versions","last 4 Edge versions","last 7 Safari versions","last 8 Android versions","last 8 ChromeAndroid versions","last 8 FirefoxAndroid versions","last 10 iOS versions","last 5 Opera versions"],"engines":{"node":">=20.16.0","npm":">=10.8.2","yarn":">=1.21.1"}}')},b3e5:function(t,e,a){},e103:function(t,e,a){t.exports=a.p+"media/chatInterno.cab36c2d.mp3"}}]);