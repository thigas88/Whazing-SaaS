(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"0bbc":function(t,a,e){"use strict";e.r(a);var o=function(){var t=this,a=t._self._c;return a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("q-table",{staticClass:"contact-table container-rounded-10 my-sticky-dynamic q-ma-lg",attrs:{square:"",flat:"",bordered:"","hide-bottom":"",data:t.listachatFlow,columns:t.columns,loading:t.loading,"row-key":"id",pagination:t.pagination,"rows-per-page-options":[0]},on:{"update:pagination":function(a){t.pagination=a}},scopedSlots:t._u([{key:"top-left",fn:function(){return[a("div",[a("h2",{class:t.$q.dark.isActive?"text-green":""},[a("q-icon",{attrs:{name:"mdi-robot-outline q-pr-sm"}}),t._v("\n              Fluxos\n            ")],1),a("q-btn",{staticClass:"generate-button btn-rounded-50",attrs:{icon:"eva-plus-outline",label:"Adicionar"},on:{click:function(a){t.chatFlowSelecionado={},t.modalChatFlow=!0}}}),a("q-btn",{staticClass:"generate-button btn-rounded-50",attrs:{icon:"mdi-import",label:"Importar"},on:{click:function(a){t.modalImportFlow=!0}}}),t.whatsappNumber?a("q-btn",{staticClass:"generate-button btn-rounded-50",attrs:{flat:"",icon:"mdi-whatsapp",label:"Chamar Suporte"},on:{click:t.abrirWhatsApp}}):t._e()],1)]},proxy:!0},{key:"body-cell-isActive",fn:function(e){return[a("q-td",{staticClass:"text-center"},[a("q-icon",{attrs:{size:"16px",name:e.value?"mdi-check-circle-outline":"mdi-close-circle-outline",color:e.value?"positive":"negative"}}),a("span",{staticClass:"q-mx-xs text-bold"},[t._v(" "+t._s(e.value?"Ativo":"Inativo")+" ")])],1)]}},{key:"body-cell-acoes",fn:function(e){return[a("q-td",{staticClass:"text-center"},[a("q-btn",{staticClass:"q-mx-sm",class:t.$q.dark.isActive?"text-green bg-black":"",attrs:{icon:"eva-edit-outline",flat:"",round:""},on:{click:function(a){return t.editFlow(e.row)}}},[a("q-tooltip",[t._v("\n                Editar informações\n              ")])],1),a("q-btn",{staticClass:"q-mx-sm",class:t.$q.dark.isActive?"text-green bg-black":"",attrs:{icon:"mdi-sitemap",flat:"",round:""},on:{click:function(a){return t.abrirFluxo(e.row)}}},[a("q-tooltip",[t._v("\n                Abrir Fluxo\n              ")])],1),a("q-btn",{staticClass:"q-mx-sm",class:t.$q.dark.isActive?"text-green bg-black":"",attrs:{icon:"eva-trash-outline",flat:"",round:""},on:{click:function(a){return t.deletarFluxo(e.row)}}},[a("q-tooltip",[t._v("\n                Excluir\n              ")])],1)],1)]}}])})],1)]),a("ModalChatFlow",{attrs:{modalChatFlow:t.modalChatFlow,chatFlowEdicao:t.chatFlowSelecionado},on:{"update:modalChatFlow":function(a){t.modalChatFlow=a},"update:modal-chat-flow":function(a){t.modalChatFlow=a},"update:chatFlowEdicao":function(a){t.chatFlowSelecionado=a},"update:chat-flow-edicao":function(a){t.chatFlowSelecionado=a},"chatFlow:criada":t.novoFluxoCriado,"chatFlow:editado":t.fluxoEditado}}),a("ModalImportFlow",{attrs:{modalImportFlow:t.modalImportFlow},on:{"update:modalImportFlow":function(a){t.modalImportFlow=a},"update:modal-import-flow":function(a){t.modalImportFlow=a},"chatFlow:criada":t.novoFluxoCriado}}),a("q-dialog",{attrs:{persistent:""},model:{value:t.confirmDelete,callback:function(a){t.confirmDelete=a},expression:"confirmDelete"}},[a("q-card",{staticStyle:{"min-width":"350px"}},[a("q-card-section",[a("div",{staticClass:"text-h6"},[t._v("Você tem certeza que dessa excluir esse fluxo?")]),a("div",[t._v(t._s(t.chatFlowSelecionado.name))])]),a("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mr-md",attrs:{label:"Cancelar",color:"primary"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Excluir",color:"negative"},on:{click:function(a){return t.confirmDeleteFoo()}}})],1)],1)],1)],1)},i=[],l=(e("14d9"),e("ee0e")),s=e("824a"),n=e("9a1b"),c=e("a0b3"),r=function(){var t=this,a=t._self._c;return a("q-dialog",{attrs:{value:t.modalChatFlow,persistent:""},on:{hide:t.fecharModal,show:t.abrirModal}},[a("q-card",{staticClass:"q-pa-lg modal-container container-rounded-10"},[a("q-card-actions",{staticClass:"q-mt-md",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"negative",icon:"eva-close",flat:""}})],1),a("q-card-section",[a("div",{staticClass:"text-h6 text-center font-family-main"},[t._v("\n        "+t._s(t.chatFlow.isDuplicate?"Duplicar":t.chatFlowEdicao.id?"Editar":"Criar")+" Fluxo\n        "),t.chatFlow.isDuplicate?a("span",[t._v(" (Nome: "+t._s(t.chatFlowEdicao.name)+") ")]):t._e()])]),a("q-card-section",{staticClass:"q-pa-lg container-border container-rounded-10"},[a("div",{staticClass:"text-h6 font-family-main q-mb-sm"},[t._v("\n        Informações\n      ")]),a("q-input",{staticClass:"row col",attrs:{rounded:"",outlined:"",label:"Descrição"},model:{value:t.chatFlow.name,callback:function(a){t.$set(t.chatFlow,"name",a)},expression:"chatFlow.name"}}),a("div",{staticClass:"row col q-mt-md"},[a("q-checkbox",{attrs:{label:"Ativo"},model:{value:t.chatFlow.isActive,callback:function(a){t.$set(t.chatFlow,"isActive",a)},expression:"chatFlow.isActive"}})],1),a("div",{staticClass:"row col q-mt-md"},[a("q-input",{staticClass:"full-width",attrs:{clearable:"",rounded:"",outlined:"",label:"Número para Teste",hint:"Deixe limpo para que a Auto resposta funcione. Caso contrário, irá funcionar somente para o número informado aqui."},model:{value:t.chatFlow.celularTeste,callback:function(a){t.$set(t.chatFlow,"celularTeste",a)},expression:"chatFlow.celularTeste"}})],1)],1),a("q-card-actions",{staticClass:"q-mt-md",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mr-md btn-rounded-50",attrs:{label:"Cancelar",color:"negative"}}),a("q-btn",{class:{"generate-button":!0,"btn-rounded-50":!0,"generate-button-dark":t.$q.dark.isActive,"generate-button-light":!t.$q.dark.isActive},attrs:{label:"Salvar",icon:"eva-save-outline"},on:{click:t.handleAutoresposta}})],1)],1)],1)},d=[];const u={name:"Fluxo Inicial",nodeList:[{id:"start",name:"Início",type:"start",left:"26px",top:"100px",ico:"mdi-play",viewOnly:!0,status:"success",style:{}},{id:"configurations",name:"Configurações",type:"configurations",left:"340px",top:"100px",viewOnly:!0,ico:"mdi-alert-circle-outline",configurations:{notOptionsSelectMessage:{message:"",stepReturn:"A"},notResponseMessage:{time:10,type:1,destiny:"",message:""},welcomeMessage:{message:""},maxRetryBotMessage:{number:3,type:1,destiny:""},outOpenHours:{type:3,destiny:null}}},{id:"nodeC",name:"Boas vindas!",type:"node",left:"26px",top:"301px",interactions:[],conditions:[],actions:[]}],lineList:[{from:"start",to:"nodeC",paintStyle:{strokeWidth:3,stroke:"#5c67f2"}}]};function p(){return u}const m=+localStorage.getItem("userId");var h={name:"ModalNovoChatFlow",props:{modalChatFlow:{type:Boolean,default:!1},chatFlowEdicao:{type:Object,default:()=>({id:null})}},data(){return{chatFlow:{name:null,userId:m,celularTeste:null,isActive:!0}}},methods:{abrirModal(){this.chatFlowEdicao.id?this.chatFlow={...this.chatFlowEdicao,userId:m}:this.chatFlow={name:null,action:0,userId:m,celularTeste:null,isActive:!0}},fecharModal(){this.chatFlow={name:null,action:0,userId:m,celularTeste:null,isActive:!0},this.$emit("update:chatFlowEdicao",{id:null}),this.$emit("update:modalChatFlow",!1)},async handleAutoresposta(){var t,a;const e={...p(),...this.chatFlow,id:null};if(!this.chatFlow.id||null!==(t=this.chatFlow)&&void 0!==t&&t.isDuplicate){if(!this.chatFlow.id&&(null===(a=this.chatFlow)||void 0===a||!a.isDuplicate)){const{data:t}=await Object(s["a"])(e);this.$notificarSucesso("Novo fluxo criado."),this.$emit("chatFlow:criada",t)}}else{const{data:t}=await Object(s["d"])(this.chatFlow);this.$notificarSucesso("Fluxo editado."),this.$emit("chatFlow:editado",t)}this.fecharModal()}}},w=h,f=(e("32fe"),e("2877")),b=e("24e8"),F=e("f09f"),v=e("4b7e"),C=e("9c40"),g=e("a370"),q=e("27f9"),x=e("8f8e"),y=e("0016"),k=e("7f67"),A=e("eebe"),I=e.n(A),S=Object(f["a"])(w,r,d,!1,null,"67d1276a",null),_=S.exports;I()(S,"components",{QDialog:b["a"],QCard:F["a"],QCardActions:v["a"],QBtn:C["a"],QCardSection:g["a"],QInput:q["a"],QCheckbox:x["a"],QIcon:y["a"]}),I()(S,"directives",{ClosePopup:k["a"]});var Q=function(){var t=this,a=t._self._c;return a("q-dialog",{attrs:{value:t.modalImportFlow,persistent:""},on:{hide:t.fecharModal,show:t.abrirModal}},[a("q-card",{staticClass:"q-pa-lg modal-container container-rounded-10"},[a("q-card-actions",{staticClass:"q-mt-md",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"negative",icon:"eva-close",flat:""}})],1),a("q-card-section",[a("div",{staticClass:"text-h6 text-center font-family-main"},[t._v("\n        Importar Fluxo\n      ")])]),a("q-card-section",{staticClass:"q-pa-lg container-border container-rounded-10"},[a("q-separator",{attrs:{spaced:""}}),a("div",{staticClass:"col-12"},[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{tag:"label"}},[a("q-item-section",[a("q-item-label",[t._v("Selecionar arquivo para importar:")])],1),a("q-item-section",{attrs:{avatar:""}},[a("input",{ref:"fileInput",staticClass:"file-input",attrs:{type:"file",accept:"application/json"},on:{change:t.onFileChange}}),a("button",{staticClass:"btn-rounded-50",class:{"file-button":!0,"file-button-dark":t.$q.dark.isActive,"file-button-light":!t.$q.dark.isActive},on:{click:t.triggerFileInput}},[a("q-icon",{attrs:{name:"eva-plus-outline"}}),t._v("\n              Escolher arquivo\n            ")],1)])],1)],1)],1)],1)],1)},$=[],E={name:"ModalImportFlow",props:{modalImportFlow:{type:Boolean,default:!1}},data(){return{importedFlow:null}},methods:{fecharModal(){this.importedFlow=null,this.$emit("update:chatFlowEdicao",{id:null}),this.$emit("update:modalImportFlow",!1)},async handleAutoresposta(){const t=this.importedFlow,{data:a}=await Object(s["a"])(t);this.$notificarSucesso("Novo fluxo criado."),this.$emit("chatFlow:criada",a),this.fecharModal()},onFileChange(t){const a=t.target.files[0],e=new FileReader;e.onload=async t=>{try{this.importedFlow=JSON.parse(t.target.result),this.$notificarSucesso("Fluxo importado com sucesso."),await this.handleAutoresposta()}catch(a){this.$notificarErro("Erro ao importar fluxo. Verifique o arquivo e tente novamente.")}},e.readAsText(a)},triggerFileInput(){this.$refs.fileInput.click()}}},M=E,N=(e("e701"),e("eb85")),O=e("66e5"),D=e("4074"),T=e("0170"),j=e("714f"),B=Object(f["a"])(M,Q,$,!1,null,"42111d93",null),P=B.exports;I()(B,"components",{QDialog:b["a"],QCard:F["a"],QCardActions:v["a"],QBtn:C["a"],QCardSection:g["a"],QSeparator:N["a"],QItem:O["a"],QItemSection:D["a"],QItemLabel:T["a"],QIcon:y["a"]}),I()(B,"directives",{ClosePopup:k["a"],Ripple:j["a"]});var R={name:"ChatFlowIndex",components:{ModalChatFlow:_,ModalImportFlow:P},data(){return{confirmDelete:!1,listachatFlow:[],modalChatFlow:!1,modalImportFlow:!1,whatsappNumber:null,chatFlowSelecionado:{},pagination:{rowsPerPage:40,rowsNumber:0,lastIndex:0},params:{pageNumber:1,searchParam:null,hasMore:!0},loading:!1,columns:[{name:"name",label:"Nome",field:"name",align:"left"},{name:"isActive",label:"Status",field:"isActive",align:"center"},{name:"celularTeste",label:"Celular Teste",field:"celularTeste",align:"center"},{name:"acoes",label:"",field:"acoes",align:"center"}],filas:[],usuarios:[]}},methods:{async fetchConfigurations(){try{const t=await Object(c["b"])(),a=t.data;this.whatsappNumber=a.whatsappnumber||null}catch(t){console.error("Erro ao buscar configurações:",t)}},abrirWhatsApp(){if(this.whatsappNumber){const t=`https://wa.me/${this.whatsappNumber}?text=Ol%C3%A1%21+tenho+duvidas+bot`;window.open(t,"_blank")}},async listarChatFlow(){const{data:t}=await Object(s["c"])();this.listachatFlow=t.chatFlow},async listarFilas(){const{data:t}=await Object(l["d"])({isActive:!0});this.filas=t.filter((t=>t.isActive))},async listarUsuarios(){const{data:t}=await Object(n["e"])(this.params);this.usuarios=t.users},novoFluxoCriado(t){const a=[...this.listachatFlow];a.push(t),this.listachatFlow=a},fluxoEditado(t){const a=[...this.listachatFlow.filter((a=>a.id!==t.id))];a.push(t),this.listachatFlow=a},editFlow(t){this.chatFlowSelecionado=t,this.modalChatFlow=!0},async abrirFluxo(t){await this.$store.commit("SET_FLOW_DATA",{usuarios:this.usuarios,filas:this.filas,flow:t}),this.$router.push({name:"chat-flow-builder"})},deletarFluxo(t){this.chatFlowSelecionado=t,this.confirmDelete=!0},async confirmDeleteFoo(t){await Object(s["b"])(this.chatFlowSelecionado),await this.listarChatFlow()}},async mounted(){this.fetchConfigurations(),await this.listarChatFlow(),await this.listarFilas(),await this.listarUsuarios()}},L=R,W=e("eaac"),J=e("db86"),z=e("05c0"),U=Object(f["a"])(L,o,i,!1,null,"7bd2afba",null);a["default"]=U.exports;I()(U,"components",{QTable:W["a"],QIcon:y["a"],QBtn:C["a"],QTd:J["a"],QTooltip:z["a"],QDialog:b["a"],QCard:F["a"],QCardSection:g["a"],QCardActions:v["a"]}),I()(U,"directives",{ClosePopup:k["a"]})},"32fe":function(t,a,e){"use strict";e("c7cc")},"59c1":function(t,a,e){},c7cc:function(t,a,e){},e701:function(t,a,e){"use strict";e("59c1")}}]);