(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{0:function(t,e){},"006a":function(t,e,a){"use strict";a("14d9");var o=function(){var t=this,e=t._self._c;return e("q-dialog",{attrs:{value:t.modalContato,persistent:""},on:{show:t.fetchContact,hide:function(e){return t.$emit("update:modalContato",!1)}}},[e("q-card",{staticClass:"q-pa-md modal-container container-rounded-10"},[e("q-card-actions",{staticClass:"q-mt-lg",attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-px-md",attrs:{flat:"",dense:"",icon:"eva-close",color:"negative"}})],1),e("q-card-section",[e("div",{staticClass:"text-h6 text-center font-family-main"},[t._v("\n        "+t._s(t.contactId?"Editar Contato":"Adicionar Contato")+"\n      ")])]),e("div",{staticClass:"row flex-gap-1",staticStyle:{gap:"1vh"}},[e("div",{staticClass:"full-width container-border container-rounded-10 q-ml-lg q-mr-lg"},[e("q-card-section",{staticClass:"q-py-sm text-bold font-family-main"},[t._v("\n      Dados Contato\n    ")]),e("q-card-section",{staticClass:"row q-col-gutter-md"},[e("c-input",{staticClass:"col-12",attrs:{rounded:"",outlined:"",validator:t.$v.contato.name,label:"Nome"},on:{blur:t.$v.contato.name.$touch},model:{value:t.contato.name,callback:function(e){t.$set(t.contato,"name",e)},expression:"contato.name"}}),e("vue-tel-input",{staticClass:"col-12",attrs:{rounded:"",outlined:"","default-country":"br","preferred-countries":["br"],"auto-format":!0,label:"Número","only-country":!1,hint:"Número do celular deverá conter 9 dígitos e ser precedido do DDI E DDD."},model:{value:t.contato.number,callback:function(e){t.$set(t.contato,"number",e)},expression:"contato.number"}}),e("c-input",{staticClass:"col-12",attrs:{outlined:"",rounded:"",validator:t.$v.contato.email,label:"E-mail"},on:{blur:t.$v.contato.email.$touch},model:{value:t.contato.email,callback:function(e){t.$set(t.contato,"email",e)},expression:"contato.email"}}),e("q-checkbox",{attrs:{label:"Desativar BOT"},model:{value:t.contato.disableBot,callback:function(e){t.$set(t.contato,"disableBot",e)},expression:"contato.disableBot"}}),e("q-checkbox",{attrs:{label:"Desativar Campanha"},model:{value:t.contato.disableCampaign,callback:function(e){t.$set(t.contato,"disableCampaign",e)},expression:"contato.disableCampaign"}}),e("q-checkbox",{attrs:{label:"Desativar Kanban"},model:{value:t.contato.disableKanban,callback:function(e){t.$set(t.contato,"disableKanban",e)},expression:"contato.disableKanban"}})],1)],1),e("div",{staticClass:"full-width container-border container-rounded-10 q-ml-lg q-mr-lg"},[e("q-card-section",[e("q-card",{staticClass:"bg-white q-mt-sm btn-rounded",attrs:{bordered:"",flat:""}},[e("q-card-section",{staticClass:"font-family-main text-bold q-pb-none"},[t._v("\n          Carteira\n          "),e("q-separator")],1),e("q-card-section",{staticClass:"q-pa-none"},[e("q-select",{staticClass:"col-12",attrs:{square:"",borderless:"",multiple:"","max-values":1,options:t.usuarios,"use-chips":"","option-value":"id","option-label":"name","emit-value":"","map-options":"","dropdown-icon":"add"},scopedSlots:t._u([{key:"option",fn:function({itemProps:a,itemEvents:o,opt:i,selected:n,toggleOption:s}){return[e("q-item",t._g(t._b({},"q-item",a,!1),o),[e("q-item-section",[e("q-item-label",{domProps:{innerHTML:t._s(i.name)}})],1),e("q-item-section",{attrs:{side:""}},[e("q-checkbox",{attrs:{value:n},on:{input:function(t){return s(i)}}})],1)],1)]}},{key:"selected-item",fn:function({opt:a}){return[e("q-chip",{staticClass:"q-ma-xs row col-12 text-body1",attrs:{dense:"",square:"",color:"white","text-color":"primary"}},[t._v("\n                "+t._s(a.name)+"\n              ")])]}},{key:"no-option",fn:function({itemProps:a,itemEvents:o}){return[e("q-item",t._g(t._b({},"q-item",a,!1),o),[e("q-item-section",[e("q-item-label",{staticClass:"text-negative text-bold"},[t._v("\n                    Ops... Sem carteiras disponíveis!!\n                  ")])],1)],1)]}}]),model:{value:t.contato.wallets,callback:function(e){t.$set(t.contato,"wallets",e)},expression:"contato.wallets"}})],1)],1)],1),e("q-card-section",[e("q-card",{staticClass:"bg-white q-mt-sm btn-rounded",attrs:{bordered:"",flat:""}},[e("q-card-section",{staticClass:"font-family-main text-bold q-pb-none"},[t._v("\n          Etiqueta\n          "),e("q-separator")],1),e("q-card-section",{staticClass:"q-pa-none"},[e("q-select",{staticClass:"col-12",attrs:{square:"",borderless:"",multiple:"",options:t.etiquetas,"use-chips":"","option-value":"id","option-label":"tag","emit-value":"","map-options":"","dropdown-icon":"add"},scopedSlots:t._u([{key:"option",fn:function({itemProps:a,itemEvents:o,opt:i,selected:n,toggleOption:s}){return[e("q-item",t._g(t._b({},"q-item",a,!1),o),[e("q-item-section",[e("q-item-label",{domProps:{innerHTML:t._s(i.tag)}})],1),e("q-item-section",{attrs:{side:""}},[e("q-checkbox",{attrs:{value:n},on:{input:function(t){return s(i)}}})],1)],1)]}},{key:"selected-item",fn:function({opt:a}){return[e("q-chip",{staticClass:"q-ma-xs row col-12 text-body1",attrs:{dense:"",square:"",color:"white","text-color":"primary"}},[e("q-icon",{staticClass:"q-mr-sm",style:{color:a.color},attrs:{name:"mdi-pound-box-outline",size:"28px"}}),t._v("\n                "+t._s(a.tag)+"\n              ")],1)]}},{key:"no-option",fn:function({itemProps:a,itemEvents:o}){return[e("q-item",t._g(t._b({},"q-item",a,!1),o),[e("q-item-section",[e("q-item-label",{staticClass:"text-negative text-bold"},[t._v("\n                    Ops... Sem etiquetas disponíveis!!\n                  ")])],1)],1)]}}]),model:{value:t.contato.tags,callback:function(e){t.$set(t.contato,"tags",e)},expression:"contato.tags"}})],1)],1)],1)],1),e("div",{staticClass:"full-width container-border container-rounded-10 q-ml-lg q-mr-lg"},[e("q-card-section",{staticClass:"font-family-main q-py-sm text-bold"},[t._v("\n      Informações adicionais\n    ")]),e("q-card-section",{staticClass:"row q-col-gutter-md justify-center"},[t._l(t.contato.extraInfo,(function(a,o){return[e("div",{key:o,staticClass:"col-12 row justify-center q-col-gutter-sm"},[e("q-input",{staticClass:"col-12 col-md-6",attrs:{outlined:"",label:"Descrição"},model:{value:a.name,callback:function(e){t.$set(a,"name",e)},expression:"extraInfo.name"}}),e("q-input",{staticClass:"col-12 col-md-6",attrs:{outlined:"",label:"Informação"},model:{value:a.value,callback:function(e){t.$set(a,"value",e)},expression:"extraInfo.value"}}),e("div",{staticClass:"col q-pt-md"},[e("q-btn",{key:o,attrs:{icon:"delete",round:"",flat:"",color:"negative"},on:{click:function(e){return t.removeExtraInfo(o)}}})],1)],1)]})),e("div",{staticClass:"col-12"},[e("q-btn",{staticClass:"full-width",attrs:{color:"primary",outline:"",label:"Adicionar Informação"},on:{click:function(e){return t.contato.extraInfo.push({name:null,value:null})}}})],1)],2)],1)]),e("q-card-actions",{staticClass:"q-mt-lg",attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-px-md btn-rounded-50",attrs:{label:"Cancelar",color:"negative"}}),e("q-btn",{staticClass:"q-ml-lg q-px-md btn-rounded-50",attrs:{icon:"eva-save-outline",label:"Salvar",color:"primary"},on:{click:t.saveContact}})],1)],1)],1)},i=[],n=a("b5ae"),s=a("73ad"),r=a("9a1b"),c=a("163e"),l=a("e75b"),d={name:"ContatoModal",components:{VueTelInput:l["VueTelInput"]},props:{modalContato:{type:Boolean,default:!1},contactId:{type:Number,default:null}},data(){return{contato:{name:null,number:null,email:"",extraInfo:[],wallets:[],tags:[],disableBot:!1,disableCampaign:!1,disableKanban:!1},usuarios:[],etiquetas:[]}},validations:{contato:{name:{required:n["required"],minLength:Object(n["minLength"])(3),maxLength:Object(n["maxLength"])(50)},email:{email:n["email"]},number:{required:n["required"],minLength:Object(n["minLength"])(8)}}},methods:{async fetchContact(){try{if(await this.listarUsuarios(),!this.contactId)return;const{data:t}=await Object(s["i"])(this.contactId);this.contato=t,this.contato.number=`+${t.number}`}catch(t){console.error(t),this.$notificarErro("Ocorreu um erro!",t)}},removeExtraInfo(t){const e={...this.contato};e.extraInfo.splice(t,1),this.contato={...e}},async saveContact(){if(this.$v.contato.$touch(),this.$v.contato.$error)return this.$q.notify({type:"warning",progress:!0,position:"top",message:"Ops! Verifique os erros...",actions:[{icon:"close",round:!0,color:"white"}]});const t={...this.contato,number:this.contato.number.replace(/\D/g,"")};try{if(this.contactId){const{data:e}=await Object(s["d"])(this.contactId,t);await Object(s["e"])(this.contactId,[...this.contato.tags]),this.$emit("contatoModal:contato-editado",e),this.$q.notify({type:"info",progress:!0,position:"top",textColor:"black",message:"Contato editado!",actions:[{icon:"close",round:!0,color:"white"}]})}else{const{data:e}=await Object(s["a"])(t);this.$q.notify({type:"positive",progress:!0,position:"top",message:"Contato criado!",actions:[{icon:"close",round:!0,color:"white"}]}),this.$emit("contatoModal:contato-criado",e)}this.$emit("update:modalContato",!1)}catch(e){console.error("Erro capturado: ",e),e.data&&"NOT_FOUND_WHATSAPP_CONNECTED"===e.data.error?this.$q.notify({type:"negative",progress:!0,position:"top",message:"Não encontramos Whatsapp Conectado",actions:[{icon:"close",round:!0,color:"white"}]}):e.data&&"CONTACT_NOT_FOUND"===e.data.error?this.$q.notify({type:"negative",progress:!0,position:"top",message:"Não encontramos Whatsapp no número que você tentou cadastrar",actions:[{icon:"close",round:!0,color:"white"}]}):this.$notificarErro("Ocorreu um erro ao criar o contato",e)}},async listarUsuarios(){try{const{data:t}=await Object(r["e"])();this.usuarios=t.users}catch(t){console.error(t),this.$notificarErro("Problema ao carregar usuários",t)}},async listarEtiquetas(){try{const{data:t}=await Object(c["d"])(!0);this.etiquetas=t}catch(t){console.error(t),this.$notificarErro("Problema ao carregar etiquetas",t)}}},beforeMount(){this.listarEtiquetas()},destroyed(){this.$v.contato.$reset()}},u=d,m=(a("890e"),a("2877")),p=a("24e8"),h=a("f09f"),g=a("4b7e"),f=a("9c40"),b=a("a370"),v=a("8f8e"),y=a("eb85"),q=a("ddd8"),w=a("66e5"),C=a("4074"),k=a("0170"),x=a("b047"),_=a("0016"),O=a("27f9"),I=a("7f67"),$=a("eebe"),M=a.n($),T=Object(m["a"])(u,o,i,!1,null,null,null);e["a"]=T.exports;M()(T,"components",{QDialog:p["a"],QCard:h["a"],QCardActions:g["a"],QBtn:f["a"],QCardSection:b["a"],QCheckbox:v["a"],QSeparator:y["a"],QSelect:q["a"],QItem:w["a"],QItemSection:C["a"],QItemLabel:k["a"],QChip:x["a"],QIcon:_["a"],QInput:O["a"]}),M()(T,"directives",{ClosePopup:I["a"]})},"0582":function(t,e,a){"use strict";class o{setPhoneFormatMask(t){if(!t||t.length<12)return;const e=(""+t).replace(/\D/g,"");if(e.length<=12){const t=e.match(/^(\d{2})(\d{2})(\d{4})(\d{4})$/);return"+"+t[1]+" ("+t[2]+") "+t[3]+"-"+t[4]}if(13===e.length){const t=e.match(/^(\d{2})(\d{2})(\d{5})(\d{4})$/);return"+"+t[1]+" ("+t[2]+") "+t[3]+"-"+t[4]}return null}removeMask(t){const e=t.replace(/\D/g,"");return e}maskPhonePattern(t){return t.length<13?"+55 (99) 9999 9999":"+55 (99) 99999 9999"}}const i=t=>{var e;const a=new o,i=null===t||void 0===t?void 0:t.replace("@c.us","");return null===(e=a.setPhoneFormatMask(i))||void 0===e?void 0:e.replace("+55","🇧🇷")};e["a"]=i},"0b67":function(t,e,a){"use strict";a("14d9");var o=a("a18c");const i=t=>{var e,a;const o={searchParam:"",pageNumber:1,status:["open","pending","closed"],showAll:!1,count:null,queuesIds:[],withUnreadMessages:!1,isNotAssignedUser:!1,includeNotQueueDefined:!0},i=()=>{const t=JSON.parse(localStorage.getItem("configuracoes")),e=null===t||void 0===t?void 0:t.find((t=>"NotViewTicketsChatBot"===t.key));return"enabled"===(null===e||void 0===e?void 0:e.value)},n=()=>{const t=JSON.parse(localStorage.getItem("configuracoes")),e=null===t||void 0===t?void 0:t.find((t=>"DirectTicketsToWallets"===t.key));return"enabled"===(null===e||void 0===e?void 0:e.value)},s=()=>{const t=JSON.parse(localStorage.getItem("configuracoes")),e=null===t||void 0===t?void 0:t.find((t=>"NotViewAssignedTickets"===t.key));return"enabled"===(null===e||void 0===e?void 0:e.value)},r=JSON.parse(localStorage.getItem("filtrosAtendimento"))||o,c=JSON.parse(localStorage.getItem("usuario")),l=JSON.parse(localStorage.getItem("queues")),d=JSON.parse(localStorage.getItem("filasCadastradas")||"[]"),u=localStorage.getItem("profile"),m="admin"===u&&r.showAll,p=d.length>0,h=(null===c||void 0===c?void 0:c.userId)||+localStorage.getItem("userId");if(m)return console.log("isAdminShowAll",m),!0;if(t.isGroup)return console.log("ticket.isGroup",t.isGroup),!0;if(r.status.length>0&&!r.status.includes(t.status))return console.log("Status ticket",r.status,t.status),!1;if((null===t||void 0===t?void 0:t.userId)==h)return console.log("Ticket do usuário",null===t||void 0===t?void 0:t.userId,h),!0;if(i()&&t.autoReplyId&&(null===t||void 0===t||!t.userId)&&!t.queueId)return console.log("NotViewTicketsChatBot e o ticket está sem usuário e fila definida"),!1;let g=!0;if(p){const e=l.findIndex((e=>t.queueId===e.id));if(-1===e)return console.log("Usuario não tem acesso a fila",t.queueId),!1;console.log("Fila do ticket liberada para o Usuario",t.queueId),g=!0}if(p&&null!==r&&void 0!==r&&r.queuesIds.length){const e=r.queuesIds.findIndex((e=>t.queueId===e));if(-1==e)return console.log("filas filtradas e diferentes da do ticket",t.queueId),!1}if(n()&&((null===t||void 0===t||null===(e=t.contact)||void 0===e||null===(a=e.wallets)||void 0===a?void 0:a.length)||0)>0){var f;const e=null===t||void 0===t||null===(f=t.contact)||void 0===f?void 0:f.wallets.findIndex((t=>t.id==h));return-1!==e?(console.log("Ticket da carteira do usuário"),!0):(console.log("DirectTicketsToWallets: Ticket não pertence à carteira do usuário",t),!1)}return s()&&((null===t||void 0===t?void 0:t.userId)||h)!==h?(console.log("isNotViewAssignedTickets e ticket não é do usuário",null===t||void 0===t?void 0:t.userId,h),null===t||void 0===t||!t.userId):r.isNotAssignedUser?(console.log("isNotAssignedUser ativo para exibir somente tickets não assinados",r.isNotAssignedUser,!t.userId),r.isNotAssignedUser&&!t.userId):g};var n=i,s=a("29b2"),r=a("c5bd");const c=JSON.parse(localStorage.getItem("usuario")),l=Object(s["a"])(),d=+localStorage.getItem("userId");l.on(`tokenInvalid:${l.id}`,(()=>{l.disconnect(),localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("profile"),localStorage.removeItem("userId"),localStorage.removeItem("usuario"),setTimeout((()=>{o["a"].push({name:"login"})}),1e3)}));e["a"]={created(){this.setupSocketListeners(),this.socketTicketList()},methods:{setupSocketListeners(){l.on(`${c.tenantId}:mensagem-chat-interno`,(t=>{"update"!==t.action||t.data.receiverId!=c.userId&&null==t.data.groupId||this.$store.commit("MENSAGEM_INTERNA_UPDATE",t)})),l.on(`${c.tenantId}:unread-mensagem-chat-interno`,(t=>{"update"===t.action&&t.data.senderId==c.userId&&this.$store.commit("UNREAD_MENSAGEM_INTERNA_UPDATE",t)})),l.on(`${c.tenantId}:mensagem-chat-interno-notificacao`,(t=>{"update"!==t.action||t.data.receiverId!=c.userId&&null==t.data.groupId||this.$store.commit("NOTIFICACAO_CHAT_INTERNO_UPDATE",t)})),l.on("verifyOnlineUsers",(t=>{this.$store.commit("LISTA_USUARIOS_CHAT_INTERNO",{action:"updateAllUsers",data:{}}),l.emit(`${c.tenantId}:userVerified`,c)})),l.on(`${c.tenantId}:user-online`,(t=>{"update"===t.action&&t.data.userId!==c.userId&&this.$store.commit("USER_CHAT_UPDATE",t)}))},scrollToBottom(){setTimeout((()=>{this.$root.$emit("scrollToBottomMessageChat")}),200)},socketMessagesList(){},socketTicket(){l.on("connect",(()=>{l.on(`${c.tenantId}:ticket`,(t=>{"update"===t.action&&t.ticket.userId===d&&("open"!==t.ticket.status||t.ticket.isTransference||this.$store.commit("TICKET_FOCADO",t.ticket))}))}))},socketTicketList(){this.socketTicketListNew()},socketTicketListNew(){l.on("connect",(()=>{l.on(`${c.tenantId}:ticketList`,(async t=>{if("chat:create"===t.type){t.payload.read||t.payload.ticket.userId!==d&&t.payload.ticket.userId||t.payload.ticket.id===this.$store.getters.ticketFocado.id||n(t.payload.ticket)&&this.handlerNotifications(t.payload),this.$store.commit("UPDATE_MESSAGES",t.payload),this.scrollToBottom();const a={searchParam:"",pageNumber:1,status:["open","pending","closed"],showAll:!1,count:null,queuesIds:[],withUnreadMessages:[!0,!1],isNotAssignedUser:[!0,!1],includeNotQueueDefined:[!0,!1]};try{const{data:t}=await Object(r["f"])(a);this.countTickets=t.count,this.$store.commit("UPDATE_NOTIFICATIONS",t)}catch(e){console.log("error try"),this.$notificarErro("Algum problema",e),console.error(e)}}"chat:ack"!==t.type&&"chat:delete"!==t.type||this.$store.commit("UPDATE_MESSAGE_STATUS",t.payload),"chat:update"===t.type&&this.$store.commit("UPDATE_MESSAGE",t.payload),"ticket:update"===t.type&&(this.$store.commit("UPDATE_TICKET",t.payload),this.$store.commit("UPDATE_NOTIFICATIONS",t.payload))})),l.on(`${c.tenantId}:ticketList`,(async t=>{var e=[];if("notification:new"===t.type){const i={searchParam:"",pageNumber:1,status:["open","pending","closed"],showAll:!1,count:null,queuesIds:[],withUnreadMessages:!1,isNotAssignedUser:!1,includeNotQueueDefined:!0};try{const t=await Object(r["f"])(i);this.$store.commit("UPDATE_NOTIFICATIONS_P",t.data),e=t}catch(o){this.$notificarErro("Algum problema",o),console.error(o)}var a=!1;e.data.tickets.forEach((e=>{a=e.id==t.payload.id||a}))}})),l.on(`${c.tenantId}:contactList`,(t=>{this.$store.commit("UPDATE_CONTACT",t.payload)}))}))},handlerNotifications(t){},socketDisconnect(){l.disconnect()}}}},"0cb4":function(t,e,a){"use strict";a.d(e,"d",(function(){return i})),a.d(e,"e",(function(){return n})),a.d(e,"b",(function(){return s})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return c}));var o=a("8982");function i(){return Object(o["a"])({url:"/farewellMessages/",method:"get"})}function n(){return Object(o["a"])({url:"/farewellMessages/all/",method:"get"})}function s(t){return Object(o["a"])({url:"/farewellMessages/",method:"post",data:t})}function r(t){return Object(o["a"])({url:`/farewellMessages/${t.id}`,method:"delete"})}function c(t){return Object(o["a"])({url:`/farewellMessages/${t.id}`,method:"put",data:t})}},"0ffe":function(t,e,a){"use strict";var o=function(){var t,e=this,a=e._self._c;return a("q-list",{staticClass:"q-px-sm q-py-none q-pt-sm",staticStyle:{"max-width":"100%"},attrs:{separator:""}},[a("q-item",{staticClass:"ticketBorder q-px-sm",class:{ticketBorderGrey:!e.$q.dark.isActive,"ticket-active-item":e.ticket.id===e.$store.getters["ticketFocado"].id,ticketNotAnswered:0==e.ticket.answered&&0==e.ticket.isGroup&&"open"==e.ticket.status},staticStyle:{height:"95px","max-width":"100%"},style:`border-left: 6px solid ${e.borderColor[e.ticket.status]}; border-radius: 10px`,attrs:{clickable:"",id:"item-ticket-houve"},on:{click:function(t){return e.abrirChatContato(e.ticket)}}},[a("q-item-section",{staticClass:"q-px-none",attrs:{avatar:""}},["pending"===e.ticket.status||e.buscaTicket&&"pending"===e.ticket.status?a("q-btn",{attrs:{flat:"",push:"",color:"green",dense:"",round:""},on:{click:function(t){return e.iniciarAtendimento(e.ticket)}}},[e.ticket.unreadMessages?a("q-badge",{staticClass:"text-center text-bold",staticStyle:{"border-radius":"10px"},attrs:{floating:"",dense:"","text-color":"white",color:"red",label:e.ticket.unreadMessages}}):e._e(),a("q-avatar",[a("q-icon",{attrs:{size:"50px",name:"mdi-account-arrow-right"}})],1),a("q-tooltip",[e._v("\n            Atender\n          ")])],1):e._e(),"pending"!==e.ticket.status?a("q-avatar",{staticClass:"relative-position",attrs:{size:"50px"}},[e.ticket.unreadMessages?a("q-badge",{staticClass:"text-center text-bold",staticStyle:{"border-radius":"10px","z-index":"99"},attrs:{floating:"",dense:"","text-color":"white",color:"red",label:e.ticket.unreadMessages}}):e._e(),a("img",{directives:[{name:"show",rawName:"v-show",value:e.ticket.contact.profilePicUrl,expression:"ticket.contact.profilePicUrl"}],attrs:{src:e.ticket.contact.profilePicUrl,onerror:"this.style.display='none'"}}),a("q-icon",{attrs:{size:"50px",name:"mdi-account-circle",color:"grey-8"}})],1):e._e()],1),a("q-item-section",{attrs:{id:"ListItemsTicket"}},[a("q-item-label",{staticClass:"text-bold",attrs:{lines:"1"}},[e._v("\n          "+e._s(e.ticket.name?e.ticket.name:e.ticket.contact.name)+"\n          "),a("q-icon",{attrs:{size:"20px",name:`img:${e.ticket.channel}-logo.png`}}),a("span",{staticClass:"absolute-top-right q-pr-xs"},[a("q-badge",{key:e.recalcularHora,staticStyle:{"font-size":".7em"},attrs:{dense:"",transparent:"",square:"","text-color":"green-5",color:"secondary",label:e.dataInWords(e.ticket.lastMessageAt,e.ticket.updatedAt)}})],1)],1),a("q-item-label",{attrs:{lines:"1",caption:""}},[e._v("\n          "+e._s(e.truncatedMessage(e.ticket.lastMessage,20))+"\n        ")]),a("q-item-label",{attrs:{lines:"1",caption:""}},[e._v("\n          #"+e._s(e.ticket.id)+"\n          "),e._l(e.tagsDoTicket,(function(t){return a("q-icon",{key:t.tag,staticClass:"q-mb-sm",style:{color:t.color},attrs:{name:"mdi-tag",size:"1.4em"}},[a("q-tooltip",[e._v("\n              "+e._s(t&&t.tag)+"\n            ")])],1)})),e._l(e.walletsDoTicket,(function(t){return a("q-icon",{key:t.wallet,staticClass:"q-mb-sm",attrs:{name:"mdi-wallet",size:"1.4em"}},[a("q-tooltip",[e._v("\n              "+e._s(t.wallet)+"\n            ")])],1)})),a("q-chip",{staticClass:"q-mr-md text-bold",style:e.chipStyle,attrs:{dense:"",square:"",label:e.chipLabel,size:"11px"}}),a("span",{staticClass:"absolute-bottom-right"},["closed"===e.ticket.status?a("q-icon",{staticClass:"q-mb-sm",attrs:{name:"mdi-check-circle-outline",color:"positive",size:"1.8em"}},[a("q-tooltip",[e._v("\n                Atendimento Resolvido\n              ")])],1):e._e(),e.ticket.stepAutoReplyId&&e.ticket.autoReplyId&&"pending"===e.ticket.status||e.ticket.chatFlowId&&e.ticket.stepChatFlow&&"pending"===e.ticket.status?a("q-icon",{staticClass:"q-mb-sm",attrs:{name:"mdi-robot",color:"primary",size:"1.8em"}},[a("q-tooltip",[e._v("\n                ChatBot atendendo\n              ")])],1):e._e(),e.ticket.typebotStatus&&e.ticket.useIntegration&&"pending"===e.ticket.status?a("q-icon",{staticClass:"q-mb-sm",attrs:{name:"mdi-robot-outline",color:"primary",size:"1.8em"}},[a("q-tooltip",[e._v("\n                Typebot atendendo\n              ")])],1):e._e(),e.ticket.IA&&e.ticket.useIntegration&&"pending"===e.ticket.status?a("q-icon",{staticClass:"q-mb-sm",attrs:{name:"mdi-robot-happy",color:"primary",size:"1.8em"}},[a("q-tooltip",[e._v("\n                IA atendendo\n              ")])],1):e._e()],1)],2),a("q-item-label",{staticClass:"row col items-center justify-between",attrs:{caption:""}},[e._v("\n          "+e._s((null===(t=e.ticket.user)||void 0===t?void 0:t.name)||"")+"\n          "),a("q-chip",{staticClass:"q-mr-md text-bold",style:{backgroundColor:e.ticket.whatsapp.color,color:"white"},attrs:{dense:"",square:"",label:e.ticket.whatsapp&&e.ticket.whatsapp.name,size:"10px"}})],1)],1),a("q-item-section",{staticClass:"q-px-none",attrs:{avatar:""}},["open"===e.ticket.status||e.buscaTicket&&"open"===e.ticket.status?a("q-btn",{staticClass:"btn-rounded",class:{"text-green bg-black":e.$q.dark.isActive,"tab-item":!e.$q.dark.isActive},attrs:{flat:"",push:"",dense:"",round:""},on:{click:function(t){return e.atualizarStatusTicket2(e.ticket,"closed")}}},[a("q-avatar",[a("q-icon",{attrs:{size:"20px",name:"eva-checkmark-circle-2-outline"}})],1),a("q-tooltip",[e._v("\n            Resolver\n          ")])],1):e._e()],1)],1)],1)},i=[],n=a("3d09"),s=a("1556"),r=a("e018"),c=a("fcbb"),l=a("5a7a"),d=a("73ad"),u={name:"ItemTicket",mixins:[c["a"]],data(){return{isTicketModalOpen:!1,currentTicket:{},tagsDoTicket:[],walletsDoTicket:[],outlinedAccountCircle:l["a"],recalcularHora:1,statusAbreviado:{open:"A",pending:"P",closed:"R"},status:{open:"Aberto",pending:"Pendente",closed:"Resolvido"},color:{open:"primary",pending:"negative",closed:"positive"},borderColor:{open:"primary",pending:"negative",closed:"positive"}}},props:{ticket:{type:Object,default:()=>{}},buscaTicket:{type:Boolean,default:!1},filas:{type:Array,default:()=>[]},etiquetas:{type:Array,default:()=>[]}},computed:{chipStyle(){return{backgroundColor:this.ticket.color||this.obterCorFila(this.ticket)||"grey",color:"white"}},chipLabel(){return this.obterNomeFila(this.ticket)||"SEM FILA"}},async mounted(){this.tagsDoTicket=await this.obterInformacoes(this.ticket,"tags"),this.walletsDoTicket=await this.obterInformacoes(this.ticket,"carteiras")},methods:{truncatedMessage(t,e){return t?t.length>e?t.substring(0,e)+"...":t:""},closeModal(){this.isTicketModalOpen=!1},obterNomeFila(t){try{const e=this.filas.find((e=>e.id===t.queueId));return e?e.queue:""}catch(e){return""}},obterCorFila(t){try{const e=this.filas.find((e=>e.id===t.queueId));return e?e.color:""}catch(e){return""}},async obterInformacoes(t,e){try{if(!["tags","carteiras"].includes(e))return console.error(`Tipo de informação inválido: ${e}`),[];const a=await Object(d["i"])(t.contactId);if(!a||!a.data)return console.error("Contato não encontrado ou dados inválidos"),[];if("tags"===e){const t=a.data.tags||[];return t.map((t=>({tag:t.tag,color:t.color})))}if("carteiras"===e){const t=a.data.wallets||[];return t.map((t=>({wallet:t.name})))}return[]}catch(a){return console.error(`Erro ao obter ${e}:`,a),[]}},dataInWords(t,e){let a=Object(n["a"])(e);return t&&(a=new Date(Number(t))),Object(s["a"])(a,new Date,{locale:r["a"]})},abrirChatContato(t){this.$q.screen.lt.md&&"pending"!==t.status&&this.$root.$emit("infor-cabecalo-chat:acao-menu"),t.id===this.$store.getters.ticketFocado.id&&"chat"===this.$route.name||(this.$store.commit("SET_HAS_MORE",!0),this.$store.dispatch("AbrirChatMensagens",t))}},created(){setInterval((()=>{this.recalcularHora++}),2e4)}},m=u,p=(a("1c33"),a("2877")),h=a("1c1c"),g=a("66e5"),f=a("4074"),b=a("9c40"),v=a("58a81"),y=a("cb32"),q=a("0016"),w=a("05c0"),C=a("0170"),k=a("b047"),x=a("eebe"),_=a.n(x),O=Object(p["a"])(m,o,i,!1,null,null,null);e["a"]=O.exports;_()(O,"components",{QList:h["a"],QItem:g["a"],QItemSection:f["a"],QBtn:b["a"],QBadge:v["a"],QAvatar:y["a"],QIcon:q["a"],QTooltip:w["a"],QItemLabel:C["a"],QChip:k["a"]})},1394:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"d",(function(){return n})),a.d(e,"a",(function(){return s})),a.d(e,"c",(function(){return r}));var o=a("8982");function i(t){return Object(o["a"])({url:"/fastreply/",method:"post",data:t})}function n(){return Object(o["a"])({url:"/fastreply/",method:"get"})}function s(t,e){if(t)return Object(o["a"])({url:`/fastreply/${t}`,method:"put",data:e})}function r(t){return Object(o["a"])({url:`/fastreply/${t.id}`,method:"delete"})}},"163e":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"d",(function(){return n})),a.d(e,"a",(function(){return s})),a.d(e,"c",(function(){return r}));var o=a("8982");function i(t){return Object(o["a"])({url:"/tags/",method:"post",data:t})}function n(t=null){return Object(o["a"])({url:`/tags/?isActive=${t}`,method:"get"})}function s(t){return Object(o["a"])({url:`/tags/${t.id}`,method:"put",data:t})}function r(t){return Object(o["a"])({url:`/tags/${t.id}`,method:"delete"})}},"1c33":function(t,e,a){"use strict";a("e517")},2:function(t,e){},"25c4":function(t,e,a){"use strict";var o=function(){var t=this,e=t._self._c;return e("q-dialog",{attrs:{persistent:"",value:t.modalUsuario},on:{hide:t.fecharModal,show:t.abrirModal}},[e("q-card",{staticClass:"container-rounded-10 modal-container q-pa-lg"},[e("q-card-actions",{attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"negative",icon:"eva-close-outline"}})],1),e("q-card-section",[e("div",{staticClass:"text-h6 text-center font-family-main"},[t._v(t._s(t.usuario.name?"Editar":"Cadastrar")+" Usuário")])]),e("div",{staticClass:"container-border container-rounded-10"},[e("q-card-section",{staticClass:"row flex-gap-1 q-col-gutter-sm"},[e("div",{staticClass:"text-h6 font-family-main"},[t._v("\n        Informações\n      ")]),e("div",{staticClass:"flex-gap-1 full-width row q-col-gutter-sm"},[e("div",{staticClass:"full-width"},[e("c-input",{attrs:{outlined:"",validator:t.$v.usuario.name,label:"Nome",rounded:""},on:{blur:t.$v.usuario.name.$touch},model:{value:t.usuario.name,callback:function(e){t.$set(t.usuario,"name","string"===typeof e?e.trim():e)},expression:"usuario.name"}})],1),e("div",{staticClass:"full-width"},[e("c-input",{attrs:{outlined:"",validator:t.$v.usuario.email,label:"E-mail",rounded:""},on:{blur:t.$v.usuario.email.$touch},model:{value:t.usuario.email,callback:function(e){t.$set(t.usuario,"email","string"===typeof e?e.trim():e)},expression:"usuario.email"}})],1)]),e("div",{staticClass:"flex-gap-1 full-width row q-col-gutter-sm"},[e("div",{staticClass:"full-width"},[e("c-input",{attrs:{rounded:"",outlined:"",validator:t.$v.usuario.password,type:t.isPwd?"password":"text",label:"Senha"},on:{blur:t.$v.usuario.password.$touch},scopedSlots:t._u([{key:"append",fn:function(){return[e("q-icon",{staticClass:"cursor-pointer",attrs:{name:t.isPwd?"visibility_off":"visibility"},on:{click:function(e){t.isPwd=!t.isPwd}}})]},proxy:!0}]),model:{value:t.usuario.password,callback:function(e){t.$set(t.usuario,"password",e)},expression:"usuario.password"}})],1),e("div",{staticClass:"full-width"},[e("q-select",{attrs:{rounded:"",disable:t.isProfile,outlined:"",options:t.optionsProfile,"option-value":"value","option-label":"label","emit-value":"","map-options":"",label:"Perfil"},model:{value:t.usuario.profile,callback:function(e){t.$set(t.usuario,"profile",e)},expression:"usuario.profile"}})],1),"user"===t.usuario.profile?e("div",{staticClass:"full-width"},[t.isProfile?t._e():e("q-checkbox",{attrs:{label:"Ignorar carteira - Listar todos contatos"},model:{value:t.usuario.allcontacts,callback:function(e){t.$set(t.usuario,"allcontacts",e)},expression:"usuario.allcontacts"}})],1):t._e()])])],1),e("q-card-actions",{attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-px-md q-mr-sm btn-rounded-50",attrs:{label:"Cancelar",color:"negative"}}),e("q-btn",{staticClass:"q-px-md btn-rounded-50 generate-button",attrs:{label:"Salvar",icon:"eva-save-outline"},on:{click:t.handleUsuario}})],1)],1)],1)},i=[],n=a("b5ae"),s=a("9a1b"),r=a("2a19"),c={name:"ModalUsuario",props:{modalUsuario:{type:Boolean,default:!1},isProfile:{type:Boolean,default:!1},usuarioEdicao:{type:Object,default:()=>({id:null})}},data(){return{isPwd:!1,optionsProfile:[{value:"user",label:"Usuário"},{value:"admin",label:"Administrador"}],usuario:{name:"",email:"",password:"",profile:"user",allcontacts:!1}}},validations(){let t={name:{required:n["required"],minLength:Object(n["minLength"])(3),maxLength:Object(n["maxLength"])(50)},email:{required:n["required"],email:n["email"]},profile:{required:n["required"]},password:{}};return this.usuario.id||(t={...t,password:{required:n["required"],minLength:Object(n["minLength"])(6),maxLength:Object(n["maxLength"])(50)}}),{usuario:t}},methods:{abrirModal(){this.usuarioEdicao.id&&(this.usuario={...this.usuarioEdicao}),this.usuarioEdicao.userId&&(this.usuario={...this.usuarioEdicao,id:this.usuarioEdicao.userId,name:this.usuarioEdicao.username,profile:this.usuarioEdicao.profile,allcontacts:this.usuarioEdicao.allcontacts})},fecharModal(){this.isProfile||this.$emit("update:usuarioEdicao",{}),this.$emit("update:modalUsuario",!1),this.usuario={name:"",email:"",password:"",profile:"user",allcontacts:!1},this.isPwd=!1,this.$v.usuario.$reset()},async handleUsuario(){if(this.$v.usuario.$touch(),this.$v.usuario.$error)return this.$q.notify({type:"warning",progress:!0,position:"top",message:"Ops! Verifique os erros...",actions:[{icon:"close",round:!0,color:"white"}]});try{if(this.usuario.id){const{email:t,id:e,name:a,tenantId:o,password:i,profile:n,allcontacts:r}=this.usuario,c={email:t,id:e,name:a,tenantId:o,password:i,profile:n,allcontacts:r};this.$store.state.user.isAdmin&&(c.profile=this.usuario.profile);const{data:l}=await Object(s["h"])(this.usuario.id,c);this.$emit("modalUsuario:usuario-editado",l),this.$q.notify({type:"info",progress:!0,position:"top",textColor:"black",message:"Usuário editado!",actions:[{icon:"close",round:!0,color:"white"}]})}else{const{data:t}=await Object(s["b"])(this.usuario);this.$emit("modalUsuario:usuario-criado",t),this.$q.notify({type:"positive",progress:!0,position:"top",message:"Usuário criado!",actions:[{icon:"close",round:!0,color:"white"}]})}this.$emit("update:modalUsuario",!1)}catch(t){console.error(t,"ERR_USER_LIMIT_USER_CREATION"===t.data.error),"ERR_USER_LIMIT_USER_CREATION"===t.data.error&&r["a"].create({type:"negative",message:"Limite de usuario atingido.",caption:"ERR_USER_LIMIT_USER_CREATION",position:"top",progress:!0})}}}},l=c,d=a("2877"),u=a("24e8"),m=a("f09f"),p=a("4b7e"),h=a("9c40"),g=a("a370"),f=a("0016"),b=a("ddd8"),v=a("8f8e"),y=a("7f67"),q=a("eebe"),w=a.n(q),C=Object(d["a"])(l,o,i,!1,null,"2396eb3c",null);e["a"]=C.exports;w()(C,"components",{QDialog:u["a"],QCard:m["a"],QCardActions:p["a"],QBtn:h["a"],QCardSection:g["a"],QIcon:f["a"],QSelect:b["a"],QCheckbox:v["a"]}),w()(C,"directives",{ClosePopup:y["a"]})},3:function(t,e){},3655:function(t,e,a){"use strict";a("d73a")},"41be":function(t,e,a){"use strict";a.d(e,"c",(function(){return i})),a.d(e,"e",(function(){return n})),a.d(e,"a",(function(){return s})),a.d(e,"d",(function(){return r})),a.d(e,"b",(function(){return c}));var o=a("8982");function i(t){return Object(o["a"])({url:"/tasks/",method:"post",data:t})}function n(){return Object(o["a"])({url:"/tasks/",method:"get"})}function s(t){return Object(o["a"])({url:`/tasks/${t.id}`,method:"put",data:t})}function r(t){return Object(o["a"])({url:`/tasks/${t.id}`,method:"delete"})}function c(t){return Object(o["a"])({url:"/tasks/summary",method:"post",data:t})}},"44a9":function(t,e,a){"use strict";a("a29e")},5654:function(t,e,a){"use strict";a.d(e,"e",(function(){return i})),a.d(e,"d",(function(){return n})),a.d(e,"c",(function(){return s})),a.d(e,"b",(function(){return r})),a.d(e,"a",(function(){return c}));var o=a("8982");function i(t){return Object(o["a"])({url:"/plans/listpublic",method:"get",params:t})}function n(t){return Object(o["a"])({url:"/plans/list",method:"get",params:t})}function s(t){return Object(o["a"])({url:`/plans/${t.id}`,method:"delete"})}function r(t){return Object(o["a"])({url:"/plans/",method:"post",data:t})}function c(t){return Object(o["a"])({url:`/plans/${t.id}`,method:"put",data:t})}},"5c26":function(t,e,a){"use strict";a.d(e,"d",(function(){return i})),a.d(e,"e",(function(){return n})),a.d(e,"j",(function(){return s})),a.d(e,"g",(function(){return r})),a.d(e,"c",(function(){return c})),a.d(e,"f",(function(){return l})),a.d(e,"i",(function(){return d})),a.d(e,"a",(function(){return u})),a.d(e,"b",(function(){return m})),a.d(e,"h",(function(){return p}));var o=a("8982");function i(t){return Object(o["a"])({url:"/whatsapp/",method:"get"})}function n(){return Object(o["a"])({url:"/whatsapp/reiniciar",method:"post"})}function s(t){return Object(o["a"])({url:"/admin/channels",method:"get"})}function r(t){return Object(o["a"])({url:`/whatsappsession/${t}`,method:"post"})}function c(t){return Object(o["a"])({url:`/whatsappsession/${t}`,method:"delete"})}function l(t){return Object(o["a"])({url:`/whatsappsession/${t.id}`,method:"put",data:t})}function d(t,e){return Object(o["a"])({url:`/whatsapp/${t}`,method:"put",data:e})}function u(t){return Object(o["a"])({url:"/whatsapp",method:"post",data:t})}function m(t){return Object(o["a"])({url:`/whatsapp/${t}`,method:"delete"})}function p(t,e){return Object(o["a"])({url:`/whatsapp/updateOpenIA/${t}`,method:"put",data:e})}},"5f1d":function(t,e,a){"use strict";a.d(e,"d",(function(){return i})),a.d(e,"h",(function(){return n})),a.d(e,"c",(function(){return s})),a.d(e,"i",(function(){return r})),a.d(e,"b",(function(){return c})),a.d(e,"e",(function(){return l})),a.d(e,"a",(function(){return d})),a.d(e,"j",(function(){return u})),a.d(e,"f",(function(){return m})),a.d(e,"g",(function(){return p}));var o=a("8982");function i(t){return Object(o["a"])({url:"/campaigns/",method:"post",data:t})}function n(t){return Object(o["a"])({url:`/campaigns/start/${t}/`,method:"post",data:{campaignId:t}})}function s(t){return Object(o["a"])({url:`/campaigns/cancel/${t}/`,method:"post",data:{campaignId:t}})}function r(){return Object(o["a"])({url:"/campaigns/",method:"get"})}function c(t,e){return Object(o["a"])({url:`/campaigns/${e}`,method:"put",data:t})}function l(t){return Object(o["a"])({url:`/campaigns/${t.id}`,method:"delete"})}function d(t,e){return Object(o["a"])({url:`/campaigns/contacts/${e}/`,method:"post",data:t})}function u(t){return Object(o["a"])({url:`/campaigns/contacts/${t}/`,method:"get",params:{campaignId:t}})}function m(t,e){return Object(o["a"])({url:`/campaigns/contacts/${t}/${e}/`,method:"delete",params:{campaignId:t,contactId:e}})}function p(t){return Object(o["a"])({url:`/campaigns/deleteall/contacts/${t}/`,method:"delete",params:{campaignId:t}})}},6243:function(t,e,a){"use strict";a("c033")},"73ad":function(t,e,a){"use strict";a.d(e,"h",(function(){return i})),a.d(e,"i",(function(){return n})),a.d(e,"a",(function(){return s})),a.d(e,"g",(function(){return r})),a.d(e,"f",(function(){return c})),a.d(e,"j",(function(){return l})),a.d(e,"d",(function(){return d})),a.d(e,"b",(function(){return u})),a.d(e,"e",(function(){return m})),a.d(e,"c",(function(){return p}));var o=a("8982");function i(t){return Object(o["a"])({url:"/contacts/",method:"get",params:t})}function n(t){return Object(o["a"])({url:`/contacts/${t}`,method:"get"})}function s(t){return Object(o["a"])({url:"/contacts",method:"post",data:t})}function r(t){return Object(o["a"])({url:"/contacts/upload",method:"post",data:t,timeout:12e4})}function c(t){return Object(o["a"])({url:"/contacts/export",method:"post",data:t,timeout:12e4})}function l(t){return console.log(t),Object(o["a"])({url:"/contacts/sync",method:"post",data:{whatsappId:t}})}function d(t,e){return Object(o["a"])({url:`/contacts/${t}`,method:"put",data:e})}function u(t){return Object(o["a"])({url:`/contacts/${t}`,method:"delete"})}function m(t,e){const a={tags:e};return Object(o["a"])({url:`/contact-tags/${t}`,method:"put",data:a})}function p(t,e){const a={wallets:e};return Object(o["a"])({url:`/contact-wallet/${t}`,method:"put",data:a})}},7963:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return n}));var o=a("8982");function i(t){return Object(o["a"])({url:"/settings/",method:"get",params:t})}function n(t){return Object(o["a"])({url:`/settings/${t.Key}/`,method:"put",data:t})}},8039:function(t,e,a){"use strict";var o=function(){var t=this,e=t._self._c;return e("div",[e("q-item",[e("q-item-section",{attrs:{avatar:""}},["qrcode"==t.item.status?e("q-icon",{attrs:{color:"primary",name:"mdi-crop-free",size:"2.5em"}}):t._e(),"DISCONNECTED"==t.item.status?e("q-icon",{attrs:{color:"negative",size:"2.5em",name:"mdi-wifi-alert"}}):t._e(),"CONNECTED"==t.item.status?e("q-icon",{attrs:{name:"mdi-wifi-arrow-up-down",color:"green-8",size:"2.5em"}}):t._e(),["PAIRING","TIMEOUT"].includes(t.item.status)?e("q-icon",{attrs:{color:"negative",size:"2.5em",name:"mdi-wifi-strength-1-alert"}}):t._e(),"OPENING"==t.item.status?e("q-spinner",{attrs:{color:"green-7",size:"3em",thickness:2}}):t._e()],1),e("q-item-section",["qrcode"==t.item.status?e("q-item-label",[e("span",{staticClass:"text-weight-medium"},[t._v(" Esperando leitura do QR Code ")]),e("span",{staticClass:"row col"},[t._v(" Clique no botão 'QR CODE' e leia o QR Code com o seu celular para iniciar a sessão\n        ")])]):t._e(),"DISCONNECTED"==t.item.status?e("q-item-label",[e("span",{staticClass:"text-weight-medium"},[t._v(" Falha ao iniciar comunicação para este canal. ")]),"whatsapp"===t.item.type?e("span",{staticClass:"row col"},[t._v(" Certifique-se de que seu celular esteja conectado à internet e tente\n          novamente, ou solicite um novo QR Code ")]):t._e(),"telegram"===t.item.type?e("span",{staticClass:"row col"},[t._v(" Tente conectar novamente. Caso o erro permaneça, confirme se o token está\n          correto.")]):t._e(),"instagram"===t.item.type?e("span",{staticClass:"row col"},[t._v(" Tente conectar novamente. Caso o erro permaneça, confirme se as\n          credenciais estão corretas.")]):t._e()]):t._e(),"CONNECTED"==t.item.status?e("q-item-label",[e("span",{staticClass:"text-weight-medium"},[t._v(" Conexão estabelecida! ")])]):t._e(),["PAIRING","TIMEOUT"].includes(t.item.status)?e("q-item-label",[e("span",{staticClass:"text-weight-medium"},[t._v(" A conexão com o celular foi perdida ")]),e("span",{staticClass:"row col"},[t._v(" Certifique-se de que seu celular esteja conectado à internet e o WhatsApp esteja\n          aberto, ou clique no botão 'Desconectar' para obter um novo QR Code ")])]):t._e(),"OPENING"==t.item.status?e("q-item-label",[e("span",{staticClass:"text-weight-medium"},[t._v(" Estabelecendo conexão. ")]),e("span",{staticClass:"row col"},[t._v(" Isso poderá demorar um pouco... ")])]):t._e(),e("q-item-label",{attrs:{caption:""}},[t._v("\n        Última Atualização: "+t._s(t.formatarData(t.item.updatedAt,"dd/MM/yyyy HH:mm"))+"\n      ")])],1)],1)],1)},i=[],n=a("b166"),s=a("e3ee"),r=a("d9d6"),c=a.n(r),l={name:"ItemStatusChannel",props:{item:{type:Object,default:()=>{}}},methods:{formatarData(t,e){return Object(n["a"])(Object(s["a"])(t),e,{locale:c.a})}}},d=l,u=a("2877"),m=a("66e5"),p=a("4074"),h=a("0016"),g=a("0d59"),f=a("0170"),b=a("eebe"),v=a.n(b),y=Object(u["a"])(d,o,i,!1,null,null,null);e["a"]=y.exports;v()(y,"components",{QItem:m["a"],QItemSection:p["a"],QIcon:h["a"],QSpinner:g["a"],QItemLabel:f["a"]})},"824a":function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"d",(function(){return s})),a.d(e,"b",(function(){return r}));var o=a("8982");function i(t){return Object(o["a"])({url:"/chat-flow",method:"post",data:t})}function n(t){return Object(o["a"])({url:"/chat-flow",method:"get",params:t})}function s(t){return Object(o["a"])({url:`/chat-flow/${t.id}`,method:"put",data:t})}function r(t){return Object(o["a"])({url:`/chat-flow/${t.id}`,method:"delete"})}},a005:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"d",(function(){return n})),a.d(e,"a",(function(){return s})),a.d(e,"c",(function(){return r}));var o=a("8982");function i(t){return Object(o["a"])({url:"/queueIntegration/",method:"post",data:t})}function n(){return Object(o["a"])({url:"/queueIntegration/",method:"get"})}function s(t){return Object(o["a"])({url:`/queueIntegration/${t.id}`,method:"put",data:t})}function r(t){return Object(o["a"])({url:`/queueIntegration/${t.id}`,method:"delete"})}},a0b3:function(t,e,a){"use strict";a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return n})),a.d(e,"d",(function(){return s})),a.d(e,"b",(function(){return r}));var o=a("8982");function i(t){return Object(o["a"])({url:"/settingsgeneral/",method:"get",params:t})}function n(t){return Object(o["a"])({url:`/settingsgeneral/${t.Key}/`,method:"put",data:t})}function s(t){const e=new FormData;return e.append("file",t),Object(o["a"])({url:"/settings/privateFile",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})}function r(t){return Object(o["a"])({url:`/public-settings/${t}`,method:"get"})}},a29e:function(t,e,a){},a700:function(t,e,a){"use strict";a("14d9");var o=a("b166"),i=a("3d09"),n=a("e3ee"),s=a("e018"),r=a("2f62");e["a"]={computed:{...Object(r["b"])(["mensagensTicket","ticketFocado","hasMore"])},data(){return{loading:!1}},methods:{scrollToBottom(){setTimeout((()=>{this.$root.$emit("scrollToBottomMessageChat")}),200)},dataInWords(t){return Object(o["a"])(Object(i["a"])(t),"HH:mm",{locale:s["a"]})},formatarMensagemWhatsapp(t){if(!t)return;let e=t;function a(t){const e=t.charCodeAt();return e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57}function o(t,o,i,n){const s=[];for(let e=0;e<t.length;e++)t[e]===o?s.length%2?" "===t[e-1]||"undefined"!==typeof t[e+1]&&a(t[e+1])||s.push(e):"undefined"===typeof t[e+1]||" "===t[e+1]||"undefined"!==typeof t[e-1]&&a(t[e-1])||s.push(e):10===t[e].charCodeAt()&&s.length%2&&s.pop();s.length%2&&s.pop();let r=0;return s.forEach(((t,a)=>{const o=a%2?n:i;e=e.slice(0,t+r)+o+e.slice(t+r+1),r+=o.length-1})),e}return e=o(e,"_","<i>","</i>"),e=o(e,"*","<b>","</b>"),e=o(e,"~","<s>","</s>"),e=e.replace(/\n/g,"<br>"),e},formatarBotaoWhatsapp(t){if(!t)return;let e=t;function a(t){const e=t.charCodeAt();return e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57}const o=(t,o,i,n)=>{const s=[];try{for(let e=0;e<t.length;e++)t[e]===o?s.length%2?" "===t[e-1]||"undefined"!==typeof t[e+1]&&a(t[e+1])||s.push(e):"undefined"===typeof t[e+1]||" "===t[e+1]||"undefined"!==typeof t[e-1]&&a(t[e-1])||s.push(e):10===t[e].charCodeAt()&&s.length%2&&s.pop();s.length%2&&s.pop();let r=0;s.forEach(((t,a)=>{const o=a%2?n:i;e=e.slice(0,t+r)+o+e.slice(t+r+1),r+=o.length-1}))}catch(r){console.error("Erro ao aplicar estilos do WhatsApp:",r)}return e};try{const a=t.trim().split("\n"),i=a.shift()+"\n",n=a.filter((t=>""!==t.trim())).map((t=>`<button style="display: inline-block; margin: 5px; padding: 10px; background-color: #0084ff; color: white; border: none; border-radius: 5px;" title="Esse botão só é clicável no celular">➡️ ${t.trim()}</button>`));return e=[i,...n].join("\n"),e=o(e,"_","<i>","</i>"),e=o(e,"*","<b>","</b>"),e=o(e,"~","<s>","</s>"),e=e.replace(/\n/g,"<br>"),e}catch(i){return console.error("Erro ao formatar botão do WhatsApp:",i),t}},formatarData(t,e="dd/MM/yyyy"){return Object(o["a"])(Object(n["a"])(t),e,{locale:s["a"]})}}}},ab52:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"h",(function(){return n})),a.d(e,"i",(function(){return s})),a.d(e,"j",(function(){return r})),a.d(e,"b",(function(){return c})),a.d(e,"c",(function(){return l})),a.d(e,"e",(function(){return d})),a.d(e,"d",(function(){return u})),a.d(e,"f",(function(){return m})),a.d(e,"g",(function(){return p}));var o=a("8982");function i(t){return Object(o["a"])({url:"/dash-tickets-queues",method:"get",params:t})}function n(t){return Object(o["a"])({url:"/contacts-report",method:"get",params:t})}function s(t){return Object(o["a"])({url:"/statistics-per-users",method:"get",params:t})}function r(t){return Object(o["a"])({url:"/status",method:"get",params:t})}function c(t){return Object(o["a"])({url:"/statistics-tickets-times",method:"get",params:t})}function l(t){return Object(o["a"])({url:"/statistics-tickets-channels",method:"get",params:t})}function d(t){return Object(o["a"])({url:"/statistics-tickets-evolution-channels",method:"get",params:t})}function u(t){return Object(o["a"])({url:"/statistics-tickets-evolution-by-period",method:"get",params:t})}function m(t){return Object(o["a"])({url:"/statistics-tickets-per-users-detail",method:"get",params:t})}function p(t){return Object(o["a"])({url:"/statistics-tickets-queue",method:"get",params:t})}},b09f:function(t,e,a){"use strict";var o=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:`pagePrint-${t.id}`}},[e("body",{attrs:{id:"pageInit"}},[e("div",{staticClass:"marginsPage"},[e("div",{staticClass:"page-header"},[e("div",{staticClass:"row"},[e("div",{staticClass:"column left"},[e("div",{staticClass:"container-header"},[e("div",{staticClass:"row text-center",staticStyle:{"font-weight":"bold","font-size":"18px"},style:{marginTop:t.subTitle?"-10px":"0px"}},[t._v("\n                "+t._s(t.title)+"\n              ")]),t.subTitle?e("div",{staticClass:"row text-center",staticStyle:{"font-weight":"bold","font-size":"12px"}},[t._v("\n                "+t._s(t.subTitle)+"\n              ")]):t._e(),e("hr",{staticClass:"row",staticStyle:{"margin-top":"10px","margin-left":"-10px",width:"85%"}})])]),e("div",{staticClass:"column right column-rigth-header"},[e("div",{staticStyle:{background:"black","margin-top":"-4px"}},[e("img",{staticClass:"logo",staticStyle:{"max-width":"100%"},attrs:{src:t.generateMediaUrl(),alt:"logo"}}),e("div",{staticClass:"row text-center h3"},[t._v(" ")])])])])]),t._m(0),e("table",[t._m(1),e("tbody",{attrs:{id:"tableReport"}},[t._t("body")],2),t._m(2),e("div",{attrs:{id:"footerAppendFiltros"}})])])])])},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"page-footer"},[e("div",{staticStyle:{"text-align":"center"}})])},function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("td",[e("div",{staticClass:"page-header-space"})])])])},function(){var t=this,e=t._self._c;return e("tfoot",[e("tr",[e("td",[e("div",{staticClass:"page-footer-space"})])])])}],n=a("3748"),s=a("b166");const r="\n  .marginsPage {\n    margin-left: 1cm !important;\n    margin-right: 1cm !important;\n  }\n  .page-header {\n    height: 120px !important;\n    // margin-left: 0.5cm !important;\n  }\n  .page-header-space {\n    height: 90px !important;\n    // margin-left: 0.5cm !important;\n  }\n  .page-header {\n    position: fixed !important;\n    top: 0px !important;\n    width: calc(100% - 0cm) !important;\n  }\n  .container-header {\n    padding-top: 30px;\n  }\n  .column-rigth-header {\n    position: fixed;\n    width: 250px;\n    height: 80px;\n    top: 0px;\n    padding-top: 10px;\n    right: 0px;\n  }\n  header {\n    display: none;\n    position: fixed;\n    top: 0;\n  }\n  \n  .page-footer,\n  .page-footer-space {\n    height: 0px !important;\n  }\n\n  .page-footer {\n    position: fixed !important;\n    bottom: 0 !important;\n    width: calc(100% - 2cm) !important;\n  }\n\n  .page {\n    page-break-after: always !important;\n  }\n  .h1 {\n    font-size: 25px;\n  }\n  .h2 {\n    font-size: 20px;\n  }\n  .h3 {\n    font-size: 12px;\n  }\n  .h4 {\n    font-size: 9px;\n  }\n  \n  .p {\n    margin-top: 5px;\n    margin-top: 5px;\n    line-height: 50px;\n  }\n  \n  .row {\n    left: 0;\n    right: 0;\n    position: relative;\n  }\n  div.right {\n    width: 15%;\n  }\n  .text-left {\n    text-align: left;\n  }\n  .text-right {\n    text-align: right;\n  }\n  .text-center {\n    text-align: center;\n  }\n  @media print {\n    .customWrap {\n      word-wrap: normal !important;\n      white-space: normal !important;\n      overflow-wrap: break-word;\n      overflow-wrap: break-word;\n      word-wrap: break-word;\n      -ms-word-break: break-all;\n      /* This is the dangerous one in WebKit, as it breaks things wherever */\n      word-break: break-all;\n      /* Instead use this non-standard one: */\n      word-break: break-word;\n    }\n\n    #BrowserPrintDefaults {\n      display: none;\n    }\n    @page {\n      size: A4 landscape;\n      margin: 0px;\n      margin-bottom: 35px;\n      left: 0px;\n      right: 0px;\n      top: 0px;\n    }\n   \n    img.logo {\n      width: 110px;\n      height: 80px;\n      object-fit: fill;\n    }\n\n    body {\n      top: 0px !important;\n      margin: 0px !important;\n      left: 0px;\n      width: 297mm;\n      // retirar 35px do footer\n      height: calc(209mm - 35px); \n    }\n    thead {\n      display: table-header-group !important;\n    }\n    tfoot {\n      display: table-footer-group !important;\n    }\n    button {\n      display: none;\n    }\n    footer {\n      display: none;\n      position: fixed;\n      bottom: 0;\n    }\n  }\n";var c={name:"ccPrintModel",props:{imprimirRelatorio:{type:Boolean,required:!0},styleP:{type:String,default:'<p style="line-height: 0.1cm; word-wrap: normal !important; white-space: normal !important;">'},id:[String,Number],title:String,subTitle:{type:String,default:""}},data(){return{abrirModal:!1,dataImpressao:Object(s["a"])(new Date,"dd/MM/yyyy HH:mm:ss")}},computed:{conteudoTexto(){const t=this.corpo;return t}},watch:{imprimirRelatorio(t){this.print()}},beforeMount(){this.$nextTick((function(){window.addEventListener("afterprint",this.fecharModal)}))},beforeDestroy(){window.removeEventListener("afterprint",this.fecharModal),this.$emit("update:imprimirRelatorio",!1)},methods:{generateMediaUrl(){return"http://localhost:3100/public/logos/login.png"},print(){this.d=new n["Printd"];const{contentWindow:t}=this.d.getIFrame(),e=`#pagePrint-${this.id}`;this.d.print(document.querySelector(e),[r,this.styleP])},printNomal(){setTimeout((()=>{window.print()}),300)},fecharModal(){this.abrirModal=!1,this.$emit("update:imprimirRelatorio",!1)}}},l=c,d=(a("3655"),a("2877")),u=Object(d["a"])(l,o,i,!1,null,"a5465856",null);e["a"]=u.exports},c033:function(t,e,a){},c3f3:function(t,e,a){"use strict";a.d(e,"d",(function(){return i})),a.d(e,"a",(function(){return n})),a.d(e,"e",(function(){return s})),a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return c}));var o=a("8982");function i(t,e){return Object(o["a"])({url:`/chat-interno/mensagens/${t}?isGroup=${e}`,method:"get"})}function n(t){return Object(o["a"])({url:"/chat-interno/mensagens",method:"post",data:t})}function s(t,e){return Object(o["a"])({url:`/chat-interno/mensagens/${t}`,method:"put",data:{isGroup:e}})}function r(){return Object(o["a"])({url:"/chat-interno/count/mensagens",method:"get"})}function c(t){return Object(o["a"])({url:`/users/groups/${t}`,method:"get"})}},c9d9:function(t,e,a){"use strict";a.d(e,"a",(function(){return o})),a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n}));const o={11:"SP",12:"SP",13:"SP",14:"SP",15:"SP",16:"SP",17:"SP",18:"SP",19:"SP",21:"RJ",22:"RJ",24:"RJ",27:"ES",28:"ES",31:"MG",32:"MG",33:"MG",34:"MG",35:"MG",37:"MG",38:"MG",41:"PR",42:"PR",43:"PR",44:"PR",45:"PR",46:"PR",47:"SC",48:"SC",49:"SC",51:"RS",53:"RS",54:"RS",55:"RS",61:"DF",62:"GO",63:"TO",64:"GO",65:"MT",66:"MT",67:"MS",68:"AC",69:"RO",71:"BA",73:"BA",74:"BA",75:"BA",77:"BA",79:"SE",81:"PE",82:"AL",83:"PB",84:"RN",85:"CE",86:"PI",87:"PE",88:"CE",89:"PI",91:"PA",92:"AM",93:"PA",94:"PA",95:"RR",96:"AP",97:"AM",98:"MA",99:"MA"},i=[{nome:"Acre",sigla:"AC"},{nome:"Alagoas",sigla:"AL"},{nome:"Amapá",sigla:"AP"},{nome:"Amazonas",sigla:"AM"},{nome:"Bahia",sigla:"BA"},{nome:"Ceará",sigla:"CE"},{nome:"Distrito Federal",sigla:"DF"},{nome:"Espírito Santo",sigla:"ES"},{nome:"Goiás",sigla:"GO"},{nome:"Maranhão",sigla:"MA"},{nome:"Mato Grosso",sigla:"MT"},{nome:"Mato Grosso do Sul",sigla:"MS"},{nome:"Minas Gerais",sigla:"MG"},{nome:"Pará",sigla:"PA"},{nome:"Paraíba",sigla:"PB"},{nome:"Paraná",sigla:"PR"},{nome:"Pernambuco",sigla:"PE"},{nome:"Piauí",sigla:"PI"},{nome:"Rio de Janeiro",sigla:"RJ"},{nome:"Rio Grande do Norte",sigla:"RN"},{nome:"Rio Grande do Sul",sigla:"RS"},{nome:"Rondônia",sigla:"RO"},{nome:"Roraima",sigla:"RR"},{nome:"Santa Catarina",sigla:"SC"},{nome:"São Paulo",sigla:"SP"},{nome:"Sergipe",sigla:"SE"},{nome:"Tocantins",sigla:"TO"}],n={access:{message:"Acessou o ticket",color:"grey-8",icon:"mdi-eye"},closed:{message:"Resolveu o ticket",color:"positive",icon:"mdi-check-circle-outline"},create:{message:"Ticket criado",color:"green-6",icon:"mdi-plus-circle"},delete:{message:"Deletou o Ticket",color:"negative",icon:"mdi-delete"},open:{message:"Iniciou o atendimento",color:"primary",icon:"mdi-play-circle-outline"},pending:{message:"Retornou atendimento para fila de pendentes",color:"amber",icon:"mdi-account-convert"},transfered:{message:"Transferiu o atendimento",color:"teal-3",icon:"mdi-account-arrow-right"},receivedTransfer:{message:"Recebeu o atendimento por transferência",color:"teal-5",icon:"mdi-account-arrow-left"},queue:{message:"Bot: Fila definida",color:"green-2",icon:"mdi-arrow-decision"},userDefine:{message:"Bot: Usuário definido",color:"cyan-2",icon:"mdi-account-check"},retriesLimitQueue:{message:"Bot: Fila definida (Limite de tentativas)",color:"green-2",icon:"mdi-arrow-decision"},retriesLimitUserDefine:{message:"Bot: Usuário definido (Limite de tentativas)",color:"cyan-2",icon:"mdi-account-check"},chatBot:{message:"ChatBot iniciado",color:"blue-4",icon:"mdi-robot"},autoClose:{message:"Bot: Atendimento fechado automaticamente",color:"blue-8",icon:"mdi-check-circle-outline"}}},cd36:function(t,e,a){t.exports=a.p+"img/wa-background-dark.06e19a7c.jpg"},cd82:function(t,e,a){t.exports=a.p+"img/wa-background.bea8586b.png"},d73a:function(t,e,a){},e517:function(t,e,a){},ec02:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"d",(function(){return n})),a.d(e,"a",(function(){return s})),a.d(e,"c",(function(){return r}));var o=a("8982");function i(t){return Object(o["a"])({url:`/helps/${t}`,method:"delete"})}function n(t,e){return Object(o["a"])({url:`/helps/${t}`,method:"put",data:e})}function s(t){return Object(o["a"])({url:"/helps",method:"post",data:t})}function r(t){return Object(o["a"])({url:"/helps/list/",method:"get",params:t})}},ee0e:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"d",(function(){return n})),a.d(e,"a",(function(){return s})),a.d(e,"c",(function(){return r}));var o=a("8982");function i(t){return Object(o["a"])({url:"/queue/",method:"post",data:t})}function n(){return Object(o["a"])({url:"/queue/",method:"get"})}function s(t){return Object(o["a"])({url:`/queue/${t.id}`,method:"put",data:t})}function r(t){return Object(o["a"])({url:`/queue/${t.id}`,method:"delete"})}},ef42:function(t,e,a){"use strict";var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"q-pa-md"},[e("transition-group",{attrs:{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[t._l(t.mensagens,(function(a,o){return[t.isLineDate?e("hr",{directives:[{name:"show",rawName:"v-show",value:0===o||t.formatarData(a.createdAt)!==t.formatarData(t.mensagens[o-1].createdAt),expression:"index === 0 || formatarData(mensagem.createdAt) !== formatarData(mensagens[index - 1].createdAt)"}],key:"hr-"+o,staticClass:"hr-text q-mt-lg q-mb-md",attrs:{"data-content":t.formatarData(a.createdAt)}}):t._e(),t.mensagens.length&&o===t.mensagens.length-1?[e("div",{key:`ref-${a.createdAt}`,ref:"lastMessageRef",refInFor:!0,staticStyle:{float:"'left', background: 'black', clear: 'both'"},attrs:{id:"lastMessageRef"}})]:t._e(),e("div",{key:`chat-message-${a.id}`,attrs:{id:`chat-message-${a.id}`}}),e("q-chat-message",{key:a.id,staticClass:"text-weight-medium",class:{pulseIdentications:t.identificarMensagem==`chat-message-${a.id}`},attrs:{stamp:t.dataInWords(a.createdAt),sent:a.fromMe,"bg-color":a.fromMe?t.$q.dark.isActive?"green-2":"green-1":t.$q.dark.isActive?"blue-2":"blue-1"}},[e("div",{staticStyle:{"min-width":"100px","max-width":"350px"},style:a.isDeleted?"color: rgba(0, 0, 0, 0.36) !important;":""},[t.ativarMultiEncaminhamento?e("q-checkbox",{key:`cheked-chat-message-${a.id}`,ref:`box-chat-message-${a.id}`,refInFor:!0,class:{"absolute-top-right checkbox-encaminhar-right":!a.fromMe,"absolute-top-left checkbox-encaminhar-left":a.fromMe},attrs:{value:!1},nativeOn:{click:function(e){return t.verificarEncaminharMensagem(a)}}}):t._e(),a.scheduleDate?e("q-icon",{staticClass:"q-ma-xs",class:{"text-primary":a.scheduleDate&&"pending"===a.status,"text-positive":!["pending","canceled"].includes(a.status)},attrs:{name:"mdi-calendar",size:"18px"}},[e("q-tooltip",{attrs:{"content-class":"bg-secondary text-grey-8"}},[e("div",{staticClass:"row col"},[t._v("\n                  Mensagem agendada\n                ")]),a.isDeleted?e("div",{staticClass:"row col"},[e("q-chip",{attrs:{color:"red-3",icon:"mdi-trash-can-outline"}},[t._v("\n                    Envio cancelado: "+t._s(t.formatarData(a.updatedAt,"dd/MM/yyyy"))+"\n                  ")])],1):t._e(),e("div",{staticClass:"row col"},[e("q-chip",{attrs:{color:"blue-1",icon:"mdi-calendar-import"}},[t._v("\n                    Criado em: "+t._s(t.formatarData(a.createdAt,"dd/MM/yyyy HH:mm"))+"\n                  ")])],1),e("div",{staticClass:"row col"},[e("q-chip",{attrs:{color:"blue-1",icon:"mdi-calendar-start"}},[t._v("\n                    Programado para: "+t._s(t.formatarData(a.scheduleDate,"dd/MM/yyyy HH:mm"))+"\n                  ")])],1)])],1):t._e(),a.edited?e("div",{staticClass:"text-italic"},[t._v("\n            Editada: "+t._s(a.edited)+"\n            ")]):t._e(),a.edited?e("div",{staticClass:"text-italic"},[t._v("\n             Mensagem anterior:"),e("br")]):t._e(),a.isDeleted?e("div",{staticClass:"text-italic"},[t._v("\n              Mensagem apagada em "+t._s(t.formatarData(a.updatedAt,"dd/MM/yyyy"))+".\n            ")]):t._e(),t.isGroupLabel(a)?e("div",{staticClass:"q-mb-sm",staticStyle:{display:"flex",color:"rgb(59 23 251)",fontWeight:"500"}},[t._v("\n              "+t._s(t.isGroupLabel(a))+"\n            ")]):t._e(),a.quotedMsg?e("div",{class:{textContentItem:!a.isDeleted,textContentItemDeleted:a.isDeleted}},[e("MensagemRespondida",{staticClass:"row justify-center",staticStyle:{"max-width":"240px","max-height":"150px"},attrs:{mensagem:a.quotedMsg},on:{"mensagem-respondida:focar-mensagem":function(e){t.f,t.carMensagem}}})],1):t._e(),!a.isDeleted&&t.isShowOptions?e("q-btn",{staticClass:"absolute-top-right mostar-btn-opcoes-chat",attrs:{dense:"",flat:"",ripple:"",round:"",icon:"mdi-chevron-down"}},[e("q-menu",{attrs:{square:"","auto-close":"",anchor:"bottom left",self:"top left"}},[e("q-list",{staticStyle:{"min-width":"100px"}},[e("q-item",{attrs:{disable:!["whatsapp","telegram"].includes(t.ticketFocado.channel),clickable:""},on:{click:function(e){return t.citarMensagem(a)}}},[e("q-item-section",[t._v("Responder")]),["whatsapp","telegram"].includes(t.ticketFocado.channel)?t._e():e("q-tooltip",[t._v("\n                      Disponível apenas para WhatsApp e Telegram\n                    ")])],1),e("q-item",{attrs:{clickable:"",disable:!["whatsapp"].includes(t.ticketFocado.channel)},on:{click:function(e){return t.encaminharMensagem(a)}}},[e("q-item-section",[t._v("Encaminhar")]),["whatsapp","telegram"].includes(t.ticketFocado.channel)?t._e():e("q-tooltip",[t._v("\n                      Disponível apenas para WhatsApp\n                    ")])],1),e("q-item",{attrs:{clickable:"",disable:!["whatsapp"].includes(t.ticketFocado.channel)},on:{click:function(e){return t.marcarMensagensParaEncaminhar(a)}}},[e("q-item-section",[t._v("Marcar (encaminhar várias)")]),["whatsapp"].includes(t.ticketFocado.channel)?t._e():e("q-tooltip",[t._v("\n                      Disponível apenas para WhatsApp\n                    ")])],1),"whatsapp"===t.ticketFocado.channel?e("q-item",{attrs:{disable:!["whatsapp"].includes(t.ticketFocado.channel),clickable:""},on:{click:function(e){t.mensagemReacao=a,t.modalEmojiOpen=!0}}},[e("q-item-section",[t._v("Reagir")])],1):t._e(),a.fromMe&&"chat"===a.mediaType?e("q-item",{attrs:{clickable:"",disable:!["whatsapp"].includes(t.ticketFocado.channel)},on:{click:function(e){return t.AbrirmodaleditarMensagem(a)}}},[e("q-item-section",[e("q-item-label",[t._v("Editar Mensagem")])],1),["whatsapp"].includes(t.ticketFocado.channel)?t._e():e("q-tooltip",[t._v("\n                      Disponível apenas para WhatsApp\n                    ")])],1):t._e(),e("q-separator"),a.fromMe?e("q-item",{attrs:{clickable:"",disable:!["whatsapp"].includes(t.ticketFocado.channel)},on:{click:function(e){return t.deletarMensagem(a)}}},[e("q-item-section",[e("q-item-label",[t._v("Deletar")])],1),["whatsapp"].includes(t.ticketFocado.channel)?t._e():e("q-tooltip",[t._v("\n                      Disponível apenas para WhatsApp\n                    ")])],1):t._e()],1)],1)],1):t._e(),a.fromMe?e("q-icon",{staticClass:"absolute-bottom-right q-pr-xs q-pb-xs",attrs:{name:t.ackIcons[a.ack],size:"1.2em",color:a.ack>=3?"blue-12":""}}):t._e(),"audio"===a.mediaType?[e("div",{staticStyle:{width:"330px",heigth:"300px"}},[e("audio",{ref:"audioMessage",refInFor:!0,staticClass:"q-mt-md full-width",attrs:{controls:"",controlsList:"download playbackrate volume"}},[e("source",{attrs:{src:a.mediaUrl,type:"audio/mp3"}})])])]:t._e(),"contactMessage"===a.mediaType?[e("div",{staticStyle:{"min-width":"250px"}},[e("ContatoCard",{attrs:{mensagem:a},on:{openContactModal:t.openContactModal}}),e("ContatoModal",{attrs:{value:t.modalContato,contact:t.currentContact},on:{close:t.closeModal,saveContact:t.saveContact}})],1)]:t._e(),"locationMessage"===a.mediaType?[e("q-img",{staticClass:"q-mt-md",staticStyle:{cursor:"pointer"},attrs:{src:t.getMapThumbnail(a.body),"spinner-color":"primary",height:"150px",width:"330px"},on:{click:function(e){return t.openGoogleMaps(a.body)}}})]:t._e(),"liveLocationMessage"===a.mediaType?[e("q-img",{staticClass:"q-mt-md",staticStyle:{cursor:"pointer"},attrs:{src:t.getMapThumbnail(a.body),"spinner-color":"primary",height:"150px",width:"330px"},on:{click:function(e){return t.openGoogleMaps(a.body)}}}),e("div",{staticStyle:{color:"red"}},[t._v("*Ainda não é possível exibir a localização em tempo real neste dispositivo. Abra o WhatsApp no seu celular para ver corretamente.")])]:t._e(),"interactiveMessage"===a.mediaType?[e("div",{staticStyle:{color:"red"}},[t._v("*Não é possível exibir essa mensagem neste dispositivo. Abra o WhatsApp no seu celular para ver a mensagem.")])]:t._e(),"pollCreationMessageV3"===a.mediaType?[e("div",{staticStyle:{color:"red"}},[t._v("*Não é possível exibir essa mensagem neste dispositivo. Abra o WhatsApp no seu celular para ver a mensagem.")])]:t._e(),"productMessage"===a.mediaType?[e("div",{staticStyle:{color:"red"}},[t._v("*Não é possível exibir essa mensagem neste dispositivo. Abra o WhatsApp no seu celular para ver a mensagem.")])]:t._e(),"image"===a.mediaType?[e("div",{staticStyle:{position:"relative",width:"100%","max-width":"200px",overflow:"hidden"}},[e("img",{staticClass:"q-mt-md",staticStyle:{width:"100%",height:"auto","object-fit":"contain",cursor:"pointer",display:"block"},attrs:{src:a.mediaUrl},on:{click:function(e){t.urlMedia=a.mediaUrl,t.abrirModalImagem=!0}}})]),e("VueEasyLightbox",{attrs:{moveDisabled:"",visible:t.abrirModalImagem,imgs:t.urlMedia,index:a.ticketId||1},on:{hide:function(e){t.abrirModalImagem=!1}}})]:t._e(),"video"===a.mediaType?[e("div",{staticStyle:{position:"relative",width:"100%","max-width":"330px",height:"auto"}},[e("video",{ref:"videoElement",refInFor:!0,staticStyle:{width:"100%",height:"auto","object-fit":"contain","border-radius":"8px","max-height":"400px"},attrs:{src:a.mediaUrl,controls:""}})])]:t._e(),"buttonsMessage"===a.mediaType?[e("div",{staticStyle:{"margin-top":"20px"},domProps:{innerHTML:t._s(t.formatarBotaoWhatsapp(a.body))}})]:t._e(),"listMessage"===a.mediaType?[e("div",{staticStyle:{"margin-top":"20px"},domProps:{innerHTML:t._s(t.formatarBotaoWhatsapp(a.body))}})]:t._e(),!["audio","vcard","image","video"].includes(a.mediaType)&&a.mediaUrl?[e("div",{staticClass:"text-center full-width hide-scrollbar no-scroll"},[t.isPDF(a.mediaUrl)?e("iframe",{staticClass:"no-scroll hide-scrollbar",staticStyle:{width:"330px",height:"150px","overflow-y":"hidden","-ms-overflow-y":"hidden"},attrs:{frameBorder:"0",scrolling:"no",src:a.mediaUrl,id:"frame-pdf"}},[t._v("\n                  Faça download do PDF\n                  ")]):t._e(),e("q-btn",{staticClass:"q-mt-sm text-center text-black btn-rounded text-grey-9 ellipsis",attrs:{type:"a",color:t.$q.dark.isActive?"":"grey-3","no-wrap":"","no-caps":"",stack:"",dense:"",download:"",target:t.isPDF(a.mediaUrl)?"_blank":"",href:a.mediaUrl}},[a.mediaUrl?e("q-tooltip",{attrs:{"content-class":"text-bold"}},[t._v("\n                    Baixar: "+t._s(a.mediaName)+"\n                    "+t._s(a.body)+"\n                  ")]):t._e(),e("div",{staticClass:"row items-center q-ma-xs"},[e("div",{staticClass:"ellipsis col-grow q-pr-sm",staticStyle:{"max-width":"290px"}},[t._v("\n                      "+t._s(t.formatarMensagemWhatsapp(a.body||a.mediaName))+"\n                    ")]),e("q-icon",{attrs:{name:"mdi-download"}})],1)],1)],1)]:t._e(),["listMessage","buttonsMessage","productMessage","contactMessage","application","locationMessage","liveLocationMessage","interactiveMessage","pollCreationMessageV3"].includes(a.mediaType)?t._e():e("div",{directives:[{name:"linkified",rawName:"v-linkified"}],staticClass:"q-message-container row items-end no-wrap",class:{"q-mt-sm":"chat"!==a.mediaType}},[e("div",{domProps:{innerHTML:t._s(t.formatarMensagemWhatsapp(a.body))}})])],2)])]}))],2),e("q-dialog",{model:{value:t.modalEmojiOpen,callback:function(e){t.modalEmojiOpen=e},expression:"modalEmojiOpen"}},[e("q-card",[e("q-card-section",{staticClass:"row q-gutter-sm"},[t._l(t.principaisEmojis,(function(a){return e("q-btn",{key:a,attrs:{flat:""},on:{click:function(e){return t.selectEmoji(a,t.mensagemReacao)}}},[t._v("\n        "+t._s(a)+"\n      ")])})),e("q-btn",{staticClass:"q-ml-sm",attrs:{flat:"",round:"",icon:"add",size:"sm"},on:{click:function(e){t.expandirEmojis=!t.expandirEmojis}}}),t.expandirEmojis?e("div",[e("VEmojiPicker",{staticStyle:{width:"40vw"},attrs:{showSearch:!1,emojisByRow:t.calculateEmojisByRow(),labelSearch:"Localizar...",lang:"pt-BR"},on:{select:t.onInsertSelectEmoji}})],1):t._e()],2)],1)],1),e("q-dialog",{model:{value:t.showModaledit,callback:function(e){t.showModaledit=e},expression:"showModaledit"}},[e("q-card",{staticClass:"q-pa-lg modal-container container-rounded-10"},[e("q-card-section",[e("div",{staticClass:"text-h6"},[t._v("Editar Mensagem")])]),e("q-card-section",[e("q-input",{attrs:{filled:"",label:"Mensagem"},model:{value:t.mensagemAtual.body,callback:function(e){t.$set(t.mensagemAtual,"body",e)},expression:"mensagemAtual.body"}})],1),e("q-card-actions",{attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Cancelar",color:"negative"}}),e("q-btn",{attrs:{label:"Salvar",color:"primary"},on:{click:t.salvarMensagem}})],1)],1)],1)],1)},i=[],n=(a("14d9"),a("88a7"),a("271a"),a("5494"),a("a700")),s=a("cee4"),r=a("825ae"),c=function(){var t=this,e=t._self._c;return e("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"q-pa-none fit btn-rounded q-mt-md q-mb-sm row justify-center",attrs:{clickable:"",dense:""}},[e("q-chat-message",{key:t.mensagem.id,staticClass:"text-weight-medium fit q-ma-none",staticStyle:{"min-width":"100px","max-width":"350px"},attrs:{sent:t.mensagem.fromMe,id:"chat-message-resp","bg-color":t.mensagem.fromMe?"grey-2":t.$q.dark.isActive?"blue-2":"blue-1"}},[e("div",{staticClass:"full-width",style:t.mensagem.isDeleted?"color: rgba(0, 0, 0, 0.36) !important;":""},[t.mensagem.isDeleted?e("div",{staticClass:"text-italic"},[t._v(" Mensagem apagada em "+t._s(t.formatarData(t.mensagem.updatedAt,"dd/MM/yyyy"))+".")]):t._e(),t.isGroupLabel(t.mensagem)?e("div",{staticClass:"q-mb-sm",staticStyle:{display:"flex",color:"rgb(59 23 251)",fontWeight:"500"}},[t._v("\n        "+t._s(t.isGroupLabel(t.mensagem))+"\n      ")]):t._e(),t.isGroupLabel(t.mensagem)||t.mensagem.fromMe?t._e():e("div",{staticClass:"q-mb-sm",staticStyle:{display:"flex",color:"rgb(59 23 251)",fontWeight:"500"}},[t._v("\n        "+t._s(t.mensagem.contact&&t.mensagem.contact.name)+"\n      ")]),"audio"===t.mensagem.mediaType?[e("div",{staticStyle:{width:"200px",heigth:"300px"}},[e("audio",{staticClass:"full-width",staticStyle:{"max-width":"200px"},attrs:{controls:""}},[e("source",{attrs:{src:t.mensagem.mediaUrl,type:"audio/ogg"}})])])]:t._e(),"vcard"===t.mensagem.mediaType?[e("q-btn",{staticClass:"q-px-sm text-center",attrs:{type:"a",color:"black",outline:"",dense:"",download:"vCard",href:`data:text/x-vcard;charset=utf-8;base64,${t.returnCardContato(t.mensagem.body)}`}},[t._v("\n          Download Contato\n        ")])]:t._e(),"image"===t.mensagem.mediaType?[e("q-img",{staticStyle:{cursor:"pointer"},attrs:{src:t.mensagem.mediaUrl,"spinner-color":"primary",height:"60px",width:"130px"},on:{click:function(e){t.urlMedia=t.mensagem.mediaUrl,t.abrirModalImagem=!0}}}),e("VueEasyLightbox",{attrs:{moveDisabled:"",visible:t.abrirModalImagem,imgs:t.urlMedia,index:t.mensagem.ticketId||1},on:{hide:function(e){t.abrirModalImagem=!1}}})]:t._e(),"video"===t.mensagem.mediaType?[e("video",{staticStyle:{objectFit:"cover",width:"130px",height:"60px",borderTopLeftRadius:"8px",borderTopRightRadius:"8px",borderBottomLeftRadius:"8px",borderBottomRightRadius:"8px"},attrs:{src:t.mensagem.mediaUrl,controls:""}})]:t._e(),"application"===t.mensagem.mediaType?[e("div",{staticClass:"text-center"},[e("q-btn",{staticClass:"q-my-sm text-center text-black btn-rounded text-grey-9 ellipsis",attrs:{type:"a",color:"grey-3","no-wrap":"","no-caps":"",stack:"",download:"",target:t.isPDF(t.mensagem.mediaUrl)?"_blank":"",href:t.mensagem.mediaUrl}},[t.mensagem.mediaUrl?e("q-tooltip",{attrs:{"content-class":"bg-padrao text-grey-9 text-bold"}},[t._v("\n              Baixar: "+t._s(t.mensagem.body)+"\n            ")]):t._e(),e("template",{slot:"default"},[e("div",{staticClass:"row items-center q-my-sm",staticStyle:{"max-width":"180px"}},[e("div",{staticClass:"ellipsis col-grow q-pr-sm"},[t._v("\n                  "+t._s(t.formatarMensagemWhatsapp(t.mensagem.body))+"\n                ")]),e("q-icon",{staticClass:"col",attrs:{name:"mdi-download"}})],1)])],2)],1)]:t._e(),["vcard","application","audio","image","video"].includes(t.mensagem.mediaType)?t._e():e("div",{directives:[{name:"linkified",rawName:"v-linkified"}],staticClass:"q-message-container row items-end no-wrap ellipsis-3-lines",class:{"q-mt-sm":"chat"!==t.mensagem.mediaType}},[e("div",{domProps:{innerHTML:t._s(t.formatarMensagemWhatsapp(t.mensagem.body))}})])],2)])],1)},l=[],d=a("e762"),u={name:"MensagemChat",mixins:[n["a"]],props:{mensagem:{type:Object,default:()=>{}},size:{type:[String,Number],default:"5"},isLineDate:{type:Boolean,default:!0},replyingMessage:{type:Object,default:()=>{}}},data(){return{abrirModalImagem:!1,urlMedia:"",ackIcons:{0:"mdi-clock-outline",1:"mdi-check",2:"mdi-check-all",3:"mdi-check-all",4:"mdi-check-all"}}},components:{VueEasyLightbox:r["a"]},methods:{isPDF(t){if(!t)return!1;const e=t.split("."),a=e[e.length-1];return"pdf"===a},isGroupLabel(t){try{return this.ticketFocado.isGroup?t.contact.name:""}catch(e){return""}},returnCardContato(t){return d["a"].encode(t)},focarElemento(t){this.$emit("mensagem-respondida:focar-mensagem",t)}}},m=u,p=a("2877"),h=a("66e5"),g=a("8169"),f=a("9c40"),b=a("068f"),v=a("05c0"),y=a("0016"),q=a("714f"),w=a("eebe"),C=a.n(w),k=Object(p["a"])(m,c,l,!1,null,null,null),x=k.exports;C()(k,"components",{QItem:h["a"],QChatMessage:g["a"],QBtn:f["a"],QImg:b["a"],QTooltip:v["a"],QIcon:y["a"]}),C()(k,"directives",{Ripple:q["a"]});var _=function(){var t=this,e=t._self._c;return t.parsedContact.name?e("div",{staticClass:"contact-card"},[t.parsedContact.photo?e("div",[e("img",{attrs:{src:"data:image/jpeg;base64,"+t.parsedContact.photo,alt:"Contact Photo"}})]):t._e(),e("div",[e("h3",[t._v(t._s(t.parsedContact.name))]),e("p",[t._v(t._s(t.parsedContact.number))])])]):t._e()},O=[],I={name:"ContatoCard",props:{mensagem:{type:Object,required:!0}},data(){return{parsedContact:{}}},methods:{parseVCard(t){const e=t.split("\n"),a={name:"",number:"",photo:""};return e.forEach((t=>{t.startsWith("FN:")?a.name=t.substring(3):t.startsWith("TEL")||t.includes(".TEL")?a.number=t.split(":")[1]:t.startsWith("PHOTO;BASE64")&&(a.photo=t.split(":")[1])})),a},addContact(t){this.$emit("openContactModal",t)}},mounted(){this.parsedContact=this.parseVCard(this.mensagem.body)}},$=I,M=(a("44a9"),Object(p["a"])($,_,O,!1,null,"66348933",null)),T=M.exports,j=function(){var t=this,e=t._self._c;return e("q-dialog",{model:{value:t.isVisible,callback:function(e){t.isVisible=e},expression:"isVisible"}},[e("q-card",[e("q-card-section",[e("div",{staticClass:"text-h6"},[t._v("Adicionar Contato")])]),e("q-card-section",[e("q-input",{attrs:{label:"Nome"},model:{value:t.localContact.name,callback:function(e){t.$set(t.localContact,"name",e)},expression:"localContact.name"}}),e("q-input",{attrs:{label:"Número"},model:{value:t.localContact.number,callback:function(e){t.$set(t.localContact,"number",e)},expression:"localContact.number"}})],1),e("q-card-actions",{attrs:{align:"right"}},[e("q-btn",{attrs:{flat:"",label:"Cancelar"},on:{click:t.close}}),e("q-btn",{attrs:{flat:"",label:"Salvar",color:"primary"},on:{click:t.saveContact}})],1)],1)],1)},E=[],S={name:"ContatoModal",props:{value:{type:Boolean,required:!0},contact:{type:Object,required:!0}},data(){return{isVisible:this.value,localContact:{...this.contact}}},watch:{value(t){this.isVisible=t},contact(t){this.localContact={...t}}},methods:{close(){this.$emit("close")},saveContact(){this.$emit("saveContact",this.localContact),this.close()}}},A=S,D=a("24e8"),P=a("f09f"),N=a("a370"),R=a("27f9"),U=a("4b7e"),Q=Object(p["a"])(A,j,E,!1,null,null,null),L=Q.exports;C()(Q,"components",{QDialog:D["a"],QCard:P["a"],QCardSection:N["a"],QInput:R["a"],QCardActions:U["a"],QBtn:f["a"]});var F=a("79b5"),B=a("c5bd");const z=s["a"].create({baseURL:"http://localhost:3100",timeout:2e4,headers:{responseType:"blob"}});var G={name:"MensagemChat",mixins:[n["a"]],props:{mensagem:{type:Object,required:!0},mensagens:{type:Array,default:()=>[]},mensagensParaEncaminhar:{type:Array,default:()=>[]},size:{type:[String,Number],default:"5"},isLineDate:{type:Boolean,default:!0},isShowOptions:{type:Boolean,default:!0},ativarMultiEncaminhamento:{type:Boolean,default:!1},replyingMessage:{type:Object,default:()=>{}}},data(){return{modalEmojiOpen:!1,mensagemReacao:null,expandirEmojis:!1,principaisEmojis:["👍","❤️","😂","😮","😢","👏"],mensagemAtual:{body:""},showModaledit:!1,modalContato:!1,currentContact:{},abrirModalImagem:!1,urlMedia:"",identificarMensagem:null,ackIcons:{0:"mdi-clock-outline",1:"mdi-check",2:"mdi-check-all",3:"mdi-check-all",4:"mdi-check-all"}}},components:{VueEasyLightbox:r["a"],MensagemRespondida:x,ContatoCard:T,ContatoModal:L,VEmojiPicker:F["a"]},methods:{onInsertSelectEmoji(t){if(this.mensagemReacao){const e={messageId:this.mensagemReacao.messageId,ticketId:this.mensagemReacao.ticketId,reaction:t.data};this.selectEmoji(e.reaction,this.mensagemReacao)}else console.error("Nenhuma mensagem foi selecionada para reação.");this.modalEmojiOpen=!1},async selectEmoji(t,e){if(e){const a={messageId:e.messageId,ticketId:e.ticketId,reaction:t};await Object(B["q"])(a),this.mensagem=null}else console.error("Nenhuma mensagem foi selecionada para reação.");this.modalEmojiOpen=!1},calculateEmojisByRow(){const t=window.innerWidth;return t<600?5:t>=600&&t<1200?10:20},async salvarMensagem(){try{const t=await Object(B["k"])({id:this.mensagemAtual.id,messageId:this.mensagemAtual.messageId,body:this.mensagemAtual.body});this.showModaledit=!1,this.atualizarMensagem(t)}catch(t){console.error("Erro ao editar a mensagem",t.message),this.$notificarErro("Não foi possível editar a mensagem")}},atualizarMensagem(t){const e=this.mensagens.findIndex((e=>e.id===t.id));-1!==e&&this.mensagens.splice(e,1,t)},AbrirmodaleditarMensagem(t){this.mensagemAtual=t,this.showModaledit=!0},openContactModal(t){this.currentContact=t,this.modalContato=!0},closeModal(){this.modalContato=!1},saveContact(t){},getMapThumbnail(t){const[e]=t.split("|");return e},openGoogleMaps(t){const[,e]=t.split("|");window.open(e,"_blank")},verificarEncaminharMensagem(t){const e=[...this.mensagensParaEncaminhar],a=e.findIndex((e=>e.id===t.id));if(-1!==a)e.splice(a,1);else{if(this.mensagensParaEncaminhar.length>9)return void this.$notificarErro("Permitido no máximo 10 mensagens.");e.push(t)}this.$refs[`box-chat-message-${t.id}`][0].value=!this.$refs[`box-chat-message-${t.id}`][0].value,this.$emit("update:mensagensParaEncaminhar",e)},marcarMensagensParaEncaminhar(t){this.$emit("update:mensagensParaEncaminhar",[]),this.$emit("update:ativarMultiEncaminhamento",!this.ativarMultiEncaminhamento)},isPDF(t){if(!t)return!1;const e=t.split("."),a=e[e.length-1];return"pdf"===a},isGroupLabel(t){try{return this.ticketFocado.isGroup?t.contact.name:""}catch(e){return""}},returnCardContato(t){return d["a"].encode(t)},isDesactivatDelete(t){return!1},async buscarImageCors(t){this.loading=!0;try{const{data:e,headers:a}=await z.get(t,{responseType:"blob"}),o=window.URL.createObjectURL(new Blob([e],{type:a["content-type"]}));this.urlMedia=o,this.abrirModalImagem=!0}catch(e){this.$notificarErro("Ocorreu um erro!",e)}this.loading=!1},citarMensagem(t){this.$emit("update:replyingMessage",t),this.$root.$emit("mensagem-chat:focar-input-mensagem",t)},encaminharMensagem(t){this.$emit("mensagem-chat:encaminhar-mensagem",t)},deletarMensagem(t){this.isDesactivatDelete(t)&&this.$notificarErro("Não foi possível apagar mensagem com mais de 5min do envio.");const e={...t};this.$q.dialog({title:"Atenção!! Deseja realmente deletar a mensagem? ",message:"Mensagens antigas não serão apagadas no cliente.",cancel:{label:"Não",color:"primary",push:!0},ok:{label:"Sim",color:"negative",push:!0},persistent:!0}).onOk((()=>{this.loading=!0,Object(B["i"])(e).then((e=>{this.loading=!1,t.isDeleted=!0})).catch((t=>{this.loading=!1,console.error(t),this.$notificarErro("Não foi possível apagar a mensagem",t)}))})).onCancel((()=>{}))},focarMensagem(t){const e=`chat-message-${t.id}`;this.identificarMensagem=e,this.$nextTick((()=>{const t=document.getElementById(e);t.scrollIntoView()})),setTimeout((()=>{this.identificarMensagem=null}),5e3)}},mounted(){this.scrollToBottom(),window.addEventListener("resize",this.onResize)},beforeDestroy(){window.removeEventListener("resize",this.onResize)},destroyed(){}},W=G,H=(a("6243"),a("8f8e")),V=a("b047"),J=a("4e73"),K=a("1c1c"),Y=a("4074"),X=a("0170"),Z=a("eb85"),tt=a("7f67"),et=Object(p["a"])(W,o,i,!1,null,null,null);e["a"]=et.exports;C()(et,"components",{QChatMessage:g["a"],QCheckbox:H["a"],QIcon:y["a"],QTooltip:v["a"],QChip:V["a"],QBtn:f["a"],QMenu:J["a"],QList:K["a"],QItem:h["a"],QItemSection:Y["a"],QItemLabel:X["a"],QSeparator:Z["a"],QImg:b["a"],QDialog:D["a"],QCard:P["a"],QCardSection:N["a"],QInput:R["a"],QCardActions:U["a"]}),C()(et,"directives",{ClosePopup:tt["a"]})},fc45:function(t,e,a){"use strict";var o=function(){var t=this,e=t._self._c;return e("div",[e("q-dialog",{attrs:{persistent:"",value:t.modalTarefa},on:{hide:t.fecharModal,show:t.abrirModal}},[e("q-card",{staticClass:"q-pa-lg modal-container container-rounded-10"},[e("q-card-actions",{staticClass:"q-mt-md",attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"btn-rounded-50",attrs:{flat:"",color:"negative",icon:"eva-close"}})],1),e("q-card-section",[e("div",{staticClass:"text-h6 text-center font-family-main"},[t._v(t._s(t.tarefaEdicao.id?"Editar":"Criar")+" Tarefa")])]),e("q-form",{ref:"taskForm"},[e("q-card-section",{staticClass:"container-rounded-10 container-border"},[e("div",{staticClass:"text-h6 font-family-main q-mb-sm"},[t._v("\n          Informações\n        ")]),e("q-input",{staticClass:"row col",attrs:{rounded:"",outlined:"",label:"Nome",rules:[t=>!!t||"O campo Nome é obrigatório"]},model:{value:t.tarefa.name,callback:function(e){t.$set(t.tarefa,"name",e)},expression:"tarefa.name"}}),e("q-input",{staticClass:"row col",attrs:{rounded:"",outlined:"",label:"Descrição",type:"textarea",autogrow:"",rules:[t=>!!t||"O campo Descrição é obrigatório"]},model:{value:t.tarefa.description,callback:function(e){t.$set(t.tarefa,"description",e)},expression:"tarefa.description"}}),e("q-input",{staticClass:"row col",attrs:{rounded:"",outlined:"",label:"Data Limite",readonly:"",rules:[t=>!!t||"O campo Data Limite é obrigatório"]},on:{click:function(e){t.openCalendar=!0}},model:{value:t.tarefa.limitDate,callback:function(e){t.$set(t.tarefa,"limitDate",e)},expression:"tarefa.limitDate"}}),e("q-select",{staticClass:"row col",attrs:{rounded:"",outlined:"",label:"Responsável",options:t.userOptions,rules:[t=>!!t||"O campo Responsável é obrigatório"]},on:{input:t.updateUser},model:{value:t.tarefa.owner,callback:function(e){t.$set(t.tarefa,"owner",e)},expression:"tarefa.owner"}}),e("q-select",{staticClass:"row col",attrs:{rounded:"",outlined:"",label:"Prioridade",options:t.priorityOptions,rules:[t=>!!t||"O campo Prioridade é obrigatório"]},on:{input:t.updatePrioridade},model:{value:t.tarefa.priority,callback:function(e){t.$set(t.tarefa,"priority",e)},expression:"tarefa.priority"}}),e("q-input",{staticClass:"row col",attrs:{rounded:"",outlined:"",label:"Comentários",type:"textarea",autogrow:""},model:{value:t.tarefa.comments,callback:function(e){t.$set(t.tarefa,"comments",e)},expression:"tarefa.comments"}})],1),e("q-card-actions",{staticClass:"q-mt-md",attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mr-md btn-rounded-50",attrs:{label:"Cancelar",color:"negative"}}),e("q-btn",{staticClass:"generate-button btn-rounded-50",attrs:{label:"Salvar",icon:"eva-save-outline"},on:{click:t.validateForm}})],1)],1)],1)],1),e("q-dialog",{model:{value:t.openCalendar,callback:function(e){t.openCalendar=e},expression:"openCalendar"}},[e("q-date",{attrs:{mask:"YYYY-MM-DD"},on:{input:function(e){t.openCalendar=!1}},model:{value:t.tarefa.limitDate,callback:function(e){t.$set(t.tarefa,"limitDate",e)},expression:"tarefa.limitDate"}})],1)],1)},i=[],n=a("41be"),s=a("9a1b"),r={name:"ModalTarefa",props:{modalTarefa:{type:Boolean,default:!1},tarefaEdicao:{type:Object,default:()=>({id:null})}},data(){return{openCalendar:!1,tarefa:this.inicializarTarefa(),priorityOptions:[{label:"⏰ Urgente",value:"high"},{label:"⌛ Prazo Moderado",value:"medium"},{label:"🕗 Pouca Urgência",value:"low"},{label:"🕰️ Sem Pressa",value:"none"}],userOptions:[]}},computed:{isAdmin(){return"admin"===localStorage.getItem("profile")}},methods:{inicializarTarefa(){return{id:null,name:null,description:null,limitDate:null,owner:null,priority:null,comments:null}},async validateForm(){const t=await this.$refs.taskForm.validate();t?this.handleTarefa():this.notificarErro("Por favor, preencha todos os campos obrigatórios")},async listarUsuarios(){try{const t=localStorage.getItem("profile"),e=localStorage.getItem("username");if("admin"===t){const{data:t}=await Object(s["e"])();this.userOptions=t.users.map((t=>({label:t.name,value:t.name})))}else this.userOptions=[{label:e,value:e}]}catch(t){this.notificarErro("Problema ao carregar usuários",t)}},updateUser(t){this.tarefa.owner=t.value},updatePrioridade(t){this.tarefa.priority=t.value},resetarTarefa(){this.tarefa=this.inicializarTarefa()},fecharModal(){this.resetarTarefa(),this.$emit("update:tarefaEdicao",{id:null}),this.$emit("update:modalTarefa",!1)},abrirModal(){this.tarefa=this.tarefaEdicao.id?{...this.tarefaEdicao}:this.inicializarTarefa()},async handleTarefa(){this.loading=!0;try{const{data:t}=this.tarefa.id?await Object(n["a"])(this.tarefa):await Object(n["c"])(this.tarefa),e=this.tarefa.id?"modal-tarefa:editada":"modal-tarefa:criada";this.$emit(e,t),this.notificarSucesso(this.tarefa.id?"Tarefa editada!":"Tarefa criada!"),this.fecharModal()}catch(t){this.notificarErro("Ocorreu um erro ao processar a tarefa",t)}finally{this.loading=!1}},notificarErro(t,e=null){console.error(e),this.$q.notify({color:"red-5",textColor:"white",icon:"warning",message:t})},notificarSucesso(t){this.$q.notify({type:"positive",progress:!0,position:"top",message:t,actions:[{icon:"close",round:!0,color:"white"}]})}},async mounted(){await this.listarUsuarios()}},c=r,l=a("2877"),d=a("24e8"),u=a("f09f"),m=a("4b7e"),p=a("9c40"),h=a("a370"),g=a("0378"),f=a("27f9"),b=a("ddd8"),v=a("52ee"),y=a("7f67"),q=a("eebe"),w=a.n(q),C=Object(l["a"])(c,o,i,!1,null,"577966ca",null);e["a"]=C.exports;w()(C,"components",{QDialog:d["a"],QCard:u["a"],QCardActions:m["a"],QBtn:p["a"],QCardSection:h["a"],QForm:g["a"],QInput:f["a"],QSelect:b["a"],QDate:v["a"]}),w()(C,"directives",{ClosePopup:y["a"]})},fcbb:function(t,e,a){"use strict";a("14d9");var o=a("c5bd"),i=a("0cb4"),n=a("1732");const s=+localStorage.getItem("userId");e["a"]={data(){return{despedidas:[]}},methods:{async listarDespedidas(){try{const{data:t}=await Object(i["d"])();this.despedidas=t.farewellMessages,console.log(this.despedidas)}catch(t){console.error("Erro ao listar despedidas:",t)}},async iniciarAtendimento(t){this.loading=!0;const e=t.contact&&t.contact.name||(this.contatoSelecionado?this.contatoSelecionado.name:"Cliente");try{await Object(o["b"])(t.id,"open",s),this.loading=!1,this.$q.notify({message:`Atendimento Iniciado || ${e} - Ticket: ${t.id}`,type:"positive",progress:!0,position:"top",actions:[{icon:"close",round:!0,color:"white"}]}),this.$store.commit("TICKET_FOCADO",{}),this.$store.commit("SET_HAS_MORE",!1),this.$store.dispatch("AbrirChatMensagens",t)}catch(a){this.loading=!1,console.error(a),this.$notificarErro("Não foi possível atualizar o status",a)}},async atualizarStatusTicket2(t){const e=t.contact.name||"",a=t.id,i=this.$store.state.user.id,s="Encerrar o atendimento?",r="Atendimento encerrado!";await this.listarDespedidas();const c={title:s,message:`Cliente: ${e} || Ticket: ${a}`,options:{model:null,items:this.despedidas.map((t=>({label:t.message.substring(0,15)+"...",value:t.id})))},cancel:{label:"Não",color:"negative",push:!0},ok:{label:"Sim",color:"primary",push:!0},persistent:!0};this.$q.dialog(c).onOk((async t=>{this.loading=!0;const s=this.despedidas.find((e=>e.id===t));if(s){const t={read:1,fromMe:!0,mediaUrl:"",body:s.message,scheduleDate:null,quotedMsg:null,idFront:Object(n["a"])()};try{await Object(o["m"])(a,t),this.$q.notify({type:"positive",progress:!0,position:"top",message:"A mensagem de despedida está sendo enviada e o ticket será fechado dentro de 30 segundos.",actions:[{icon:"close",round:!0,color:"white"}]});try{await Object(o["c"])(a,{isFarewellMessage:!0})}catch(c){console.error("Erro ao atualizar o ticket:",c)}await new Promise((t=>setTimeout(t,3e4)))}catch(c){console.error("Erro ao enviar a mensagem de despedida:",c)}}Object(o["b"])(a,"closed",i).then((t=>{this.loading=!1,this.$q.notify({message:`${r} || ${e} (Ticket ${a})`,type:"positive",progress:!0,actions:[{icon:"close",round:!0,color:"white"}]}),this.$store.commit("TICKET_FOCADO",{}),this.$router.push({name:"chat-empty"})})).catch((t=>{this.loading=!1,this.$q.notify({message:"Erro ao encerrar o atendimento.",type:"warning",progress:!0,actions:[{icon:"close",round:!0,color:"white"}]}),console.error(t),this.$notificarErro("Não foi possível encerrar o atendimento",t)}))}))},async atualizarStatusTicket(t){const e=this.ticketFocado.contact.name||"",a=this.ticketFocado.id,i={open:"Atendimento será iniciado, ok?",pending:"Retornar à fila?",closed:"Encerrar o atendimento?"},r={open:"Atendimento iniciado!",pending:"Retornado à fila!",closed:"Atendimento encerrado!"};let c={title:i[t],message:`Cliente: ${e} || Ticket: ${a}`,cancel:{label:"Não",color:"negative",push:!0},persistent:!0};"closed"===t?(await this.listarDespedidas(),c={...c,options:{model:null,items:this.despedidas.map((t=>({label:t.message.substring(0,15)+"...",value:t.id})))},ok:{label:"Sim",color:"primary",push:!0}}):c={...c,ok:{label:"Sim",color:"primary",push:!0}},this.$q.dialog(c).onOk((async i=>{if(this.loading=!0,"closed"===t&&null!==i){const t=this.despedidas.find((t=>t.id===i));if(t){const e={read:1,fromMe:!0,mediaUrl:"",body:t.message,scheduleDate:null,quotedMsg:null,idFront:Object(n["a"])()};try{await Object(o["m"])(a,e),this.$q.notify({type:"positive",progress:!0,position:"top",message:"A mensagem selecionada está sendo enviada e o ticket será fechado dentro de 30 segundos!",actions:[{icon:"close",round:!0,color:"white"}]});try{await Object(o["c"])(this.ticketFocado.id,{isFarewellMessage:!0})}catch(l){console.error("Erro ao atualizar o ticket:",l)}await new Promise((t=>setTimeout(t,3e4)))}catch(l){console.error("Erro ao enviar a mensagem de despedida:",l)}}}const c="pending"===t?null:s;Object(o["b"])(a,t,c).then((o=>{this.loading=!1,this.$q.notify({message:`${r[t]} || ${e} (Ticket ${a})`,type:"positive",progress:!0,actions:[{icon:"close",round:!0,color:"white"}]}),this.$store.commit("TICKET_FOCADO",{}),"open"!==t&&this.$router.push({name:"chat-empty"})})).catch((t=>{this.loading=!1,this.$q.notify({message:"Atendimento nessa conexão já iniciado ou solicite ao admin para abrir um novo atendimento na opção contato.",type:"warning",progress:!0,actions:[{icon:"close",round:!0,color:"white"}]}),console.error("Erro ao atualizar o status:",t)}))}))}}}}}]);